{"mappings":"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","sources":["<anon>","src/main/resources/static/js/admin-bundle.js","src/main/resources/static/js/admin.js","src/main/resources/static/js/admin-courses/adminAddCourse.js","src/main/resources/static/js/admin-courses/adminEditCourse.js","src/main/resources/static/js/admin-courses/getModulesOfCourse.js","src/main/resources/static/js/admin-lessons/admin-lesson-edit.js","src/main/resources/static/js/admin-lessons/createLesson.js","src/main/resources/static/js/admin-lessons/generateTest.js","src/main/resources/static/js/admin-lessons/getLessons.js","src/main/resources/static/js/admin-module/admin-module-edit.js","src/main/resources/static/js/admin-module/adminCreateModule.js","src/main/resources/static/js/admin-module/adminDeleteModule.js","src/main/resources/static/js/admin-module/adminUpdateModuleStatus.js","src/main/resources/static/js/admin-module/getModuleLessons.js","src/main/resources/static/js/admin-module/getModules.js","src/main/resources/static/js/admin-offers/deleteOffer.js","src/main/resources/static/js/admin-offers/getOffers.js","src/main/resources/static/js/admin-offers/reponseOffer.js","src/main/resources/static/js/admin-users/editUser.js","src/main/resources/static/js/admin-users/getUsers.js","src/main/resources/static/js/admin-docs/getDocuments.js"],"sourcesContent":["(() => {\n// Original content of admin.js\nasync function $acf390f92ce7de37$var$getOfferDescription(offerId) {\n    try {\n        const response = await fetch(`/admin/offers/${offerId}`, {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json'\n            }\n        });\n        if (!response.ok) throw new Error(`\\u{41E}\\u{448}\\u{438}\\u{431}\\u{43A}\\u{430} HTTP: ${response.status}`);\n        const offerData = await response.json();\n        $acf390f92ce7de37$var$populateModal(offerData);\n    } catch (error) {\n        console.error(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u043F\\u0440\\u0438 \\u043F\\u043E\\u043B\\u0443\\u0447\\u0435\\u043D\\u0438\\u0438 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445 \\u0437\\u0430\\u044F\\u0432\\u043A\\u0438:\", error);\n        alert(\"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435 \\u0437\\u0430\\u044F\\u0432\\u043A\\u0438\");\n    }\n}\n// Заполнение модального окна данными\nfunction $acf390f92ce7de37$var$populateModal(offerData) {\n    $('#offerTitle').text(`\\u{41F}\\u{440}\\u{43E}\\u{441}\\u{43C}\\u{43E}\\u{442}\\u{440} \\u{438}\\u{43D}\\u{444}\\u{43E}\\u{440}\\u{43C}\\u{430}\\u{446}\\u{438}\\u{438} \\u{43F}\\u{43E} \\u{437}\\u{430}\\u{44F}\\u{432}\\u{43A}\\u{435} ${offerData.userId}`);\n    $('#offerTopic').text(offerData.topic);\n    $('#offerDescriptionBody').text(offerData.description);\n    // Показываем модальное окно\n    const modal = new bootstrap.Modal(document.getElementById('offerContentModal'));\n    modal.show();\n}\n// Обработчик события для закрытия модального окна\ndocument.getElementById('offerContentModal').addEventListener('hidden.bs.modal', function() {\n    // Очищаем поля при закрытии\n    document.getElementById('modalUserId').textContent = '';\n    document.getElementById('modalTopic').textContent = '';\n    document.getElementById('modalDescription').textContent = '';\n});\nfunction $acf390f92ce7de37$var$switchToView(viewType) {\n    $('.view-content').addClass('d-none');\n    $(`.${viewType}`).removeClass('d-none');\n}\nwindow.getOfferDescription = $acf390f92ce7de37$var$getOfferDescription;\nwindow.switchToView = $acf390f92ce7de37$var$switchToView;\n\n\ndocument.addEventListener('DOMContentLoaded', function() {\n    const form = document.getElementById('addCourseForm');\n    const descriptionTextarea = document.getElementById('courseDescription');\n    const charCount = document.getElementById('charCount');\n    const uploadPlaceholder = document.getElementById('uploadPlaceholder');\n    const fileInput = document.getElementById('courseImage');\n    const imagePreview = document.getElementById('imagePreview');\n    const removeImageBtn = document.getElementById('removeImage');\n    const courseTitle = document.getElementById('courseTitle');\n    const courseSlug = document.getElementById('courseSlug');\n    // Счетчик символов для описания\n    descriptionTextarea.addEventListener('input', function() {\n        const length = this.value.length;\n        charCount.textContent = length;\n        if (length > 1900) charCount.classList.add('text-warning');\n        else charCount.classList.remove('text-warning');\n    });\n    // Загрузка изображения\n    uploadPlaceholder.addEventListener('click', function() {\n        fileInput.click();\n    });\n    fileInput.addEventListener('change', function(e) {\n        if (this.files && this.files[0]) {\n            const file = this.files[0];\n            // Проверка размера файла\n            if (file.size > 5242880) {\n                showAlert(\"\\u0424\\u0430\\u0439\\u043B \\u0441\\u043B\\u0438\\u0448\\u043A\\u043E\\u043C \\u0431\\u043E\\u043B\\u044C\\u0448\\u043E\\u0439. \\u041C\\u0430\\u043A\\u0441\\u0438\\u043C\\u0430\\u043B\\u044C\\u043D\\u044B\\u0439 \\u0440\\u0430\\u0437\\u043C\\u0435\\u0440: 5MB\", 'error');\n                this.value = '';\n                return;\n            }\n            // Показ превью\n            const reader = new FileReader();\n            reader.onload = function(e) {\n                imagePreview.querySelector('img').src = e.target.result;\n                imagePreview.style.display = 'block';\n                uploadPlaceholder.style.display = 'none';\n            };\n            reader.readAsDataURL(file);\n        }\n    });\n    // Удаление изображения\n    removeImageBtn.addEventListener('click', function() {\n        fileInput.value = '';\n        imagePreview.style.display = 'none';\n        uploadPlaceholder.style.display = 'block';\n    });\n    // --- Slug Generation Logic ---\n    let isSlugManuallyEdited = false;\n    if (courseTitle && courseSlug) {\n        // Generate slug as user types in the title field\n        courseTitle.addEventListener('input', ()=>{\n            if (!isSlugManuallyEdited) generateSlugFromTitle();\n        });\n        // Detect when user edits the slug field manually to disable auto-generation\n        courseSlug.addEventListener('input', ()=>{\n            isSlugManuallyEdited = true;\n        });\n    }\n    function generateSlugFromTitle() {\n        const title = courseTitle.value.trim();\n        if (title) {\n            const translitMap = {\n                \"\\u0430\": 'a',\n                \"\\u0431\": 'b',\n                \"\\u0432\": 'v',\n                \"\\u0433\": 'g',\n                \"\\u0434\": 'd',\n                \"\\u0435\": 'e',\n                \"\\u0451\": 'yo',\n                \"\\u0436\": 'zh',\n                \"\\u0437\": 'z',\n                \"\\u0438\": 'i',\n                \"\\u0439\": 'y',\n                \"\\u043A\": 'k',\n                \"\\u043B\": 'l',\n                \"\\u043C\": 'm',\n                \"\\u043D\": 'n',\n                \"\\u043E\": 'o',\n                \"\\u043F\": 'p',\n                \"\\u0440\": 'r',\n                \"\\u0441\": 's',\n                \"\\u0442\": 't',\n                \"\\u0443\": 'u',\n                \"\\u0444\": 'f',\n                \"\\u0445\": 'h',\n                \"\\u0446\": 'ts',\n                \"\\u0447\": 'ch',\n                \"\\u0448\": 'sh',\n                \"\\u0449\": 'shch',\n                \"\\u044A\": '',\n                \"\\u044B\": 'y',\n                \"\\u044C\": '',\n                \"\\u044D\": 'e',\n                \"\\u044E\": 'yu',\n                \"\\u044F\": 'ya'\n            };\n            let slug = title.toLowerCase();\n            let result = '';\n            for(let i = 0; i < slug.length; i++)result += translitMap[slug[i]] || slug[i];\n            slug = result.replace(/['\"’]/g, '') // remove quotes\n            .replace(/\\s+/g, '-') // collapse whitespace and replace by -\n            .replace(/[^a-z0-9-]/g, '') // remove invalid chars\n            .replace(/-+/g, '-') // collapse dashes\n            .replace(/^-|-$/g, ''); // trim - from start or end\n            courseSlug.value = slug;\n        }\n    }\n    // --- End Slug Generation Logic ---\n    // Функция очистки формы\n    window.resetForm = function() {\n        form.reset();\n        form.classList.remove('was-validated');\n        charCount.textContent = '0';\n        fileInput.value = '';\n        imagePreview.style.display = 'none';\n        uploadPlaceholder.style.display = 'block';\n    };\n    // --- Form Submission Logic ---\n    form.addEventListener('submit', async function(event) {\n        // 1. Предотвращаем стандартную отправку формы\n        event.preventDefault();\n        event.stopPropagation();\n        // 2. Проверяем валидность формы с помощью Bootstrap\n        if (!form.checkValidity()) {\n            form.classList.add('was-validated');\n            return;\n        }\n        // Дополнительная проверка на наличие файла\n        if (fileInput.files.length === 0) {\n            showAlert(\"\\u041F\\u043E\\u0436\\u0430\\u043B\\u0443\\u0439\\u0441\\u0442\\u0430, \\u0432\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0438\\u0437\\u043E\\u0431\\u0440\\u0430\\u0436\\u0435\\u043D\\u0438\\u0435 \\u0434\\u043B\\u044F \\u043A\\u0443\\u0440\\u0441\\u0430.\", 'error');\n            return;\n        }\n        const submitButton = form.querySelector('button[type=\"submit\"]');\n        const originalButtonText = submitButton.innerHTML;\n        try {\n            // 3. Показываем индикатор загрузки\n            submitButton.disabled = true;\n            submitButton.innerHTML = '<span class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span> \\u0421\\u043E\\u0437\\u0434\\u0430\\u043D\\u0438\\u0435...';\n            // 4. Собираем данные формы с помощью FormData\n            const formData = new FormData(form);\n            // 5. Отправляем данные на сервер\n            const response = await fetch('/admin/course/create', {\n                method: 'POST',\n                body: formData\n            });\n            // 6. Обрабатываем ответ\n            if (response.status === 201) {\n                showAlert(\"\\u041A\\u0443\\u0440\\u0441 \\u0443\\u0441\\u043F\\u0435\\u0448\\u043D\\u043E \\u0441\\u043E\\u0437\\u0434\\u0430\\u043D!\", 'success');\n                window.resetForm(); // Используем уже существующую функцию для очистки\n            } else {\n                const errorData = await response.json();\n                const errorMessage = errorData.error || Object.values(errorData).join(', ');\n                return null;\n            }\n        } catch (error) {\n            showAlert(`\\u{41E}\\u{448}\\u{438}\\u{431}\\u{43A}\\u{430}: ${error.message}`, 'error');\n        } finally{\n            // 7. Возвращаем кнопку в исходное состояние\n            submitButton.disabled = false;\n            submitButton.innerHTML = originalButtonText;\n        }\n    });\n});\n\n\nlet $85ba6f91ba0d98ed$var$currentPage = 1;\nlet $85ba6f91ba0d98ed$var$totalPages = 1;\nlet $85ba6f91ba0d98ed$var$totalItems = 0;\nlet $85ba6f91ba0d98ed$var$coursesPerPage = 10; // Default courses per page\n// --- NEW: Function to switch to the Add Course tab ---\nfunction $85ba6f91ba0d98ed$var$openAddCourseForm() {\n    const tabLink = document.querySelector('a[data-tab=\"courses-add-tab\"]');\n    if (tabLink) tabLink.click();\n    else showAlert(\"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u043D\\u0430\\u0439\\u0442\\u0438 \\u0432\\u043A\\u043B\\u0430\\u0434\\u043A\\u0443 \\u0434\\u043B\\u044F \\u0434\\u043E\\u0431\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u044F \\u043A\\u0443\\u0440\\u0441\\u0430\", 'error');\n}\n// --- MODIFIED: Renamed for consistency ---\nfunction $85ba6f91ba0d98ed$var$changeCoursesPerPage(perPage) {\n    $85ba6f91ba0d98ed$var$coursesPerPage = parseInt(perPage) || 10;\n    $85ba6f91ba0d98ed$var$loadCourses(1);\n}\nasync function $85ba6f91ba0d98ed$var$loadCourses(page = 1) {\n    try {\n        const response = await fetch(`/admin/courses?page=${page}&size=${$85ba6f91ba0d98ed$var$coursesPerPage}`);\n        if (!response.ok) return null;\n        const data = await response.json();\n        if (!data.success || !data.data || !data.data.content) return null;\n        $85ba6f91ba0d98ed$var$currentPage = data.data[\"currentPage\"] || page;\n        $85ba6f91ba0d98ed$var$totalPages = data.data[\"totalPages\"] || 1;\n        $85ba6f91ba0d98ed$var$totalItems = data.data[\"totalItems\"] || data.data.content.length;\n        $85ba6f91ba0d98ed$var$renderCoursesTable(data.data.content);\n        $85ba6f91ba0d98ed$var$renderPagination();\n    } catch (e) {\n        showAlert(`\\u{41E}\\u{448}\\u{438}\\u{431}\\u{43A}\\u{430} \\u{437}\\u{430}\\u{433}\\u{440}\\u{443}\\u{437}\\u{43A}\\u{438} \\u{43A}\\u{443}\\u{440}\\u{441}\\u{43E}\\u{432} ${e}`, 'error');\n    }\n}\nasync function $85ba6f91ba0d98ed$var$deleteCourse(courseId, courseTitle) {\n    if (!confirm(`\\u{412}\\u{44B} \\u{443}\\u{432}\\u{435}\\u{440}\\u{435}\\u{43D}\\u{44B}, \\u{447}\\u{442}\\u{43E} \\u{445}\\u{43E}\\u{442}\\u{438}\\u{442}\\u{435} \\u{443}\\u{434}\\u{430}\\u{43B}\\u{438}\\u{442}\\u{44C} \\u{43A}\\u{443}\\u{440}\\u{441} \"${courseTitle}\"? \\u{42D}\\u{442}\\u{43E} \\u{434}\\u{435}\\u{439}\\u{441}\\u{442}\\u{432}\\u{438}\\u{435} \\u{443}\\u{434}\\u{430}\\u{43B}\\u{438}\\u{442} \\u{432}\\u{441}\\u{435} \\u{43C}\\u{43E}\\u{434}\\u{443}\\u{43B}\\u{438} \\u{438} \\u{443}\\u{440}\\u{43E}\\u{43A}\\u{438} \\u{44D}\\u{442}\\u{43E}\\u{433}\\u{43E} \\u{43A}\\u{443}\\u{440}\\u{441}\\u{430}, \\u{438} \\u{435}\\u{433}\\u{43E} \\u{43D}\\u{435}\\u{43B}\\u{44C}\\u{437}\\u{44F} \\u{431}\\u{443}\\u{434}\\u{435}\\u{442} \\u{43E}\\u{442}\\u{43C}\\u{435}\\u{43D}\\u{438}\\u{442}\\u{44C}.`)) return null;\n    try {\n        const headers = {\n            'Content-Type': 'application/json'\n        };\n        const response = await fetch(`/admin/courses/${courseId}/delete`, {\n            method: 'DELETE',\n            headers: headers\n        });\n        const result = await response.json().catch(()=>({}));\n        if (response.ok) {\n            showAlert(`\\u{41A}\\u{443}\\u{440}\\u{441} \"${courseTitle}\" \\u{443}\\u{441}\\u{43F}\\u{435}\\u{448}\\u{43D}\\u{43E} \\u{443}\\u{434}\\u{430}\\u{43B}\\u{435}\\u{43D}!`, 'success');\n            setTimeout(()=>{\n                $85ba6f91ba0d98ed$var$loadCourses($85ba6f91ba0d98ed$var$currentPage || 1);\n            }, 1500);\n        } else return null;\n    } catch (error) {\n        showAlert(`\\u{41E}\\u{448}\\u{438}\\u{431}\\u{43A}\\u{430} \\u{443}\\u{434}\\u{430}\\u{43B}\\u{435}\\u{43D}\\u{438}\\u{44F}: ${error.message}`, 'error');\n    }\n}\n// --- MODIFIED: renderCoursesTable with new header ---\nfunction $85ba6f91ba0d98ed$var$renderCoursesTable(courses) {\n    const tableContainer = document.querySelector('#courses-edit-tab .card-body');\n    if (!tableContainer) return;\n    tableContainer.innerHTML = ''; // Clear previous content\n    tableContainer.innerHTML = `\n        <div class=\"data-table courses-table\">\n            <div class=\"table-header d-flex justify-content-between align-items-center flex-wrap\">\n                <h3 class=\"table-title mb-2 mb-md-0\">\\u{421}\\u{43F}\\u{438}\\u{441}\\u{43E}\\u{43A} \\u{43A}\\u{443}\\u{440}\\u{441}\\u{43E}\\u{432}</h3>\n                <div class=\"d-flex align-items-center gap-2 flex-wrap\">\n                    <div class=\"page-size-selector\">\n                        <div class=\"input-group input-group-sm\">\n                            <span class=\"input-group-text\">\\u{41E}\\u{442}\\u{43E}\\u{431}\\u{440}\\u{430}\\u{436}\\u{430}\\u{442}\\u{44C}</span>\n                            <select class=\"form-select\" id=\"pageSizeSelect\" onchange=\"changeCoursesPerPage(this.value)\">\n                                <option value=\"5\">5</option>\n                                <option value=\"10\">10</option>\n                                <option value=\"20\">20</option>\n                                <option value=\"50\">50</option>\n                            </select>\n                        </div>\n                    </div>\n                    <button class=\"btn btn-primary btn-sm\" onclick=\"openAddCourseForm()\">\n                        <i class=\"bi bi-plus-circle me-1\"></i>\\u{41D}\\u{43E}\\u{432}\\u{44B}\\u{439} \\u{43A}\\u{443}\\u{440}\\u{441}\n                    </button>\n                </div>\n            </div>\n\n            <div class=\"table-content\">\n                <div class=\"table-row header-row\">\n                    <div class=\"table-cell\">ID</div>\n                    <div class=\"table-cell\">\\u{418}\\u{437}\\u{43E}\\u{431}\\u{440}\\u{430}\\u{436}\\u{435}\\u{43D}\\u{438}\\u{435}</div>\n                    <div class=\"table-cell\">\\u{41D}\\u{430}\\u{437}\\u{432}\\u{430}\\u{43D}\\u{438}\\u{435}</div>\n                    <div class=\"table-cell\">\\u{41E}\\u{43F}\\u{438}\\u{441}\\u{430}\\u{43D}\\u{438}\\u{435}</div>\n                    <div class=\"table-cell\">URI</div>\n                    <div class=\"table-cell\">\\u{421}\\u{442}\\u{430}\\u{442}\\u{443}\\u{441}</div>\n                    <div class=\"table-cell\">\\u{421}\\u{43E}\\u{437}\\u{434}\\u{430}\\u{43D}</div>\n                    <div class=\"table-cell\">\\u{41E}\\u{431}\\u{43D}\\u{43E}\\u{432}\\u{43B}\\u{435}\\u{43D}</div>\n                    <div class=\"table-cell\">\\u{414}\\u{435}\\u{439}\\u{441}\\u{442}\\u{432}\\u{438}\\u{44F}</div>\n                </div>\n\n                ${courses.length > 0 ? courses.map((course)=>`\n                <div class=\"table-row\" id=\"course-row-${course.id}\">\n                    <div class=\"table-cell text-muted\">#${course.id || 'N/A'}</div>\n                    <div class=\"table-cell\">\n                        <img src=\"/img/course-brand/${course.image}\" alt=\"\\u{418}\\u{437}\\u{43E}\\u{431}\\u{440}\\u{430}\\u{436}\\u{435}\\u{43D}\\u{438}\\u{435} \\u{43A}\\u{443}\\u{440}\\u{441}\\u{430}\"\n                             class=\"course-image\" data-image-name=\"${course.image}\" onclick=\"openViewCourseImageModal('${course.image}')\" style=\"cursor: pointer\">\n                    </div>\n                    <div class=\"table-cell\">\n                        <div class=\"fw-bold\">${course.title || 'N/A'}</div>\n                    </div>\n                    <div class=\"table-cell\">\n                        <span class=\"course-description\">${course.description || 'N/A'}</span>\n                    </div>\n                    <div class=\"table-cell\">\n                        ${$85ba6f91ba0d98ed$var$getActiveLinks(course)}\n                    </div>\n                    <div class=\"table-cell\" data-course-id=\"${course.id}\">\n                    ${$85ba6f91ba0d98ed$var$adaptiveCourseStatus(course.status, course.id)}\n                    </div>\n                    <div class=\"table-cell text-sm text-muted\">${$85ba6f91ba0d98ed$var$formatCourseDate(course[\"createdAt\"])}</div>\n                    <div class=\"table-cell text-sm text-muted\">${$85ba6f91ba0d98ed$var$formatCourseDate(course[\"updatedAt\"])}</div>\n                    <div class=\"table-cell action-buttons\">\n                        <button class=\"btn btn-primary btn-icon btn-sm\" title=\"\\u{420}\\u{435}\\u{434}\\u{430}\\u{43A}\\u{442}\\u{438}\\u{440}\\u{43E}\\u{432}\\u{430}\\u{442}\\u{44C}\" onclick=\"openEditCourseModal(${course.id})\">\n                            <i class=\"bi bi-pencil\"></i>\n                        </button>\n                        <button class=\"btn btn-primary btn-icon btn-sm\" title=\"\\u{41C}\\u{43E}\\u{434}\\u{443}\\u{43B}\\u{438}\" onclick=\"showCourseModules(${course.id}, '${course.title}')\">\n                            \\u{41C}\n                        </button>\n                        <button class=\"btn btn-danger btn-icon btn-sm\" title=\"\\u{423}\\u{434}\\u{430}\\u{43B}\\u{438}\\u{442}\\u{44C}\" onclick=\"deleteCourse(${course.id}, '${course.title}')\">\n                            <i class=\"bi bi-trash\"></i>\n                        </button>\n                    </div>\n                </div>\n                `).join('') : `\n                <div class=\"table-row\">\n                    <div class=\"table-cell\" style=\"grid-column: 1 / -1; text-align: center; padding: 2rem; color: #94a3b8;\">\n                        <i class=\"bi bi-journal-x me-2\"></i>\n                        \\u{41A}\\u{443}\\u{440}\\u{441}\\u{44B} \\u{43D}\\u{435} \\u{43D}\\u{430}\\u{439}\\u{434}\\u{435}\\u{43D}\\u{44B}\n                    </div>\n                </div>\n                `}\n            </div>\n        </div>\n\n        <div class=\"pagination-container-edit-course mt-3\"></div>\n    `;\n    document.getElementById('pageSizeSelect').value = $85ba6f91ba0d98ed$var$coursesPerPage;\n    const dropdownToggleElements = tableContainer.querySelectorAll('[data-bs-toggle=\"dropdown\"]');\n    dropdownToggleElements.forEach((dropdownToggleEl)=>{\n        new bootstrap.Dropdown(dropdownToggleEl);\n    });\n    // Force overflow to be visible on table cells to prevent dropdown clipping\n    const tableCells = tableContainer.querySelectorAll('.table-cell');\n    tableCells.forEach((cell)=>{\n        cell.style.overflow = 'visible';\n    });\n}\nfunction $85ba6f91ba0d98ed$var$getActiveLinks(course) {\n    return course.status === 'ACTIVE' ? `<code class=\"click-for-redirect\" style=\"cursor: pointer\">/course/${course.slug}</code>` : `<p>\\u{41D}\\u{435}\\u{432}\\u{43E}\\u{437}\\u{43C}\\u{43E}\\u{436}\\u{43D}\\u{43E} \\u{43F}\\u{440}\\u{43E}\\u{441}\\u{43C}\\u{43E}\\u{442}\\u{440}\\u{435}\\u{442}\\u{44C} \\u{43A}\\u{443}\\u{440}\\u{441}</p>`;\n}\nfunction $85ba6f91ba0d98ed$var$adaptiveCourseStatus(status, courseId) {\n    const statusMap = {\n        'ACTIVE': {\n            text: \"\\u0410\\u043A\\u0442\\u0438\\u0432\\u043D\\u044B\\u0439\",\n            bg: 'success'\n        },\n        'INACTIVE': {\n            text: \"\\u041D\\u0435\\u0430\\u043A\\u0442\\u0438\\u0432\\u043D\\u044B\\u0439\",\n            bg: 'secondary'\n        },\n        'ARCHIVED': {\n            text: \"\\u0412 \\u0430\\u0440\\u0445\\u0438\\u0432\\u0435\",\n            bg: 'dark'\n        }\n    };\n    const currentStatusInfo = statusMap[status] || {\n        text: \"\\u041D\\u0435\\u0438\\u0437\\u0432\\u0435\\u0441\\u0442\\u043D\\u043E\",\n        bg: 'light'\n    };\n    const dropdownItems = Object.keys(statusMap).map((s)=>{\n        if (s === status) return '';\n        const newStatusInfo = statusMap[s];\n        return `<li><a class=\"dropdown-item\" href=\"#\" onclick=\"event.preventDefault(); updateCourseStatus(${courseId}, '${currentStatusInfo.text}', '${s}', '${newStatusInfo.text}')\">${newStatusInfo.text}</a></li>`;\n    }).join('');\n    return `\n        <div class=\"dropdown\">\n            <button class=\"btn btn-sm dropdown-toggle badge rounded-pill text-bg-${currentStatusInfo.bg}\" type=\"button\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\">\n                ${currentStatusInfo.text}\n            </button>\n            <ul class=\"dropdown-menu\">\n                ${dropdownItems}\n            </ul>\n        </div>\n    `;\n}\nasync function $85ba6f91ba0d98ed$var$updateCourseStatus(courseId, currentStatusText, newStatus, newStatusText) {\n    if (!confirm(`\\u{412}\\u{44B} \\u{443}\\u{432}\\u{435}\\u{440}\\u{435}\\u{43D}\\u{44B}, \\u{447}\\u{442}\\u{43E} \\u{445}\\u{43E}\\u{442}\\u{438}\\u{442}\\u{435} \\u{438}\\u{437}\\u{43C}\\u{435}\\u{43D}\\u{438}\\u{442}\\u{44C} \\u{441}\\u{442}\\u{430}\\u{442}\\u{443}\\u{441} \\u{43A}\\u{443}\\u{440}\\u{441}\\u{430} \\u{441} \"${currentStatusText}\" \\u{43D}\\u{430} \"${newStatusText}\"?`)) return;\n    const headers = {\n        'Content-Type': 'application/json'\n    };\n    try {\n        const response = await fetch(`/admin/courses/update/status`, {\n            method: 'POST',\n            headers: headers,\n            body: JSON.stringify({\n                courseId: courseId,\n                status: newStatus\n            })\n        });\n        const result = await response.json().catch(()=>({}));\n        if (response.ok && result.success) {\n            showAlert(`\\u{421}\\u{442}\\u{430}\\u{442}\\u{443}\\u{441} \\u{43A}\\u{443}\\u{440}\\u{441}\\u{430} \\u{443}\\u{441}\\u{43F}\\u{435}\\u{448}\\u{43D}\\u{43E} \\u{438}\\u{437}\\u{43C}\\u{435}\\u{43D}\\u{435}\\u{43D} \\u{43D}\\u{430} \"${newStatusText}\"!`, 'success');\n            await $85ba6f91ba0d98ed$var$loadCourses($85ba6f91ba0d98ed$var$currentPage);\n        } else {\n            const errorMessage = result.error || `\\u{41E}\\u{448}\\u{438}\\u{431}\\u{43A}\\u{430} \\u{441}\\u{435}\\u{440}\\u{432}\\u{435}\\u{440}\\u{430}: ${response.status}`;\n            throw new Error(errorMessage);\n        }\n    } catch (error) {\n        showAlert(error.message, 'error');\n    }\n}\nfunction $85ba6f91ba0d98ed$var$renderPagination() {\n    const paginationContainer = document.querySelector('.pagination-container-edit-course');\n    if (!paginationContainer) return;\n    if ($85ba6f91ba0d98ed$var$totalPages <= 1) {\n        paginationContainer.innerHTML = '';\n        return;\n    }\n    let paginationHTML = `\n        <nav aria-label=\"Page navigation\">\n            <ul class=\"pagination justify-content-center\">\n                <li class=\"page-item ${$85ba6f91ba0d98ed$var$currentPage === 1 ? 'disabled' : ''}\">\n                    <a class=\"page-link\" href=\"#\" onclick=\"changePage(${$85ba6f91ba0d98ed$var$currentPage - 1}); return false;\">&laquo;</a>\n                </li>\n    `;\n    const maxVisiblePages = 5;\n    let startPage = Math.max(1, $85ba6f91ba0d98ed$var$currentPage - Math.floor(maxVisiblePages / 2));\n    let endPage = Math.min($85ba6f91ba0d98ed$var$totalPages, startPage + maxVisiblePages - 1);\n    if (endPage - startPage + 1 < maxVisiblePages) startPage = Math.max(1, endPage - maxVisiblePages + 1);\n    if (startPage > 1) {\n        paginationHTML += `<li class=\"page-item\"><a class=\"page-link\" href=\"#\" onclick=\"changePage(1); return false;\">1</a></li>`;\n        if (startPage > 2) paginationHTML += `<li class=\"page-item disabled\"><span class=\"page-link\">...</span></li>`;\n    }\n    for(let i = startPage; i <= endPage; i++)paginationHTML += `<li class=\"page-item ${i === $85ba6f91ba0d98ed$var$currentPage ? 'active' : ''}\"><a class=\"page-link\" href=\"#\" onclick=\"changePage(${i}); return false;\">${i}</a></li>`;\n    if (endPage < $85ba6f91ba0d98ed$var$totalPages) {\n        if (endPage < $85ba6f91ba0d98ed$var$totalPages - 1) paginationHTML += `<li class=\"page-item disabled\"><span class=\"page-link\">...</span></li>`;\n        paginationHTML += `<li class=\"page-item\"><a class=\"page-link\" href=\"#\" onclick=\"changePage(${$85ba6f91ba0d98ed$var$totalPages}); return false;\">${$85ba6f91ba0d98ed$var$totalPages}</a></li>`;\n    }\n    paginationHTML += `\n                <li class=\"page-item ${$85ba6f91ba0d98ed$var$currentPage === $85ba6f91ba0d98ed$var$totalPages ? 'disabled' : ''}\">\n                    <a class=\"page-link\" href=\"#\" onclick=\"changePage(${$85ba6f91ba0d98ed$var$currentPage + 1}); return false;\">&raquo;</a>\n                </li>\n            </ul>\n        </nav>\n        <div class=\"pagination-info text-center mt-2\">\n            <small class=\"text-muted\">\\u{421}\\u{442}\\u{440}\\u{430}\\u{43D}\\u{438}\\u{446}\\u{430} ${$85ba6f91ba0d98ed$var$currentPage} \\u{438}\\u{437} ${$85ba6f91ba0d98ed$var$totalPages} \\u{2022} \\u{412}\\u{441}\\u{435}\\u{433}\\u{43E} \\u{43A}\\u{443}\\u{440}\\u{441}\\u{43E}\\u{432}: ${$85ba6f91ba0d98ed$var$totalItems}</small>\n        </div>\n    `;\n    paginationContainer.innerHTML = paginationHTML;\n}\nfunction $85ba6f91ba0d98ed$var$changePage(page) {\n    if (page < 1 || page > $85ba6f91ba0d98ed$var$totalPages || page === $85ba6f91ba0d98ed$var$currentPage) return;\n    $85ba6f91ba0d98ed$var$loadCourses(page);\n}\nfunction $85ba6f91ba0d98ed$var$formatCourseDate(dateString) {\n    if (!dateString) return \"\\u041D\\u0435 \\u0443\\u043A\\u0430\\u0437\\u0430\\u043D\\u043E\";\n    try {\n        const date = new Date(dateString);\n        return date.toLocaleDateString('ru-RU', {\n            year: 'numeric',\n            month: '2-digit',\n            day: '2-digit'\n        });\n    } catch (e) {\n        return dateString;\n    }\n}\nfunction $85ba6f91ba0d98ed$var$openViewCourseImageModal(img) {\n    if (!document.getElementById('viewImageModal')) $85ba6f91ba0d98ed$var$renderImageViewModal();\n    const modalImg = document.getElementById('modalImgCourse');\n    if (modalImg) {\n        modalImg.src = `/img/course-brand/${img}`;\n        modalImg.alt = `\\u{418}\\u{437}\\u{43E}\\u{431}\\u{440}\\u{430}\\u{436}\\u{435}\\u{43D}\\u{438}\\u{435} \\u{43A}\\u{443}\\u{440}\\u{441}\\u{430}: ${img}`;\n    }\n    const modalElement = document.getElementById('viewImageModal');\n    if (modalElement) {\n        const modal = new bootstrap.Modal(modalElement);\n        modal.show();\n    }\n}\nfunction $85ba6f91ba0d98ed$var$renderImageViewModal() {\n    if (!document.getElementById('viewImageModal')) document.getElementById('img-view-modal').innerHTML += `\n            <div class=\"modal fade\" id=\"viewImageModal\" tabindex=\"-1\" aria-hidden=\"true\">\n                <div class=\"modal-dialog modal-lg\">\n                    <div class=\"modal-content\">\n                        <div class=\"modal-header\">\n                            <h5 class=\"modal-title\">\\u{418}\\u{437}\\u{43E}\\u{431}\\u{440}\\u{430}\\u{436}\\u{435}\\u{43D}\\u{438}\\u{435} \\u{43A}\\u{443}\\u{440}\\u{441}\\u{430}</h5>\n                            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n                        </div>\n                        <div class=\"modal-body text-center\">\n                            <img id=\"modalImgCourse\" class=\"img-fluid\" style=\"max-height: 70vh; object-fit: contain;\">\n                        </div>\n                        <div class=\"modal-footer\">\n                            <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">\\u{417}\\u{430}\\u{43A}\\u{440}\\u{44B}\\u{442}\\u{44C}</button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        `;\n}\ndocument.addEventListener('DOMContentLoaded', function() {\n    const coursesTabTrigger = document.querySelector('a[data-tab=\"courses-edit-tab\"]');\n    const coursesContainer = document.getElementById('courses-edit-tab');\n    if (coursesContainer) coursesContainer.addEventListener('click', function(event) {\n        if (event.target && event.target.classList.contains('click-for-redirect')) {\n            const url = event.target.textContent.trim();\n            if (url) window.location.href = url;\n        }\n    });\n    if (coursesTabTrigger) {\n        let isInitialized = false;\n        coursesTabTrigger.addEventListener('click', ()=>{\n            if (!isInitialized) {\n                $85ba6f91ba0d98ed$var$loadCourses(1);\n                $85ba6f91ba0d98ed$var$renderImageViewModal();\n                $85ba6f91ba0d98ed$var$renderEditCourseModal(); // Render the edit modal structure on tab click\n                isInitialized = true;\n            }\n        });\n        if (document.getElementById('courses-edit-tab')?.classList.contains('active')) {\n            $85ba6f91ba0d98ed$var$loadCourses(1);\n            $85ba6f91ba0d98ed$var$renderImageViewModal();\n            $85ba6f91ba0d98ed$var$renderEditCourseModal(); // Also render here if the tab is already active\n            isInitialized = true;\n        }\n    }\n});\n// --- NEW: Functions for Edit Course Modal ---\nfunction $85ba6f91ba0d98ed$var$renderEditCourseModal() {\n    if (document.getElementById('editCourseModal')) return; // Already rendered\n    const modalHTML = `\n        <div class=\"modal fade\" id=\"editCourseModal\" tabindex=\"-1\" aria-labelledby=\"editCourseModalLabel\" aria-hidden=\"true\">\n            <div class=\"modal-dialog modal-lg\">\n                <div class=\"modal-content\">\n                    <div class=\"modal-header\">\n                        <h5 class=\"modal-title\" id=\"editCourseModalLabel\">\\u{420}\\u{435}\\u{434}\\u{430}\\u{43A}\\u{442}\\u{438}\\u{440}\\u{43E}\\u{432}\\u{430}\\u{442}\\u{44C} \\u{43A}\\u{443}\\u{440}\\u{441}</h5>\n                        <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n                    </div>\n                    <div class=\"modal-body\">\n                        <form id=\"editCourseForm\" onsubmit=\"handleCourseUpdate(event)\">\n                            <input type=\"hidden\" id=\"editCourseId\" name=\"id\">\n                            \n                            <div class=\"mb-3\">\n                                <label for=\"editCourseTitle\" class=\"form-label\">\\u{41D}\\u{430}\\u{437}\\u{432}\\u{430}\\u{43D}\\u{438}\\u{435}</label>\n                                <input type=\"text\" class=\"form-control\" id=\"editCourseTitle\" name=\"title\" required minlength=\"2\" maxlength=\"100\">\n                            </div>\n                            \n                            <div class=\"mb-3\">\n                                <label for=\"editCourseDescription\" class=\"form-label\">\\u{41E}\\u{43F}\\u{438}\\u{441}\\u{430}\\u{43D}\\u{438}\\u{435}</label>\n                                <textarea class=\"form-control\" id=\"editCourseDescription\" name=\"description\" rows=\"3\" required minlength=\"2\" maxlength=\"100\"></textarea>\n                            </div>\n                            \n                            <div class=\"mb-3\">\n                                <label for=\"editCourseSlug\" class=\"form-label\">URI (Slug)</label>\n                                <input type=\"text\" class=\"form-control\" id=\"editCourseSlug\" name=\"slug\" required minlength=\"2\" maxlength=\"100\">\n                            </div>\n\n                            <div class=\"mb-3\">\n                                <label for=\"editCourseImage\" class=\"form-label\">\\u{418}\\u{437}\\u{43E}\\u{431}\\u{440}\\u{430}\\u{436}\\u{435}\\u{43D}\\u{438}\\u{435} \\u{43A}\\u{443}\\u{440}\\u{441}\\u{430}</label>\n                                <input class=\"form-control\" type=\"file\" id=\"editCourseImage\" name=\"image\" accept=\"image/png, image/jpeg, image/gif\">\n                                <div class=\"mt-2\">\n                                    <small class=\"text-muted\">\\u{422}\\u{435}\\u{43A}\\u{443}\\u{449}\\u{435}\\u{435} \\u{438}\\u{437}\\u{43E}\\u{431}\\u{440}\\u{430}\\u{436}\\u{435}\\u{43D}\\u{438}\\u{435}:</small>\n                                    <img id=\"currentCourseImage\" src=\"\" alt=\"Current Image\" class=\"img-thumbnail mt-1\" style=\"max-width: 150px;\">\n                                </div>\n                            </div>\n                            \n                            <div class=\"modal-footer\">\n                                <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">\\u{41E}\\u{442}\\u{43C}\\u{435}\\u{43D}\\u{430}</button>\n                                <button type=\"submit\" class=\"btn btn-primary\">\\u{421}\\u{43E}\\u{445}\\u{440}\\u{430}\\u{43D}\\u{438}\\u{442}\\u{44C} \\u{438}\\u{437}\\u{43C}\\u{435}\\u{43D}\\u{435}\\u{43D}\\u{438}\\u{44F}</button>\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            </div>\n        </div>\n    `;\n    document.body.insertAdjacentHTML('beforeend', modalHTML);\n}\nasync function $85ba6f91ba0d98ed$var$openEditCourseModal(courseId) {\n    const modalElement = document.getElementById('editCourseModal');\n    if (!modalElement) return;\n    const courseRow = document.getElementById(`course-row-${courseId}`);\n    if (!courseRow) {\n        showAlert(\"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u043D\\u0430\\u0439\\u0442\\u0438 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435 \\u0434\\u043B\\u044F \\u043A\\u0443\\u0440\\u0441\\u0430.\", 'error');\n        return;\n    }\n    // Extract data from the table row\n    const title = courseRow.querySelector('.fw-bold').textContent.trim();\n    const description = courseRow.querySelector('.course-description').textContent.trim();\n    const slug = courseRow.querySelector('code').textContent.replace('/courses/', '').trim();\n    const imageUrl = courseRow.querySelector('.course-image').src;\n    // Populate the form\n    document.getElementById('editCourseId').value = courseId;\n    document.getElementById('editCourseTitle').value = title;\n    document.getElementById('editCourseDescription').value = description;\n    document.getElementById('editCourseSlug').value = slug;\n    document.getElementById('currentCourseImage').src = imageUrl;\n    document.getElementById('editCourseImage').value = ''; // Clear file input\n    const modal = new bootstrap.Modal(modalElement);\n    modal.show();\n}\nasync function $85ba6f91ba0d98ed$var$handleCourseUpdate(event) {\n    event.preventDefault();\n    const form = event.target;\n    const formData = new FormData(form);\n    const courseId = formData.get('id');\n    const courseTitle = formData.get('title');\n    const headers = {};\n    try {\n        // NOTE: The backend endpoint /admin/courses/update is assumed to exist.\n        // It should handle a multipart/form-data POST request.\n        const response = await fetch('/admin/courses/update', {\n            method: 'POST',\n            headers: headers,\n            body: formData\n        });\n        const result = await response.json().catch(()=>({}));\n        if (response.ok && result.success) {\n            showAlert(`\\u{41A}\\u{443}\\u{440}\\u{441} \"${courseTitle}\" \\u{443}\\u{441}\\u{43F}\\u{435}\\u{448}\\u{43D}\\u{43E} \\u{43E}\\u{431}\\u{43D}\\u{43E}\\u{432}\\u{43B}\\u{435}\\u{43D}!`, 'success');\n            const modal = bootstrap.Modal.getInstance(document.getElementById('editCourseModal'));\n            modal.hide();\n            $85ba6f91ba0d98ed$var$loadCourses($85ba6f91ba0d98ed$var$currentPage); // Refresh the table\n        } else {\n            // Prefer a server-sent message, otherwise use a generic one.\n            const errorMessage = result.error || `\\u{41E}\\u{448}\\u{438}\\u{431}\\u{43A}\\u{430} \\u{441}\\u{435}\\u{440}\\u{432}\\u{435}\\u{440}\\u{430}: ${response.status}`;\n            return null;\n        }\n    } catch (error) {\n        showAlert(`\\u{41E}\\u{448}\\u{438}\\u{431}\\u{43A}\\u{430} \\u{43E}\\u{431}\\u{43D}\\u{43E}\\u{432}\\u{43B}\\u{435}\\u{43D}\\u{438}\\u{44F}: ${error.message}`, 'error');\n    }\n}\nwindow.openAddCourseForm = $85ba6f91ba0d98ed$var$openAddCourseForm;\nwindow.changeCoursesPerPage = $85ba6f91ba0d98ed$var$changeCoursesPerPage;\nwindow.deleteCourse = $85ba6f91ba0d98ed$var$deleteCourse;\nwindow.changePage = $85ba6f91ba0d98ed$var$changePage;\nwindow.openViewCourseImageModal = $85ba6f91ba0d98ed$var$openViewCourseImageModal;\nwindow.openEditCourseModal = $85ba6f91ba0d98ed$var$openEditCourseModal;\nwindow.handleCourseUpdate = $85ba6f91ba0d98ed$var$handleCourseUpdate;\nwindow.updateCourseStatus = $85ba6f91ba0d98ed$var$updateCourseStatus;\nwindow.loadCourses = $85ba6f91ba0d98ed$var$loadCourses;\n\n\n// Глобальные переменные\nlet $f2e732684596b7fb$var$currentCourse = null;\nlet $f2e732684596b7fb$var$courseModules = [];\n// Функция открытия модального окна с модулями курса\nasync function $f2e732684596b7fb$var$openCourseModulesModal(courseId) {\n    try {\n        // Загружаем модули курса\n        const response = await fetch(`/admin/courses/${courseId}/modules`);\n        if (!response.ok) {\n            if (response.status === 404) showAlert(\"\\u0412 \\u044D\\u0442\\u043E\\u043C \\u043C\\u043E\\u0434\\u0443\\u043B\\u0435 \\u043D\\u0435\\u0442 \\u043A\\u0443\\u0440\\u0441\\u043E\\u0432\", 'info');\n            else showAlert(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0438 \\u043C\\u043E\\u0434\\u0443\\u043B\\u0435\\u0439 \\u043A\\u0443\\u0440\\u0441\\u0430\", 'error');\n            return;\n        }\n        const data = await response.json();\n        if (!data.success || !Array.isArray(data.data)) {\n            showAlert(data.message || \"\\u041C\\u043E\\u0434\\u0443\\u043B\\u0435\\u0439 \\u043D\\u0435\\u0442\", 'info');\n            $f2e732684596b7fb$var$courseModules = []; // Устанавливаем пустой массив, если данные неверны\n            $f2e732684596b7fb$var$currentCourse = {\n                id: courseId,\n                name: \"\\u041D\\u0435\\u0438\\u0437\\u0432\\u0435\\u0441\\u0442\\u043D\\u044B\\u0439 \\u043A\\u0443\\u0440\\u0441\"\n            }; // Устанавливаем дефолтное имя\n            return; // Выходим из функции, так как нет данных\n        }\n        $f2e732684596b7fb$var$courseModules = data.data || []; // Теперь data.data - это сам массив модулей\n        // Проверяем, что courseModules не пустой, прежде чем обращаться к первому элементу\n        $f2e732684596b7fb$var$currentCourse = {\n            id: courseId,\n            name: $f2e732684596b7fb$var$courseModules.length > 0 ? $f2e732684596b7fb$var$courseModules[0][\"courseName\"] : \"\\u041D\\u0435\\u0438\\u0437\\u0432\\u0435\\u0441\\u0442\\u043D\\u044B\\u0439 \\u043A\\u0443\\u0440\\u0441\"\n        };\n        // Рендерим модальное окно\n        $f2e732684596b7fb$var$renderCourseModulesModal();\n        // Показываем модальное окно\n        const modalElement = document.getElementById('courseModulesModal');\n        if (!modalElement) return null;\n        const modal = new bootstrap.Modal(modalElement);\n        // noinspection JSUnresolvedReference\n        modal.show();\n    } catch (error) {}\n}\n// Функция рендеринга модального окна\nfunction $f2e732684596b7fb$var$renderCourseModulesModal() {\n    const modalContainer = document.getElementById('courseModulesModal');\n    if (!modalContainer) {\n        // Создаем модальное окно если его нет\n        $f2e732684596b7fb$var$createModulesModalElement();\n        return;\n    }\n    // Заполняем заголовок\n    const modalTitle = modalContainer.querySelector('.modal-title');\n    if (modalTitle) modalTitle.textContent = `\\u{41C}\\u{43E}\\u{434}\\u{443}\\u{43B}\\u{438} \\u{43A}\\u{443}\\u{440}\\u{441}\\u{430}: ${$f2e732684596b7fb$var$currentCourse.name}`;\n    if ($f2e732684596b7fb$var$courseModules.length > 0) document.getElementById('modulesCount').innerText = `\\u{41C}\\u{43E}\\u{434}\\u{443}\\u{43B}\\u{435}\\u{439}: ${$f2e732684596b7fb$var$courseModules.length}`;\n    // Заполняем список модулей\n    const modulesList = modalContainer.querySelector('#modulesList');\n    if (modulesList) modulesList.innerHTML = $f2e732684596b7fb$var$courseModules.length > 0 ? $f2e732684596b7fb$var$renderModulesList() : '<div class=\"text-center py-4 text-muted\">\\u041C\\u043E\\u0434\\u0443\\u043B\\u0438 \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\\u044B</div>';\n}\n// Функция рендеринга списка модулей\nfunction $f2e732684596b7fb$var$renderModulesList() {\n    return $f2e732684596b7fb$var$courseModules.map((module, index)=>`\n        <div class=\"module-item\" data-module-id=\"${module.moduleId}\">\n            <div class=\"module-header d-flex justify-content-between align-items-center\">\n                <div class=\"module-info\">\n                    <h6 class=\"module-title mb-1\">${module.order || index + 1}. ${$f2e732684596b7fb$var$escapeHtml(module[\"moduleTitle\"] || \"\\u0411\\u0435\\u0437 \\u043D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u044F\")}</h6>\n                    <small class=\"text-muted\">ID: ${module.moduleId} </small>\n                </div>\n                <div class=\"module-actions\">\n                    <button class=\"btn btn-sm btn-outline-primary me-1\" onclick=\"editModule(${module.id})\">\n                        <i class=\"fas fa-edit\"></i>\n                    </button>\n                    <a class=\"btn btn-sm btn-outline-danger\" href=\"/admin/modules\">\n                        <i class=\"fas fa-trash\"></i>\n                    </a>\n                </div>\n            </div>\n            <hr class=\"my-2\">\n        </div>\n    `).join('');\n}\n// Функция создания элемента модального окна\nfunction $f2e732684596b7fb$var$createModulesModalElement() {\n    const modalHTML = `\n        <div class=\"modal fade\" id=\"courseModulesModal\" tabindex=\"-1\" aria-hidden=\"true\">\n            <div class=\"modal-dialog modal-lg\">\n                <div class=\"modal-content\">\n                    <div class=\"modal-header\">\n                        <h5 class=\"modal-title\">\\u{41C}\\u{43E}\\u{434}\\u{443}\\u{43B}\\u{438} \\u{43A}\\u{443}\\u{440}\\u{441}\\u{430}</h5>\n                        <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n                    </div>\n                    <div class=\"modal-body\">\n                        <div class=\"d-flex justify-content-between align-items-center mb-3\">\n                            <span class=\"text-muted\" id=\"modulesCount\">\\u{41C}\\u{43E}\\u{434}\\u{443}\\u{43B}\\u{435}\\u{439}: 0</span>\n                        </div>\n                        \n                        <div id=\"modulesList\" class=\"modules-list\">\n                            <div class=\"text-center py-4 text-muted\">\n                                <i class=\"fas fa-spinner fa-spin me-2\"></i>\n                                \\u{417}\\u{430}\\u{433}\\u{440}\\u{443}\\u{437}\\u{43A}\\u{430} \\u{43C}\\u{43E}\\u{434}\\u{443}\\u{43B}\\u{435}\\u{439}...\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"modal-footer\">\n                        <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">\\u{417}\\u{430}\\u{43A}\\u{440}\\u{44B}\\u{442}\\u{44C}</button>\n                        <button type=\"button\" class=\"btn btn-primary\" onclick=\"manageCourse(${$f2e732684596b7fb$var$currentCourse?.id})\">\n                            \\u{423}\\u{43F}\\u{440}\\u{430}\\u{432}\\u{43B}\\u{435}\\u{43D}\\u{438}\\u{435} \\u{43A}\\u{443}\\u{440}\\u{441}\\u{43E}\\u{43C}\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    `;\n    // Добавляем модальное окно в body\n    document.body.insertAdjacentHTML('beforeend', modalHTML);\n    $f2e732684596b7fb$var$renderCourseModulesModal();\n}\n// Вспомогательные функции\nfunction $f2e732684596b7fb$var$escapeHtml(text) {\n    if (text === null || text === undefined) return '';\n    const div = document.createElement('div');\n    div.textContent = text;\n    return div.innerHTML;\n}\nfunction $f2e732684596b7fb$var$formatDate(dateString) {\n    if (!dateString) return \"\\u041D\\u0435 \\u0443\\u043A\\u0430\\u0437\\u0430\\u043D\\u043E\";\n    try {\n        const date = new Date(dateString);\n        return date.toLocaleDateString('ru-RU');\n    } catch (e) {\n        return dateString;\n    }\n}\n// Функции действий (заглушки)\nfunction $f2e732684596b7fb$var$addNewModule() {\n    alert(`\\u{414}\\u{43E}\\u{431}\\u{430}\\u{432}\\u{43B}\\u{435}\\u{43D}\\u{438}\\u{435} \\u{43C}\\u{43E}\\u{434}\\u{443}\\u{43B}\\u{44F} \\u{434}\\u{43B}\\u{44F} \\u{43A}\\u{443}\\u{440}\\u{441}\\u{430}: ${$f2e732684596b7fb$var$currentCourse?.name}`);\n}\nfunction $f2e732684596b7fb$var$editModule(moduleId) {\n    showAlert(`\\u{420}\\u{435}\\u{434}\\u{430}\\u{43A}\\u{442}\\u{438}\\u{440}\\u{43E}\\u{432}\\u{430}\\u{43D}\\u{438}\\u{435} \\u{43C}\\u{43E}\\u{434}\\u{443}\\u{43B}\\u{44F}: ${moduleId}`, 'info');\n}\nfunction $f2e732684596b7fb$var$manageCourse(courseId) {\n    // Переход на страницу управления курсом\n    window.location.href = `/admin/courses/${courseId}/edit`;\n}\n// Обновляем функцию в основном скрипте для вызова модального окна\nfunction $f2e732684596b7fb$var$showCourseModules(courseId, courseName) {\n    $f2e732684596b7fb$var$openCourseModulesModal(courseId, courseName);\n}\n// Инициализация при загрузке страницы\ndocument.addEventListener('DOMContentLoaded', function() {\n    // Обработчик для закрытия модального окна\n    document.addEventListener('hidden.bs.modal', function(event) {\n        if (event.target.id === 'courseModulesModal') {\n            // Очищаем данные при закрытии\n            $f2e732684596b7fb$var$currentCourse = null;\n            $f2e732684596b7fb$var$courseModules = [];\n        }\n    });\n});\nwindow.addNewModule = $f2e732684596b7fb$var$addNewModule;\nwindow.editModule = $f2e732684596b7fb$var$editModule;\nwindow.manageCourse = $f2e732684596b7fb$var$manageCourse;\nwindow.showCourseModules = $f2e732684596b7fb$var$showCourseModules;\n\n\ndocument.addEventListener('DOMContentLoaded', function() {\n    const editLessonModal = new bootstrap.Modal(document.getElementById('editLessonModal'));\n    const editLessonForm = document.getElementById('editLessonForm');\n    // Инициализация TinyMCE\n    function initTinyMCE(content = '') {\n        tinymce.remove('#editLessonTextContent'); // Удаляем предыдущий инстанс, если он был\n        tinymce.init({\n            selector: '#editLessonTextContent',\n            plugins: 'code table lists image link',\n            toolbar: 'undo redo | blocks | bold italic | alignleft aligncenter alignright | indent outdent | bullist numlist | code | image | link',\n            height: 400,\n            setup: function(editor) {\n                editor.on('init', function() {\n                    editor.setContent(content);\n                });\n            }\n        });\n    }\n    // Глобальный обработчик кликов для делегирования событий\n    document.body.addEventListener('click', async function(event) {\n        const editButton = event.target.closest('.edit-lesson-btn');\n        if (editButton) {\n            const lessonId = editButton.dataset.lessonId;\n            if (!lessonId) return;\n            // 1. Получаем данные урока с бэкенда\n            try {\n                const response = await fetch(`/api/admin/lessons/${lessonId}`);\n                const result = await response.json();\n                if (!response.ok || !result.success) {\n                    const errorMsg = result.message || \"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435 \\u0443\\u0440\\u043E\\u043A\\u0430.\";\n                    showAlert(errorMsg, 'error');\n                    return;\n                }\n                const lessonData = result.data; // Data is in result.data\n                // 2. Заполняем форму\n                document.getElementById('editLessonId').value = lessonId;\n                document.getElementById('editLessonTitle').value = lessonData.title;\n                document.getElementById('editLessonVideoUrl').value = lessonData.videoUrl;\n                // 3. Инициализируем TinyMCE с контентом\n                initTinyMCE(lessonData.textContent || '');\n                // 4. Показываем модальное окно\n                editLessonModal.show();\n            } catch (error) {\n                showAlert(error.message, 'error');\n            }\n        }\n    });\n    // Обработчик отправки формы\n    editLessonForm.addEventListener('submit', async function(event) {\n        event.preventDefault();\n        const lessonId = document.getElementById('editLessonId').value;\n        const title = document.getElementById('editLessonTitle').value;\n        const videoUrl = document.getElementById('editLessonVideoUrl').value;\n        const textContent = tinymce.get('editLessonTextContent').getContent();\n        const lessonDto = {\n            title: title,\n            videoUrl: videoUrl,\n            textContent: textContent\n        };\n        try {\n            const response = await fetch(`/api/admin/lessons/${lessonId}`, {\n                method: 'PUT',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify(lessonDto)\n            });\n            const result = await response.json();\n            if (!response.ok || !result.success) {\n                const errorMessage = result.message || \"\\u041F\\u0440\\u043E\\u0438\\u0437\\u043E\\u0448\\u043B\\u0430 \\u043E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u043F\\u0440\\u0438 \\u0441\\u043E\\u0445\\u0440\\u0430\\u043D\\u0435\\u043D\\u0438\\u0438.\";\n                throw new Error(errorMessage);\n            }\n            // Успех\n            editLessonModal.hide();\n            showAlert(result.message || \"\\u0423\\u0440\\u043E\\u043A \\u0443\\u0441\\u043F\\u0435\\u0448\\u043D\\u043E \\u043E\\u0431\\u043D\\u043E\\u0432\\u043B\\u0435\\u043D!\", 'success');\n            // Обновляем таблицу уроков, чтобы увидеть изменения\n            if (typeof loadLessons === 'function') loadLessons();\n        } catch (error) {\n            showAlert(error.message, 'error');\n        }\n    });\n});\n\n\n// Глобальные переменные\nlet $8aed6ce0d400e0c5$var$modulesList = [];\n// Инициализация формы\nfunction $8aed6ce0d400e0c5$var$initCreateLessonForm() {\n    $8aed6ce0d400e0c5$var$loadModules();\n    $8aed6ce0d400e0c5$var$bindFormEvents();\n}\n// Загрузка списка модулей\nasync function $8aed6ce0d400e0c5$var$loadModules() {\n    try {\n        const response = await fetch('/admin/modules/json');\n        if (response.ok) {\n            const data = await response.json();\n            if (data.success && data.data) {\n                $8aed6ce0d400e0c5$var$modulesList = data.data;\n                $8aed6ce0d400e0c5$var$populateModulesSelect();\n            }\n        }\n    } catch (error) {\n        showAlert(\"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0441\\u043F\\u0438\\u0441\\u043E\\u043A \\u043C\\u043E\\u0434\\u0443\\u043B\\u0435\\u0439\", 'error');\n    }\n}\n// Заполнение select модулей\nfunction $8aed6ce0d400e0c5$var$populateModulesSelect() {\n    const select = document.getElementById('moduleId');\n    select.innerHTML = '<option value=\"\">\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u043C\\u043E\\u0434\\u0443\\u043B\\u044C</option>';\n    $8aed6ce0d400e0c5$var$modulesList.forEach((module)=>{\n        const option = document.createElement('option');\n        option.value = module.moduleId;\n        if (module.moduleStatus === \"ACTIVE\") option.textContent = `(\\u{41A}\\u{443}\\u{440}\\u{441}: ${module.courseName}) \\u{41C}\\u{43E}\\u{434}\\u{443}\\u{43B}\\u{44C}: ${module.moduleTitle}`;\n        else {\n            option.textContent = `\\u{41D}\\u{415}\\u{410}\\u{41A}\\u{422}\\u{418}\\u{412}\\u{415}\\u{41D} (\\u{41A}\\u{443}\\u{440}\\u{441}: ${module.courseName}) \\u{41C}\\u{43E}\\u{434}\\u{443}\\u{43B}\\u{44C}: ${module.moduleTitle}`;\n            option.disabled = true;\n        }\n        select.appendChild(option);\n    });\n}\n// Привязка событий формы\nfunction $8aed6ce0d400e0c5$var$bindFormEvents() {\n    const submitBtn = document.getElementById('submitLessonBtn');\n    const form = document.getElementById('createLessonForm');\n    if (submitBtn) submitBtn.addEventListener('click', $8aed6ce0d400e0c5$var$handleLessonSubmit);\n    if (form) form.addEventListener('submit', function(e) {\n        e.preventDefault();\n        $8aed6ce0d400e0c5$var$handleLessonSubmit();\n    });\n    // Очистка формы при закрытии модального окна\n    const modal = document.getElementById('createLessonModal');\n    if (modal) modal.addEventListener('hidden.bs.modal', $8aed6ce0d400e0c5$var$resetForm);\n}\n// Обработчик отправки формы\nasync function $8aed6ce0d400e0c5$var$handleLessonSubmit() {\n    if (!$8aed6ce0d400e0c5$var$validateLessonForm()) return;\n    try {\n        $8aed6ce0d400e0c5$var$showLoading(true);\n        const formData = new FormData();\n        formData.append('file', document.getElementById('videoFile').files[0]);\n        formData.append('moduleId', document.getElementById('moduleId').value);\n        formData.append('title', document.getElementById('lessonTitle').value);\n        formData.append('description', document.getElementById('description').value);\n        formData.append('shortDescription', document.getElementById('shortDescription').value);\n        formData.append('testCode', document.getElementById('testCode').value);\n        const response = await fetch('/admin/lesson/upload', {\n            method: 'POST',\n            body: formData\n        });\n        const result = await response.json();\n        if (response.ok) $8aed6ce0d400e0c5$var$handleSuccessResponse(result);\n        else $8aed6ce0d400e0c5$var$handleErrorResponse(result);\n    } catch (error) {\n        showAlert(\"\\u041F\\u0440\\u043E\\u0438\\u0437\\u043E\\u0448\\u043B\\u0430 \\u043E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u043F\\u0440\\u0438 \\u0441\\u043E\\u0437\\u0434\\u0430\\u043D\\u0438\\u0438 \\u0443\\u0440\\u043E\\u043A\\u0430\", 'error');\n    } finally{\n        $8aed6ce0d400e0c5$var$showLoading(false);\n    }\n}\n// Валидация формы\nfunction $8aed6ce0d400e0c5$var$validateLessonForm() {\n    const form = document.getElementById('createLessonForm');\n    if (!form.checkValidity()) {\n        form.reportValidity();\n        return false;\n    }\n    // Проверка размера файла (максимум 500MB)\n    const fileInput = document.getElementById('videoFile');\n    if (fileInput.files[0] && fileInput.files[0].size > 209715200) {\n        showAlert(\"\\u0420\\u0430\\u0437\\u043C\\u0435\\u0440 \\u0444\\u0430\\u0439\\u043B\\u0430 \\u043D\\u0435 \\u0434\\u043E\\u043B\\u0436\\u0435\\u043D \\u043F\\u0440\\u0435\\u0432\\u044B\\u0448\\u0430\\u0442\\u044C 200MB\", 'error');\n        return false;\n    }\n    return true;\n}\n// Обработка успешного ответа\nfunction $8aed6ce0d400e0c5$var$handleSuccessResponse(result) {\n    showAlert(\"\\u0423\\u0440\\u043E\\u043A \\u0443\\u0441\\u043F\\u0435\\u0448\\u043D\\u043E \\u0441\\u043E\\u0437\\u0434\\u0430\\u043D!\", 'success');\n    // Закрываем модальное окно\n    const modal = bootstrap.Modal.getInstance(document.getElementById('createLessonModal'));\n    modal.hide();\n    loadLessons();\n}\n// Обработка ошибки\nfunction $8aed6ce0d400e0c5$var$handleErrorResponse(result) {\n    const errorMessage = result.message || \"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u0441\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C \\u0443\\u0440\\u043E\\u043A\";\n    showAlert(errorMessage, 'error');\n    // Дополнительная обработка специфических ошибок\n    if (result.message && result.message.includes('file')) $8aed6ce0d400e0c5$var$highlightFileInput();\n}\n// Сброс формы\nfunction $8aed6ce0d400e0c5$var$resetForm() {\n    document.getElementById('createLessonForm').reset();\n    $8aed6ce0d400e0c5$var$removeValidationStyles();\n}\n// Удаление стилей валидации\nfunction $8aed6ce0d400e0c5$var$removeValidationStyles() {\n    const inputs = document.querySelectorAll('#createLessonForm .is-invalid');\n    inputs.forEach((input)=>{\n        input.classList.remove('is-invalid');\n    });\n}\n// Подсветка поля файла\nfunction $8aed6ce0d400e0c5$var$highlightFileInput() {\n    const fileInput = document.getElementById('videoFile');\n    fileInput.classList.add('is-invalid');\n}\n// Показать/скрыть загрузку\nfunction $8aed6ce0d400e0c5$var$showLoading(show) {\n    const submitBtn = document.getElementById('submitLessonBtn');\n    if (submitBtn) {\n        if (show) {\n            submitBtn.disabled = true;\n            submitBtn.innerHTML = '<i class=\"fas fa-spinner fa-spin me-1\"></i> \\u0421\\u043E\\u0437\\u0434\\u0430\\u043D\\u0438\\u0435...';\n        } else {\n            submitBtn.disabled = false;\n            submitBtn.innerHTML = '<i class=\"fas fa-plus me-1\"></i> \\u0421\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C \\u0443\\u0440\\u043E\\u043A';\n        }\n    }\n}\n// Функция для открытия модального окна\nfunction $8aed6ce0d400e0c5$var$openCreateLessonModal() {\n    // Загружаем модули если еще не загружены\n    if ($8aed6ce0d400e0c5$var$modulesList.length === 0) $8aed6ce0d400e0c5$var$loadModules();\n    const modal = new bootstrap.Modal(document.getElementById('createLessonModal'));\n    modal.show();\n}\n// Инициализация при загрузке документа\ndocument.addEventListener('DOMContentLoaded', function() {\n    $8aed6ce0d400e0c5$var$initCreateLessonForm();\n    // Добавляем кнопку открытия модального окна если нужно\n    const addButton = document.querySelector('[onclick=\"openCreateLessonModal()\"]');\n    if (addButton) addButton.addEventListener('click', $8aed6ce0d400e0c5$var$openCreateLessonModal);\n});\n// CSS стили для формы\nconst $8aed6ce0d400e0c5$var$formStyles = `\n#createLessonModal .modal-content {\n    background: var(--card-bg);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n#createLessonModal .modal-header {\n    background: var(--primary-gradient);\n    border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n#createLessonModal .modal-title {\n    color: white;\n    font-weight: 600;\n}\n\n#createLessonModal .form-select {\n    background-color: rgba(255, 255, 255, 0.05);\n    border-color: rgba(255, 255, 255, 0.1);\n    color: #e2e8f0;\n}\n\n#createLessonModal .form-select option {\n    background-color: var(--card-bg);\n    color: #e2e8f0;\n}\n\n#createLessonModal .form-control:focus,\n#createLessonModal .form-select:focus {\n    background: rgba(255, 255, 255, 0.12);\n    border-color: #6366f1;\n    box-shadow: 0 0 0 0.25rem rgba(99, 102, 241, 0.25);\n    color: #e2e8f0;\n}\n\n#createLessonModal .is-invalid {\n    border-color: #ef4444 !important;\n}\n\n#createLessonModal .form-text {\n    color: #94a3b8;\n    font-size: 0.875rem;\n}\n`;\n// Добавляем стили в документ\nconst $8aed6ce0d400e0c5$var$styleSheet = document.createElement('style');\n$8aed6ce0d400e0c5$var$styleSheet.textContent = $8aed6ce0d400e0c5$var$formStyles;\ndocument.head.appendChild($8aed6ce0d400e0c5$var$styleSheet);\nwindow.openCreateLessonModal = $8aed6ce0d400e0c5$var$openCreateLessonModal;\n\n\ndocument.addEventListener('DOMContentLoaded', function() {\n    const testGeneratorTab = document.getElementById('create-lesson-test-tab');\n    // Если на странице нет вкладки генератора тестов, ничего не делаем.\n    if (!testGeneratorTab) return;\n    const questionsContainer = testGeneratorTab.querySelector('#questionsContainer');\n    const testGeneratorForm = testGeneratorTab.querySelector('#testGeneratorForm');\n    let questionCounter = 0;\n    function createQuestionNode(questionIndex) {\n        const questionId = `question-${questionIndex}`;\n        const node = document.createElement('div');\n        node.className = 'card bg-dark border-secondary mb-4 question-card';\n        node.id = questionId;\n        node.innerHTML = `\n            <div class=\"card-header d-flex justify-content-between align-items-center\">\n                <h6 class=\"mb-0\">\\u{412}\\u{43E}\\u{43F}\\u{440}\\u{43E}\\u{441} <span class=\"question-number\">${questionIndex + 1}</span></h6>\n                <button type=\"button\" class=\"btn btn-outline-danger btn-sm remove-question-btn\">\n                    <i class=\"bi bi-trash\"></i> \\u{423}\\u{434}\\u{430}\\u{43B}\\u{438}\\u{442}\\u{44C}\n                </button>\n            </div>\n            <div class=\"card-body\">\n                <div class=\"mb-3\">\n                    <label for=\"${questionId}-text\" class=\"form-label\">\\u{422}\\u{435}\\u{43A}\\u{441}\\u{442} \\u{432}\\u{43E}\\u{43F}\\u{440}\\u{43E}\\u{441}\\u{430}:</label>\n                    <input type=\"text\" id=\"${questionId}-text\" class=\"form-control question-text\" placeholder=\"\\u{412}\\u{432}\\u{435}\\u{434}\\u{438}\\u{442}\\u{435} \\u{442}\\u{435}\\u{43A}\\u{441}\\u{442} \\u{432}\\u{43E}\\u{43F}\\u{440}\\u{43E}\\u{441}\\u{430}\" required>\n                </div>\n                <div class=\"answers-container\">\n                    <label class=\"form-label\">\\u{412}\\u{430}\\u{440}\\u{438}\\u{430}\\u{43D}\\u{442}\\u{44B} \\u{43E}\\u{442}\\u{432}\\u{435}\\u{442}\\u{43E}\\u{432} (\\u{43E}\\u{442}\\u{43C}\\u{435}\\u{442}\\u{44C}\\u{442}\\u{435} \\u{43F}\\u{440}\\u{430}\\u{432}\\u{438}\\u{43B}\\u{44C}\\u{43D}\\u{44B}\\u{439}):</label>\n                    ${[\n            0,\n            1,\n            2\n        ].map((answerIndex)=>`\n                        <div class=\"input-group mb-2\">\n                            <input type=\"text\" class=\"form-control answer-text\" placeholder=\"\\u{412}\\u{430}\\u{440}\\u{438}\\u{430}\\u{43D}\\u{442} \\u{43E}\\u{442}\\u{432}\\u{435}\\u{442}\\u{430} ${answerIndex + 1}\" required>\n                            <div class=\"input-group-text\">\n                                <input class=\"form-check-input correct-answer-radio\" type=\"radio\" name=\"${questionId}-correct\" value=\"${answerIndex}\" required>\n                            </div>\n                        </div>\n                    `).join('')}\n                </div>\n            </div>\n        `;\n        node.querySelector('.remove-question-btn').addEventListener('click', function() {\n            node.remove();\n            updateQuestionNumbers();\n        });\n        return node;\n    }\n    function updateQuestionNumbers() {\n        const allQuestions = questionsContainer.querySelectorAll('.question-card');\n        allQuestions.forEach((question, index)=>{\n            question.querySelector('.question-number').textContent = index + 1;\n        });\n    }\n    function addNewQuestion() {\n        const newNode = createQuestionNode(questionCounter);\n        questionsContainer.appendChild(newNode);\n        questionCounter++;\n        updateQuestionNumbers();\n    }\n    // --- ИСПРАВЛЕНИЕ: Используем делегирование событий ---\n    testGeneratorTab.addEventListener('click', function(event) {\n        // Проверяем, был ли клик по кнопке \"Добавить вопрос\"\n        if (event.target && event.target.id === 'addQuestionBtn') addNewQuestion();\n    });\n    if (testGeneratorForm) testGeneratorForm.addEventListener('submit', function(e) {\n        e.preventDefault();\n        generateTestCode();\n    });\n    function generateTestCode() {\n        const questionCards = questionsContainer.querySelectorAll('.question-card');\n        const generatedQuestions = [];\n        let isValid = true;\n        if (questionCards.length === 0) {\n            showAlert(\"\\u041F\\u043E\\u0436\\u0430\\u043B\\u0443\\u0439\\u0441\\u0442\\u0430, \\u0434\\u043E\\u0431\\u0430\\u0432\\u044C\\u0442\\u0435 \\u0445\\u043E\\u0442\\u044F \\u0431\\u044B \\u043E\\u0434\\u0438\\u043D \\u0432\\u043E\\u043F\\u0440\\u043E\\u0441.\", 'info');\n            return;\n        }\n        questionCards.forEach((card)=>{\n            const questionText = card.querySelector('.question-text').value;\n            const answerInputs = card.querySelectorAll('.answer-text');\n            const correctAnswerRadio = card.querySelector('.correct-answer-radio:checked');\n            if (!questionText || !correctAnswerRadio) isValid = false;\n            const answers = [];\n            answerInputs.forEach((input, answerIndex)=>{\n                if (!input.value) isValid = false;\n                answers.push({\n                    text: input.value,\n                    correct: answerIndex === parseInt(correctAnswerRadio.value)\n                });\n            });\n            generatedQuestions.push({\n                question: questionText,\n                answers: answers\n            });\n        });\n        if (!isValid) {\n            showAlert(\"\\u041F\\u043E\\u0436\\u0430\\u043B\\u0443\\u0439\\u0441\\u0442\\u0430, \\u0437\\u0430\\u043F\\u043E\\u043B\\u043D\\u0438\\u0442\\u0435 \\u0432\\u0441\\u0435 \\u0442\\u0435\\u043A\\u0441\\u0442\\u043E\\u0432\\u044B\\u0435 \\u043F\\u043E\\u043B\\u044F \\u0438 \\u0432\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u043F\\u0440\\u0430\\u0432\\u0438\\u043B\\u044C\\u043D\\u044B\\u0439 \\u043E\\u0442\\u0432\\u0435\\u0442 \\u0434\\u043B\\u044F \\u043A\\u0430\\u0436\\u0434\\u043E\\u0433\\u043E \\u0432\\u043E\\u043F\\u0440\\u043E\\u0441\\u0430.\", 'info');\n            return;\n        }\n        const code = `const questions = [\\n${generatedQuestions.map((q)=>`    {\\n        question: \"${q.question.replace(new RegExp('\"', 'g'), '\\\\\"')}\",\\n        answers: [\\n${q.answers.map((a)=>`            { text: \"${a.text.replace(new RegExp('\"', 'g'), '\\\\\"')}\", correct: ${a.correct} }`).join(',\\n')}\\n        ]\\n    }`).join(',\\n')}\\n];`;\n        document.getElementById('generatedCode').textContent = code;\n        document.getElementById('resultContainer').style.display = 'block';\n        window.generatedCodeForCopy = code;\n    }\n    // Добавляем первый вопрос только один раз, когда вкладка становится видимой\n    const tabObserver = new MutationObserver((mutations)=>{\n        mutations.forEach((mutation)=>{\n            if (mutation.attributeName === 'class' && testGeneratorTab.classList.contains('active')) // Если контейнер пуст, добавляем первый вопрос\n            {\n                if (questionsContainer.children.length === 0) addNewQuestion();\n            }\n        });\n    });\n    tabObserver.observe(testGeneratorTab, {\n        attributes: true\n    });\n});\nfunction $8c522c4a29ed76ba$var$copyToClipboard() {\n    if (!window.generatedCodeForCopy) return;\n    navigator.clipboard.writeText(window.generatedCodeForCopy).then(()=>{\n        showAlert(\"\\u041A\\u043E\\u0434 \\u0441\\u043A\\u043E\\u043F\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D \\u0432 \\u0431\\u0443\\u0444\\u0435\\u0440 \\u043E\\u0431\\u043C\\u0435\\u043D\\u0430!\", 'success');\n    }).catch((err)=>{\n        showAlert(\"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u0441\\u043A\\u043E\\u043F\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C \\u043A\\u043E\\u0434\", 'error');\n    });\n}\nwindow.copyToClipboard = $8c522c4a29ed76ba$var$copyToClipboard;\n\n\n// lessonsTable.js\nlet $7a4ff3b4d48fe0c8$var$currentLessonsPage = 1;\nlet $7a4ff3b4d48fe0c8$var$totalLessonsPages = 1;\nlet $7a4ff3b4d48fe0c8$var$totalLessonsItems = 0;\nlet $7a4ff3b4d48fe0c8$var$lessonsPerPage = 5;\n// --- NEW: Function to load modules for the filter dropdown ---\nasync function $7a4ff3b4d48fe0c8$var$loadModulesForFilter() {\n    try {\n        const response = await fetch('/admin/modules/json');\n        if (!response.ok) return null;\n        const data = await response.json();\n        if (data.success && data.data) {\n            const select = document.getElementById('moduleFilterSelect');\n            if (!select) return;\n            // Save selected value if it exists\n            const currentFilter = select.value;\n            select.innerHTML = '<option value=\"\">\\u0412\\u0441\\u0435 \\u043C\\u043E\\u0434\\u0443\\u043B\\u0438</option>'; // Reset and add default option\n            data.data.forEach((module)=>{\n                const option = document.createElement('option');\n                option.value = module.moduleId;\n                option.textContent = `${module[\"moduleTitle\"]}`;\n                select.appendChild(option);\n            });\n            // Restore selected value\n            if (currentFilter) select.value = currentFilter;\n        } else return null;\n    } catch (error) {\n        showAlert(\"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0444\\u0438\\u043B\\u044C\\u0442\\u0440 \\u043C\\u043E\\u0434\\u0443\\u043B\\u0435\\u0439.\", 'warning');\n    }\n}\n// --- MODIFIED: Load lessons with filtering capability ---\nasync function $7a4ff3b4d48fe0c8$var$loadLessons(page = 1) {\n    try {\n        $7a4ff3b4d48fe0c8$var$showLoading(true);\n        const moduleId = document.getElementById('moduleFilterSelect')?.value || '';\n        let url = `/admin/lessons?page=${page}&size=${$7a4ff3b4d48fe0c8$var$lessonsPerPage}`;\n        if (moduleId) url += `&moduleId=${moduleId}`;\n        const response = await fetch(url);\n        if (response.ok) {\n            const result = await response.json();\n            if (result.success && result.data) {\n                const paginatedData = result.data;\n                $7a4ff3b4d48fe0c8$var$currentLessonsPage = paginatedData.currentPage || page;\n                $7a4ff3b4d48fe0c8$var$totalLessonsPages = paginatedData.totalPages || 1;\n                $7a4ff3b4d48fe0c8$var$totalLessonsItems = paginatedData.totalItems || 0;\n                $7a4ff3b4d48fe0c8$var$renderLessonsTable(paginatedData.content);\n                $7a4ff3b4d48fe0c8$var$renderLessonsPagination(paginatedData.content);\n            } else showAlert(result.message || \"\\u041D\\u0435\\u0432\\u0435\\u0440\\u043D\\u044B\\u0439 \\u0444\\u043E\\u0440\\u043C\\u0430\\u0442 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445\", 'error');\n        } else {\n            // Handle cases like 404 when no lessons are found for a filter\n            if (response.status === 404) {\n                $7a4ff3b4d48fe0c8$var$renderLessonsTable([]);\n                $7a4ff3b4d48fe0c8$var$renderLessonsPagination([]);\n            } else return null;\n        }\n    } catch (error) {\n        showAlert(error.message, 'error');\n    } finally{\n        $7a4ff3b4d48fe0c8$var$showLoading(false);\n    }\n}\n// --- MODIFIED: Render lessons table with filter dropdown ---\nfunction $7a4ff3b4d48fe0c8$var$renderLessonsTable(lessons) {\n    const container = document.getElementById('lessonsContainer');\n    if (!container) return;\n    container.innerHTML = '';\n    const tableWrapper = document.createElement('div');\n    tableWrapper.className = 'courses-table-container';\n    tableWrapper.innerHTML = `\n        <div class=\"data-table courses-table lessons-table\">\n            <div class=\"table-header d-flex justify-content-between align-items-center flex-wrap\">\n                <h3 class=\"table-title mb-2 mb-md-0\">\\u{421}\\u{43F}\\u{438}\\u{441}\\u{43E}\\u{43A} \\u{443}\\u{440}\\u{43E}\\u{43A}\\u{43E}\\u{432}</h3>\n                <div class=\"d-flex align-items-center gap-2 flex-wrap\">\n                    <!-- NEW: Module Filter -->\n                    <div class=\"filter-group\">\n                        <select class=\"form-select form-select-sm\" id=\"moduleFilterSelect\" onchange=\"loadLessons(1)\">\n                            <option value=\"\">\\u{424}\\u{438}\\u{43B}\\u{44C}\\u{442}\\u{440} \\u{43F}\\u{43E} \\u{43C}\\u{43E}\\u{434}\\u{443}\\u{43B}\\u{44E}...</option>\n                        </select>\n                    </div>\n                    <div class=\"page-size-selector\">\n                        <div class=\"input-group input-group-sm\">\n                            <span class=\"input-group-text\">\\u{41E}\\u{442}\\u{43E}\\u{431}\\u{440}\\u{430}\\u{436}\\u{430}\\u{442}\\u{44C}</span>\n                            <select class=\"form-select\" id=\"lessonsPageSizeSelect\" onchange=\"changeLessonsPerPage(this.value)\">\n                                <option value=\"5\" ${$7a4ff3b4d48fe0c8$var$lessonsPerPage === 5 ? 'selected' : ''}>5</option>\n                                <option value=\"10\" ${$7a4ff3b4d48fe0c8$var$lessonsPerPage === 10 ? 'selected' : ''}>10</option>\n                                <option value=\"20\" ${$7a4ff3b4d48fe0c8$var$lessonsPerPage === 20 ? 'selected' : ''}>20</option>\n                                <option value=\"50\" ${$7a4ff3b4d48fe0c8$var$lessonsPerPage === 50 ? 'selected' : ''}>50</option>\n                            </select>\n                        </div>\n                    </div>\n                    <button class=\"btn btn-primary btn-sm\" onclick=\"openCreateLessonModal()\">\n                        <i class=\"bi bi-plus-circle me-1\"></i>\\u{41D}\\u{43E}\\u{432}\\u{44B}\\u{439} \\u{443}\\u{440}\\u{43E}\\u{43A}\n                    </button>\n                </div>\n            </div>\n\n            <div class=\"table-content\">\n                <div class=\"table-row header-row\">\n                    <div class=\"table-cell\">ID</div>\n                    <div class=\"table-cell\">\\u{41D}\\u{430}\\u{437}\\u{432}\\u{430}\\u{43D}\\u{438}\\u{435}</div>\n                    <div class=\"table-cell\">\\u{41C}\\u{43E}\\u{434}\\u{443}\\u{43B}\\u{44C}</div>\n                    <div class=\"table-cell\">\\u{41E}\\u{43F}\\u{438}\\u{441}\\u{430}\\u{43D}\\u{438}\\u{435}</div>\n                    <div class=\"table-cell\">\\u{412}\\u{438}\\u{434}\\u{435}\\u{43E}</div>\n                    <div class=\"table-cell\">\\u{414}\\u{435}\\u{439}\\u{441}\\u{442}\\u{432}\\u{438}\\u{44F}</div>\n                </div>\n\n                ${lessons.length > 0 ? lessons.map((lesson)=>`\n                <div class=\"table-row\">\n                    <div class=\"table-cell text-muted\">#${lesson.id || 'N/A'}</div>\n                    <div class=\"table-cell\">\n                        <div class=\"fw-bold\">${$7a4ff3b4d48fe0c8$var$escapeHtml(lesson.title || \"\\u0411\\u0435\\u0437 \\u043D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u044F\")}</div>\n                    </div>\n                    <div class=\"table-cell\">\n                        <span class=\"text-muted\">${$7a4ff3b4d48fe0c8$var$escapeHtml(lesson[\"moduleName\"] || 'N/A')}</span>\n                    </div>\n                    <div class=\"table-cell\">\n                        <span class=\"lesson-description\">${$7a4ff3b4d48fe0c8$var$truncateText(lesson.description || \"\\u041D\\u0435\\u0442 \\u043E\\u043F\\u0438\\u0441\\u0430\\u043D\\u0438\\u044F\", 100)}</span>\n                    </div>\n                    <div class=\"table-cell\">\n                        ${lesson.video ? `\n                            <a href=\"/admin/video/${lesson.video}\" class=\"text-primary text-decoration-none\">\n                                <i class=\"bi bi-camera-video me-1\"></i> \\u{421}\\u{43C}\\u{43E}\\u{442}\\u{440}\\u{435}\\u{442}\\u{44C}\n                            </a>\n                        ` : '<span class=\"text-muted\">\\u041D\\u0435\\u0442 \\u0432\\u0438\\u0434\\u0435\\u043E</span>'}\n                    </div>\n                    <div class=\"table-cell action-buttons\">\n                        <button class=\"btn btn-info btn-icon btn-sm edit-lesson-btn\" title=\"\\u{420}\\u{435}\\u{434}\\u{430}\\u{43A}\\u{442}\\u{438}\\u{440}\\u{43E}\\u{432}\\u{430}\\u{442}\\u{44C}\" data-lesson-id=\"${lesson.id}\">\n                            <i class=\"bi bi-pencil\"></i>\n                        </button>\n                        <button class=\"btn btn-danger btn-icon btn-sm\" title=\"\\u{423}\\u{434}\\u{430}\\u{43B}\\u{438}\\u{442}\\u{44C}\"\n                                onclick=\"deleteLesson(${lesson.id}, '${$7a4ff3b4d48fe0c8$var$escapeHtml(lesson.title)}')\">\n                            <i class=\"bi bi-trash\"></i>\n                        </button>\n                    </div>\n                </div>\n                `).join('') : `\n                <div class=\"table-row\">\n                    <div class=\"table-cell\" style=\"grid-column: 1 / -1; text-align: center; padding: 2rem; color: #94a3b8;\">\n                        <i class=\"bi bi-book-open me-2\"></i>\n                        \\u{423}\\u{440}\\u{43E}\\u{43A}\\u{438} \\u{43D}\\u{435} \\u{43D}\\u{430}\\u{439}\\u{434}\\u{435}\\u{43D}\\u{44B}. \\u{418}\\u{437}\\u{43C}\\u{435}\\u{43D}\\u{438}\\u{442}\\u{435} \\u{444}\\u{438}\\u{43B}\\u{44C}\\u{442}\\u{440} \\u{438}\\u{43B}\\u{438} \\u{434}\\u{43E}\\u{431}\\u{430}\\u{432}\\u{44C}\\u{442}\\u{435} \\u{43D}\\u{43E}\\u{432}\\u{44B}\\u{439} \\u{443}\\u{440}\\u{43E}\\u{43A}.\n                    </div>\n                </div>\n                `}\n            </div>\n        </div>\n    `;\n    container.appendChild(tableWrapper);\n    // --- NEW: Populate the filter after rendering the table structure ---\n    $7a4ff3b4d48fe0c8$var$loadModulesForFilter();\n}\n// Рендер пагинации\nfunction $7a4ff3b4d48fe0c8$var$renderLessonsPagination(lessons) {\n    const container = document.getElementById('lessonsPagination');\n    if (!container) return;\n    if ($7a4ff3b4d48fe0c8$var$totalLessonsPages <= 1) {\n        container.innerHTML = '';\n        return;\n    }\n    let paginationHTML = `\n        <nav aria-label=\"Page navigation\">\n            <ul class=\"pagination justify-content-center\">\n                <li class=\"page-item ${$7a4ff3b4d48fe0c8$var$currentLessonsPage === 1 ? 'disabled' : ''}\">\n                    <a class=\"page-link\" href=\"#\" onclick=\"changeLessonsPage(${$7a4ff3b4d48fe0c8$var$currentLessonsPage - 1}); return false;\">&laquo;</a>\n                </li>\n    `;\n    const maxVisiblePages = 5;\n    let startPage = Math.max(1, $7a4ff3b4d48fe0c8$var$currentLessonsPage - Math.floor(maxVisiblePages / 2));\n    let endPage = Math.min($7a4ff3b4d48fe0c8$var$totalLessonsPages, startPage + maxVisiblePages - 1);\n    if (endPage - startPage + 1 < maxVisiblePages) startPage = Math.max(1, endPage - maxVisiblePages + 1);\n    if (startPage > 1) {\n        paginationHTML += `<li class=\"page-item\"><a class=\"page-link\" href=\"#\" onclick=\"changeLessonsPage(1); return false;\">1</a></li>`;\n        if (startPage > 2) paginationHTML += `<li class=\"page-item disabled\"><span class=\"page-link\">...</span></li>`;\n    }\n    for(let i = startPage; i <= endPage; i++)paginationHTML += `<li class=\"page-item ${i === $7a4ff3b4d48fe0c8$var$currentLessonsPage ? 'active' : ''}\"><a class=\"page-link\" href=\"#\" onclick=\"changeLessonsPage(${i}); return false;\">${i}</a></li>`;\n    if (endPage < $7a4ff3b4d48fe0c8$var$totalLessonsPages) {\n        if (endPage < $7a4ff3b4d48fe0c8$var$totalLessonsPages - 1) paginationHTML += `<li class=\"page-item disabled\"><span class=\"page-link\">...</span></li>`;\n        paginationHTML += `<li class=\"page-item\"><a class=\"page-link\" href=\"#\" onclick=\"changeLessonsPage(${$7a4ff3b4d48fe0c8$var$totalLessonsPages}); return false;\">${$7a4ff3b4d48fe0c8$var$totalLessonsPages}</a></li>`;\n    }\n    paginationHTML += `\n                <li class=\"page-item ${$7a4ff3b4d48fe0c8$var$currentLessonsPage === $7a4ff3b4d48fe0c8$var$totalLessonsPages ? 'disabled' : ''}\">\n                    <a class=\"page-link\" href=\"#\" onclick=\"changeLessonsPage(${$7a4ff3b4d48fe0c8$var$currentLessonsPage + 1}); return false;\">&raquo;</a>\n                </li>\n            </ul>\n        </nav>\n        \n        <div class=\"pagination-info text-center mt-2\">\n            <small class=\"text-muted\">\n                \\u{421}\\u{442}\\u{440}\\u{430}\\u{43D}\\u{438}\\u{446}\\u{430} ${$7a4ff3b4d48fe0c8$var$currentLessonsPage} \\u{438}\\u{437} ${$7a4ff3b4d48fe0c8$var$totalLessonsPages} \\u{2022} \\u{41F}\\u{43E}\\u{43A}\\u{430}\\u{437}\\u{430}\\u{43D}\\u{43E} ${lessons.length} \\u{438}\\u{437} ${$7a4ff3b4d48fe0c8$var$totalLessonsItems} \\u{443}\\u{440}\\u{43E}\\u{43A}\\u{43E}\\u{432}\n            </small>\n        </div>\n    `;\n    container.innerHTML = paginationHTML;\n}\n// Смена страницы\nfunction $7a4ff3b4d48fe0c8$var$changeLessonsPage(page) {\n    if (page < 1 || page > $7a4ff3b4d48fe0c8$var$totalLessonsPages || page === $7a4ff3b4d48fe0c8$var$currentLessonsPage) return;\n    $7a4ff3b4d48fe0c8$var$loadLessons(page);\n}\n// Изменение количества уроков на странице\nfunction $7a4ff3b4d48fe0c8$var$changeLessonsPerPage(perPage) {\n    $7a4ff3b4d48fe0c8$var$lessonsPerPage = parseInt(perPage) || 10;\n    $7a4ff3b4d48fe0c8$var$loadLessons(1);\n}\n// Вспомогательные функции\nfunction $7a4ff3b4d48fe0c8$var$showLoading(show) {\n    const container = document.getElementById('lessonsContainer');\n    if (!container) return;\n    if (show) container.innerHTML = `\n            <div class=\"d-flex justify-content-center align-items-center\" style=\"height: 200px;\">\n                <div class=\"spinner-border text-primary\" role=\"status\">\n                    <span class=\"visually-hidden\">\\u{417}\\u{430}\\u{433}\\u{440}\\u{443}\\u{437}\\u{43A}\\u{430}...</span>\n                </div>\n            </div>\n        `;\n}\nfunction $7a4ff3b4d48fe0c8$var$truncateText(text, maxLength) {\n    if (!text || text.length <= maxLength) return $7a4ff3b4d48fe0c8$var$escapeHtml(text || '');\n    return $7a4ff3b4d48fe0c8$var$escapeHtml(text.substring(0, maxLength)) + '...';\n}\nfunction $7a4ff3b4d48fe0c8$var$escapeHtml(text) {\n    if (typeof text !== 'string') return '';\n    const div = document.createElement('div');\n    div.textContent = text;\n    return div.innerHTML;\n}\nasync function $7a4ff3b4d48fe0c8$var$deleteLesson(lessonId, lessonTitle) {\n    if (!confirm(`\\u{412}\\u{44B} \\u{443}\\u{432}\\u{435}\\u{440}\\u{435}\\u{43D}\\u{44B}, \\u{447}\\u{442}\\u{43E} \\u{445}\\u{43E}\\u{442}\\u{438}\\u{442}\\u{435} \\u{443}\\u{434}\\u{430}\\u{43B}\\u{438}\\u{442}\\u{44C} \\u{443}\\u{440}\\u{43E}\\u{43A} \"${lessonTitle}\"?`)) return;\n    try {\n        const headers = {\n            'Content-Type': 'application/json'\n        };\n        const response = await fetch(`/admin/lessons/${lessonId}/delete`, {\n            method: 'DELETE',\n            headers: headers\n        });\n        const result = await response.json().catch(()=>({})); // Handle empty response\n        if (response.ok && result.success) {\n            showAlert(`\\u{423}\\u{440}\\u{43E}\\u{43A} \"${lessonTitle}\" \\u{443}\\u{441}\\u{43F}\\u{435}\\u{448}\\u{43D}\\u{43E} \\u{443}\\u{434}\\u{430}\\u{43B}\\u{435}\\u{43D}.`, 'success');\n            $7a4ff3b4d48fe0c8$var$loadLessons($7a4ff3b4d48fe0c8$var$currentLessonsPage || 1);\n        } else {\n            const errorMessage = result.message || `\\u{41E}\\u{448}\\u{438}\\u{431}\\u{43A}\\u{430} \\u{443}\\u{434}\\u{430}\\u{43B}\\u{435}\\u{43D}\\u{438}\\u{44F}: ${response.status}`;\n            showAlert(errorMessage, 'error');\n        }\n    } catch (error) {\n        showAlert(error.message, 'error');\n    }\n}\n// Инициализация\ndocument.addEventListener('DOMContentLoaded', function() {\n    const lessonsTabTrigger = document.querySelector('a[data-tab=\"lessons-edit-tab\"]');\n    if (lessonsTabTrigger) {\n        lessonsTabTrigger.addEventListener('click', function() {\n            // Ensure we load lessons only when the tab is activated\n            setTimeout(()=>$7a4ff3b4d48fe0c8$var$loadLessons(1), 10);\n        });\n        // If the tab is already active on page load, load lessons\n        if (document.getElementById('lessons-edit-tab')?.classList.contains('active')) $7a4ff3b4d48fe0c8$var$loadLessons(1);\n    }\n});\nwindow.loadLessons = $7a4ff3b4d48fe0c8$var$loadLessons;\nwindow.changeLessonsPerPage = $7a4ff3b4d48fe0c8$var$changeLessonsPerPage;\nwindow.changeLessonsPage = $7a4ff3b4d48fe0c8$var$changeLessonsPage;\nwindow.deleteLesson = $7a4ff3b4d48fe0c8$var$deleteLesson;\n\n\ndocument.addEventListener('DOMContentLoaded', function() {\n    // Используем делегирование событий для кнопок редактирования\n    document.getElementById('modulesContainer').addEventListener('click', function(event) {\n        const editButton = event.target.closest('.edit-module-btn');\n        if (editButton) {\n            const moduleId = editButton.dataset.moduleId;\n            $9b6a05fde002bfd2$var$openEditModuleModal(moduleId);\n        }\n    });\n    // Обработка отправки формы\n    const editModuleForm = document.getElementById('editModuleForm');\n    if (editModuleForm) editModuleForm.addEventListener('submit', async function(event) {\n        event.preventDefault();\n        await $9b6a05fde002bfd2$var$submitEditModuleForm();\n    });\n});\nasync function $9b6a05fde002bfd2$var$openEditModuleModal(moduleId) {\n    try {\n        // 1. Получаем данные модуля\n        const response = await fetch(`/admin/module/${moduleId}`);\n        const result = await response.json();\n        if (response.ok && result.success && result.data) {\n            const module = result.data;\n            // 2. Заполняем поля формы\n            document.getElementById('editModuleId').value = module.moduleId;\n            document.getElementById('editModuleTitle').value = module[\"moduleTitle\"];\n            document.getElementById('editModuleSlug').value = module[\"moduleSlug\"];\n            // 3. Загружаем и устанавливаем курс\n            const courseSelect = document.getElementById('editModuleCourseId');\n            await $9b6a05fde002bfd2$var$loadCoursesIntoSelect(courseSelect, module[\"courseName\"]);\n            // 4. Показываем модальное окно\n            const modal = new bootstrap.Modal(document.getElementById('editModuleModal'));\n            modal.show();\n        } else showAlert(result.message || \"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u043F\\u043E\\u043B\\u0443\\u0447\\u0438\\u0442\\u044C \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435 \\u043C\\u043E\\u0434\\u0443\\u043B\\u044F.\", 'error');\n    } catch (error) {\n        console.error(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u043F\\u0440\\u0438 \\u043E\\u0442\\u043A\\u0440\\u044B\\u0442\\u0438\\u0438 \\u043C\\u043E\\u0434\\u0430\\u043B\\u044C\\u043D\\u043E\\u0433\\u043E \\u043E\\u043A\\u043D\\u0430:\", error);\n        showAlert(\"\\u041A\\u0440\\u0438\\u0442\\u0438\\u0447\\u0435\\u0441\\u043A\\u0430\\u044F \\u043E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u043F\\u0440\\u0438 \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0435 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445 \\u043C\\u043E\\u0434\\u0443\\u043B\\u044F.\", 'error');\n    }\n}\nasync function $9b6a05fde002bfd2$var$submitEditModuleForm() {\n    const form = document.getElementById('editModuleForm');\n    const moduleId = document.getElementById('editModuleId').value;\n    const modal = bootstrap.Modal.getInstance(document.getElementById('editModuleModal'));\n    const formData = {\n        moduleId: moduleId,\n        name: document.getElementById('editModuleTitle').value,\n        slug: document.getElementById('editModuleSlug').value,\n        courseId: document.getElementById('editModuleCourseId').value\n    };\n    try {\n        const response = await fetch(`/admin/modules/update`, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'X-CSRF-TOKEN': $9b6a05fde002bfd2$var$getCsrfToken()\n            },\n            body: JSON.stringify(formData)\n        });\n        const result = await response.json();\n        if (response.ok && result.status === 'success') {\n            showAlert(result.message || \"\\u041C\\u043E\\u0434\\u0443\\u043B\\u044C \\u0443\\u0441\\u043F\\u0435\\u0448\\u043D\\u043E \\u043E\\u0431\\u043D\\u043E\\u0432\\u043B\\u0435\\u043D!\", 'success');\n            modal.hide();\n            // Обновляем таблицу модулей\n            if (typeof loadModules === 'function') loadModules(window.currentModulesPage || 1);\n        } else // Обработка ошибок валидации или других сообщений об ошибках\n        if (result.errors) {\n            const errorMessages = Object.values(result.errors).join('\\n');\n            showAlert(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0432\\u0430\\u043B\\u0438\\u0434\\u0430\\u0446\\u0438\\u0438:\\n\" + errorMessages, 'error');\n        } else {\n            showAlert(result.message || \"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u043E\\u0431\\u043D\\u043E\\u0432\\u0438\\u0442\\u044C \\u043C\\u043E\\u0434\\u0443\\u043B\\u044C.\", 'error');\n            console.error(new Error(result.message || \"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u043E\\u0431\\u043D\\u043E\\u0432\\u0438\\u0442\\u044C \\u043C\\u043E\\u0434\\u0443\\u043B\\u044C.\"));\n        }\n    } catch (error) {\n        console.error(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u043F\\u0440\\u0438 \\u043E\\u0431\\u043D\\u043E\\u0432\\u043B\\u0435\\u043D\\u0438\\u0438 \\u043C\\u043E\\u0434\\u0443\\u043B\\u044F:\", error);\n        showAlert(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430: \" + error.message, 'error');\n    }\n}\n// Загрузка списка курсов в select\nasync function $9b6a05fde002bfd2$var$loadCoursesIntoSelect(selectElement, selectedCourseTitle) {\n    try {\n        const response = await fetch('/admin/courses/all');\n        if (!response.ok) console.error(new Error(\"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0441\\u043F\\u0438\\u0441\\u043E\\u043A \\u043A\\u0443\\u0440\\u0441\\u043E\\u0432.\"));\n        const data = await response.json();\n        const courses = data.data; // Corrected: data is in data.data\n        selectElement.innerHTML = '<option value=\"\">\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u043A\\u0443\\u0440\\u0441</option>';\n        courses.forEach((course)=>{\n            const option = document.createElement('option');\n            option.value = course.id;\n            option.textContent = course.title;\n            if (course.title === selectedCourseTitle) option.selected = true;\n            selectElement.appendChild(option);\n        });\n    } catch (error) {\n        console.error(error);\n        selectElement.innerHTML = '<option value=\"\">\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0438 \\u043A\\u0443\\u0440\\u0441\\u043E\\u0432</option>';\n    }\n}\nfunction $9b6a05fde002bfd2$var$getCsrfToken() {\n    return document.querySelector('meta[name=\"_csrf\"]')?.content || document.querySelector('input[name=\"_csrf\"]')?.value;\n}\nwindow.loadCoursesIntoSelect = $9b6a05fde002bfd2$var$loadCoursesIntoSelect;\nwindow.submitEditModuleForm = $9b6a05fde002bfd2$var$submitEditModuleForm;\nwindow.openEditModuleModal = $9b6a05fde002bfd2$var$openEditModuleModal;\n\n\ndocument.addEventListener('DOMContentLoaded', function() {\n    const form = document.getElementById('createModuleForm');\n    const courseSelect = document.getElementById('moduleCourseId');\n    const titleInput = document.getElementById('moduleTitle');\n    const slugInput = document.getElementById('moduleSlug');\n    const courseSelectAdminCreateModule = document.getElementById('moduleCourseId');\n    loadCoursesIntoSelect(courseSelectAdminCreateModule, null);\n    // Load courses when the tab is shown\n    const createModuleTab = document.querySelector('a[data-tab=\"create-module-tab\"]');\n    if (createModuleTab) createModuleTab.addEventListener('click', loadCourses);\n    // Also load courses if the tab is already active on page load\n    if (document.getElementById('create-module-tab')?.classList.contains('active')) loadCourses();\n    if (form) form.addEventListener('submit', async function(event) {\n        event.preventDefault();\n        if (!validateForm()) return;\n        try {\n            const formData = {\n                courseId: courseSelect.value,\n                slug: slugInput.value,\n                title: titleInput.value\n            };\n            const csrfToken = document.querySelector('meta[name=\"_csrf\"]')?.content;\n            const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]')?.content;\n            const headers = {\n                'Content-Type': 'application/json'\n            };\n            if (csrfToken && csrfHeader) headers[csrfHeader] = csrfToken;\n            const response = await fetch('/admin/modules/create', {\n                method: 'POST',\n                headers: headers,\n                body: JSON.stringify(formData)\n            });\n            const result = await response.json();\n            if (response.ok && result.status === 'success') {\n                showAlert(result.message || \"\\u041C\\u043E\\u0434\\u0443\\u043B\\u044C \\u0443\\u0441\\u043F\\u0435\\u0448\\u043D\\u043E \\u0441\\u043E\\u0437\\u0434\\u0430\\u043D!\", 'success');\n                form.reset();\n                // Optionally, switch back to the modules list tab\n                const modulesTab = document.querySelector('a[data-tab=\"modules-edit-tab\"]');\n                if (modulesTab) modulesTab.click();\n            } else {\n                if (result.errors) {\n                    const errorMessages = Object.values(result.errors).join('\\n');\n                    showAlert(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0432\\u0430\\u043B\\u0438\\u0434\\u0430\\u0446\\u0438\\u0438:\\n\" + errorMessages, 'error');\n                } else showAlert(result.message || \"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u043F\\u0440\\u0438 \\u0441\\u043E\\u0437\\u0434\\u0430\\u043D\\u0438\\u0438 \\u043C\\u043E\\u0434\\u0443\\u043B\\u044F\", 'error');\n                console.error('Server error:', result.message || result.errors);\n            }\n        } catch (error) {\n            console.error(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u043E\\u0442\\u043F\\u0440\\u0430\\u0432\\u043A\\u0438:\", error);\n            showAlert(\"\\u041F\\u0440\\u043E\\u0438\\u0437\\u043E\\u0448\\u043B\\u0430 \\u043A\\u0440\\u0438\\u0442\\u0438\\u0447\\u0435\\u0441\\u043A\\u0430\\u044F \\u043E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u043F\\u0440\\u0438 \\u043E\\u0442\\u043F\\u0440\\u0430\\u0432\\u043A\\u0435 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445\", 'error');\n        }\n    });\n    function validateForm() {\n        if (!courseSelect.value) {\n            showAlert(\"\\u041F\\u043E\\u0436\\u0430\\u043B\\u0443\\u0439\\u0441\\u0442\\u0430, \\u0432\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u043A\\u0443\\u0440\\u0441\", 'error');\n            return false;\n        }\n        if (!titleInput.value.trim()) {\n            showAlert(\"\\u041F\\u043E\\u0436\\u0430\\u043B\\u0443\\u0439\\u0441\\u0442\\u0430, \\u0432\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 \\u043C\\u043E\\u0434\\u0443\\u043B\\u044F\", 'error');\n            return false;\n        }\n        if (!slugInput.value.trim()) {\n            showAlert(\"\\u041F\\u043E\\u0436\\u0430\\u043B\\u0443\\u0439\\u0441\\u0442\\u0430, \\u0443\\u043A\\u0430\\u0436\\u0438\\u0442\\u0435 URI \\u043C\\u043E\\u0434\\u0443\\u043B\\u044F\", 'error');\n            return false;\n        }\n        const slugRegex = /^[a-z0-9-]+$/;\n        if (!slugRegex.test(slugInput.value)) {\n            showAlert(\"URI \\u043C\\u043E\\u0436\\u0435\\u0442 \\u0441\\u043E\\u0434\\u0435\\u0440\\u0436\\u0430\\u0442\\u044C \\u0442\\u043E\\u043B\\u044C\\u043A\\u043E \\u043B\\u0430\\u0442\\u0438\\u043D\\u0441\\u043A\\u0438\\u0435 \\u0431\\u0443\\u043A\\u0432\\u044B \\u0432 \\u043D\\u0438\\u0436\\u043D\\u0435\\u043C \\u0440\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0435, \\u0446\\u0438\\u0444\\u0440\\u044B \\u0438 \\u0434\\u0435\\u0444\\u0438\\u0441\\u044B\", 'error');\n            return false;\n        }\n        return true;\n    }\n    let isSlugManuallyEdited = false;\n    if (titleInput && slugInput) {\n        // Generate slug as user types in the title field\n        titleInput.addEventListener('input', ()=>{\n            if (!isSlugManuallyEdited) generateSlugFromTitle();\n        });\n        // Detect when user edits the slug field manually to disable auto-generation\n        slugInput.addEventListener('input', ()=>{\n            isSlugManuallyEdited = true;\n        });\n    }\n    function generateSlugFromTitle() {\n        const title = titleInput.value.trim();\n        if (title) {\n            const translitMap = {\n                \"\\u0430\": 'a',\n                \"\\u0431\": 'b',\n                \"\\u0432\": 'v',\n                \"\\u0433\": 'g',\n                \"\\u0434\": 'd',\n                \"\\u0435\": 'e',\n                \"\\u0451\": 'yo',\n                \"\\u0436\": 'zh',\n                \"\\u0437\": 'z',\n                \"\\u0438\": 'i',\n                \"\\u0439\": 'y',\n                \"\\u043A\": 'k',\n                \"\\u043B\": 'l',\n                \"\\u043C\": 'm',\n                \"\\u043D\": 'n',\n                \"\\u043E\": 'o',\n                \"\\u043F\": 'p',\n                \"\\u0440\": 'r',\n                \"\\u0441\": 's',\n                \"\\u0442\": 't',\n                \"\\u0443\": 'u',\n                \"\\u0444\": 'f',\n                \"\\u0445\": 'h',\n                \"\\u0446\": 'ts',\n                \"\\u0447\": 'ch',\n                \"\\u0448\": 'sh',\n                \"\\u0449\": 'shch',\n                \"\\u044A\": '',\n                \"\\u044B\": 'y',\n                \"\\u044C\": '',\n                \"\\u044D\": 'e',\n                \"\\u044E\": 'yu',\n                \"\\u044F\": 'ya'\n            };\n            let slug = title.toLowerCase();\n            let result = '';\n            for(let i = 0; i < slug.length; i++)result += translitMap[slug[i]] || slug[i];\n            slug = result.replace(/['\"’]/g, '') // remove quotes\n            .replace(/\\s+/g, '-') // collapse whitespace and replace by -\n            .replace(/[^a-z0-9-]/g, '') // remove invalid chars\n            .replace(/-+/g, '-') // collapse dashes\n            .replace(/^-|-$/g, ''); // trim - from start or end\n            slugInput.value = slug;\n        }\n    }\n});\n\n\nfunction $f38f682e9753443c$var$deleteModule(id) {\n    // Показываем подтверждающее окно\n    const isConfirmed = confirm(\"\\u0412\\u044B \\u0443\\u0432\\u0435\\u0440\\u0435\\u043D\\u044B, \\u0447\\u0442\\u043E \\u0445\\u043E\\u0442\\u0438\\u0442\\u0435 \\u0443\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u044D\\u0442\\u043E\\u0442 \\u043C\\u043E\\u0434\\u0443\\u043B\\u044C, \\u0438 \\u0432\\u0441\\u0435 \\u0435\\u0433\\u043E \\u0443\\u0440\\u043E\\u043A\\u0438? \\u042D\\u0442\\u043E \\u0434\\u0435\\u0439\\u0441\\u0442\\u0432\\u0438\\u0435 \\u043D\\u0435\\u043B\\u044C\\u0437\\u044F \\u043E\\u0442\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C.\");\n    if (!isConfirmed) return; // Если пользователь отменил, прерываем выполнение\n    // Отправляем запрос на сервер\n    fetch(`/admin/module/${id}/delete`, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n            'X-CSRF-TOKEN': document.querySelector('meta[name=\"_csrf\"]')?.content || '' // Для Spring Security CSRF\n        }\n    }).then((response)=>{\n        // Всегда пытаемся парсить JSON, даже для \"плохих\" ответов\n        return response.json().then((data)=>{\n            if (!response.ok) // Если ответ не \"ok\", создаем ошибку с сообщением от сервера\n            throw new Error(data.message || \"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u043F\\u0440\\u0438 \\u0443\\u0434\\u0430\\u043B\\u0435\\u043D\\u0438\\u0438 \\u043C\\u043E\\u0434\\u0443\\u043B\\u044F\");\n            return data; // Возвращаем данные, если все в порядке\n        });\n    }).then((data)=>{\n        // Успешное удаление\n        showAlert(data.message || \"\\u041C\\u043E\\u0434\\u0443\\u043B\\u044C \\u0443\\u0441\\u043F\\u0435\\u0448\\u043D\\u043E \\u0443\\u0434\\u0430\\u043B\\u0435\\u043D\", 'success');\n        // Обновляем таблицу модулей без перезагрузки страницы\n        if (typeof loadModules === 'function') loadModules(window.currentModulesPage || 1);\n    }).catch((error)=>{\n        // Обработка ошибок\n        showAlert(`\\u{41E}\\u{448}\\u{438}\\u{431}\\u{43A}\\u{430}: ${error.message}`, 'error');\n        console.error(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u043F\\u0440\\u0438 \\u0443\\u0434\\u0430\\u043B\\u0435\\u043D\\u0438\\u0438 \\u043C\\u043E\\u0434\\u0443\\u043B\\u044F:\", error);\n    });\n}\nwindow.deleteModule = $f38f682e9753443c$var$deleteModule;\n\n\nfunction $09e94a265998fc92$var$adminUpdateModuleStatus(moduleID, status) {\n    const isConfirmed = confirm(\"\\u0412\\u044B \\u0443\\u0432\\u0435\\u0440\\u0435\\u043D\\u044B, \\u0447\\u0442\\u043E \\u0445\\u043E\\u0442\\u0438\\u0442\\u0435 \\u043E\\u0431\\u043D\\u043E\\u0432\\u0438\\u0442\\u044C \\u0441\\u0442\\u0430\\u0442\\u0443\\u0441?\");\n    if (!isConfirmed) return; // Если пользователь отменил, прерываем выполнение\n    if (status === 'ACTIVE') status = 'INACTIVE';\n    else status = 'ACTIVE';\n    // Отправляем запрос на сервер\n    fetch(`/admin/modules/updateStatus/${moduleID}/${status}`, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n            'X-CSRF-TOKEN': document.querySelector('meta[name=\"_csrf\"]')?.content || '' // Для Spring Security CSRF\n        }\n    }).then((response)=>{\n        return response.json().then((data)=>{\n            if (!response.ok) throw new Error(data.message || \"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u043F\\u0440\\u0438 \\u043E\\u0431\\u043D\\u043E\\u0432\\u043B\\u0435\\u043D\\u0438\\u0438 \\u0441\\u0442\\u0430\\u0442\\u0443\\u0441\\u0430\");\n            return data;\n        });\n    }).then((data)=>{\n        // Успешное обновление\n        showAlert(data.message, 'success');\n        // Обновляем таблицу модулей без перезагрузки страницы\n        if (typeof loadModules === 'function') loadModules(window.currentModulesPage || 1);\n    }).catch((error)=>{\n        // Обработка ошибок\n        showAlert(`\\u{41E}\\u{448}\\u{438}\\u{431}\\u{43A}\\u{430}: ${error.message}`, 'error');\n        console.error(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u043F\\u0440\\u0438 \\u043E\\u0431\\u043D\\u043E\\u0432\\u043B\\u0435\\u043D\\u0438\\u0438 \\u0441\\u0442\\u0430\\u0442\\u0443\\u0441\\u0430:\", error);\n    });\n}\nwindow.adminUpdateModuleStatus = $09e94a265998fc92$var$adminUpdateModuleStatus;\n\n\nasync function $063ae47fa067d23e$var$loadModuleLessons(moduleId) {\n    try {\n        const response = await fetch(`/admin/modules/${moduleId}/lessons`);\n        // Case 1: Success (200 OK)\n        if (response.ok) {\n            const result = await response.json();\n            if (result.success) $063ae47fa067d23e$var$showLessonsModal(result.data);\n            else showAlert(result.message || \"\\u041F\\u043E\\u043B\\u0443\\u0447\\u0435\\u043D \\u043D\\u0435\\u043E\\u0436\\u0438\\u0434\\u0430\\u043D\\u043D\\u044B\\u0439 \\u043E\\u0442\\u0432\\u0435\\u0442 \\u043E\\u0442 \\u0441\\u0435\\u0440\\u0432\\u0435\\u0440\\u0430.\", 'warning');\n            return;\n        }\n        // Case 2: Not Found (404)\n        if (response.status === 404) {\n            showAlert(\"\\u0412 \\u044D\\u0442\\u043E\\u043C \\u043C\\u043E\\u0434\\u0443\\u043B\\u0435 \\u043F\\u043E\\u043A\\u0430 \\u043D\\u0435\\u0442 \\u0443\\u0440\\u043E\\u043A\\u043E\\u0432.\", 'info');\n            // Show an empty modal for better UX\n            $063ae47fa067d23e$var$showLessonsModal([]);\n            return;\n        }\n        // Case 3: Server Error (500) or other client errors (4xx)\n        let errorMessage = `HTTP \\u{43E}\\u{448}\\u{438}\\u{431}\\u{43A}\\u{430}: ${response.status} ${response.statusText}`;\n        try {\n            // Try to get a more specific error message from the response body\n            const errorData = await response.json();\n            if (errorData && errorData.error) errorMessage = `\\u{41E}\\u{448}\\u{438}\\u{431}\\u{43A}\\u{430} \\u{43D}\\u{430} \\u{441}\\u{435}\\u{440}\\u{432}\\u{435}\\u{440}\\u{435}: ${errorData.error}`;\n        } catch (e) {\n            // Body is not JSON or is empty, stick with the generic HTTP error message\n            console.error(\"Could not parse error JSON.\", e);\n        }\n        showAlert(errorMessage, 'error');\n        console.error('Failed to load lessons:', errorMessage);\n    } catch (error) {\n        // Case 4: Network error or other fetch-related failures\n        console.error('Network or fetch error:', error);\n        showAlert(\"\\u0421\\u0435\\u0442\\u0435\\u0432\\u0430\\u044F \\u043E\\u0448\\u0438\\u0431\\u043A\\u0430. \\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u043F\\u043E\\u0434\\u043A\\u043B\\u044E\\u0447\\u0438\\u0442\\u044C\\u0441\\u044F \\u043A \\u0441\\u0435\\u0440\\u0432\\u0435\\u0440\\u0443.\", 'error');\n    }\n}\nfunction $063ae47fa067d23e$var$showLessonsModal(lessons) {\n    // Create the modal if it doesn't exist yet\n    if (!document.getElementById('lessonsModal')) {\n        const modalHtml = `\n            <div class=\"modal fade\" id=\"lessonsModal\" tabindex=\"-1\" aria-labelledby=\"lessonsModalLabel\" aria-hidden=\"true\">\n                <div class=\"modal-dialog modal-lg\">\n                    <div class=\"modal-content\">\n                        <div class=\"modal-header\">\n                            <h5 class=\"modal-title\" id=\"lessonsModalLabel\">\\u{423}\\u{440}\\u{43E}\\u{43A}\\u{438} \\u{43C}\\u{43E}\\u{434}\\u{443}\\u{43B}\\u{44F}</h5>\n                            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n                        </div>\n                        <div class=\"modal-body\" id=\"lessonsModalBody\">\n                            <!-- Lesson list will be inserted here -->\n                        </div>\n                        <div class=\"modal-footer\">\n                            <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">\\u{417}\\u{430}\\u{43A}\\u{440}\\u{44B}\\u{442}\\u{44C}</button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        `;\n        document.body.insertAdjacentHTML('beforeend', modalHtml);\n    }\n    const modalBody = document.getElementById('lessonsModalBody');\n    const modalTitle = document.getElementById('lessonsModalLabel');\n    if (lessons.length === 0) {\n        modalTitle.textContent = \"\\u0423\\u0440\\u043E\\u043A\\u0438 \\u043C\\u043E\\u0434\\u0443\\u043B\\u044F\";\n        modalBody.innerHTML = `\n            <div class=\"text-center py-4\">\n                <i class=\"bi bi-book-half fa-3x text-muted mb-3\"></i>\n                <h5 class=\"text-muted\">\\u{412} \\u{44D}\\u{442}\\u{43E}\\u{43C} \\u{43C}\\u{43E}\\u{434}\\u{443}\\u{43B}\\u{435} \\u{43D}\\u{435}\\u{442} \\u{443}\\u{440}\\u{43E}\\u{43A}\\u{43E}\\u{432}</h5>\n                <p class=\"text-muted\">\\u{412}\\u{44B} \\u{43C}\\u{43E}\\u{436}\\u{435}\\u{442}\\u{435} \\u{441}\\u{43E}\\u{437}\\u{434}\\u{430}\\u{442}\\u{44C} \\u{43F}\\u{435}\\u{440}\\u{432}\\u{44B}\\u{439} \\u{443}\\u{440}\\u{43E}\\u{43A} \\u{432} \\u{440}\\u{430}\\u{437}\\u{434}\\u{435}\\u{43B}\\u{435} \"\\u{423}\\u{440}\\u{43E}\\u{43A}\\u{438}\".</p>\n            </div>\n        `;\n    } else {\n        const moduleName = lessons[0]?.moduleName || \"\\u041C\\u043E\\u0434\\u0443\\u043B\\u044C\";\n        modalTitle.textContent = `\\u{423}\\u{440}\\u{43E}\\u{43A}\\u{438} \\u{43C}\\u{43E}\\u{434}\\u{443}\\u{43B}\\u{44F}: ${moduleName}`;\n        modalBody.innerHTML = `\n            <div class=\"list-group\">\n                ${lessons.map((lesson)=>`\n                    <div class=\"list-group-item list-group-item-action\">\n                        <div class=\"d-flex justify-content-between align-items-center\">\n                            <div class=\"flex-grow-1\">\n                                <h6 class=\"mb-1\">${lesson.title || \"\\u0411\\u0435\\u0437 \\u043D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u044F\"}</h6>\n                                <small class=\"text-muted\">ID: ${lesson.id}</small>\n                            </div>\n                            <div class=\"btn-group ms-3\">\n                                <button class=\"btn btn-outline-info btn-sm\" onclick=\"viewLesson(${lesson.id}, '${lesson.courseSlug}', '${lesson.moduleSlug}')\">\n                                    <i class=\"bi bi-eye\"></i> \\u{41F}\\u{440}\\u{43E}\\u{441}\\u{43C}\\u{43E}\\u{442}\\u{440}\\u{435}\\u{442}\\u{44C}\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                `).join('')}\n            </div>\n            <div class=\"mt-3\">\n                <small class=\"text-muted\">\\u{412}\\u{441}\\u{435}\\u{433}\\u{43E} \\u{443}\\u{440}\\u{43E}\\u{43A}\\u{43E}\\u{432}: ${lessons.length}</small>\n            </div>\n        `;\n    }\n    const modal = new bootstrap.Modal(document.getElementById('lessonsModal'));\n    modal.show();\n}\nfunction $063ae47fa067d23e$var$viewLesson(lessonId, courseSlug, moduleSlug) {\n    if (!courseSlug || !moduleSlug) {\n        showAlert(\"\\u041D\\u0435\\u0434\\u043E\\u0441\\u0442\\u0430\\u0442\\u043E\\u0447\\u043D\\u043E \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445 \\u0434\\u043B\\u044F \\u043F\\u0435\\u0440\\u0435\\u0445\\u043E\\u0434\\u0430 \\u043A \\u0443\\u0440\\u043E\\u043A\\u0443 (\\u043E\\u0442\\u0441\\u0443\\u0442\\u0441\\u0442\\u0432\\u0443\\u0435\\u0442 slug \\u043A\\u0443\\u0440\\u0441\\u0430 \\u0438\\u043B\\u0438 \\u043C\\u043E\\u0434\\u0443\\u043B\\u044F).\", 'error');\n        return;\n    }\n    const url = `/course/${courseSlug}/module/${moduleSlug}/lesson/${lessonId}`;\n    console.log(`Redirecting to: ${url}`);\n    window.location.href = url;\n}\nwindow.loadModuleLessons = $063ae47fa067d23e$var$loadModuleLessons;\nwindow.viewLesson = $063ae47fa067d23e$var$viewLesson;\n\n\nlet $0d2602a1ad8fee7b$var$currentModulesPage = 1;\nlet $0d2602a1ad8fee7b$var$totalModulesPages = 1;\nlet $0d2602a1ad8fee7b$var$totalModulesItems = 0;\nlet $0d2602a1ad8fee7b$var$modulesPerPage = 5;\n// --- NEW: Initialize the entire view (controls and data) ---\nfunction $0d2602a1ad8fee7b$var$initModulesView() {\n    const container = document.getElementById('modulesContainer');\n    if (!container) {\n        console.error('Module container not found!');\n        return;\n    }\n    // 1. Render the static part of the table (header, filters)\n    $0d2602a1ad8fee7b$var$renderModuleControls(container);\n    // 2. Populate the filter with data\n    $0d2602a1ad8fee7b$var$loadCoursesForFilter();\n    // 3. Load the initial set of data\n    $0d2602a1ad8fee7b$var$loadModules(1);\n}\n// --- NEW: Renders the static controls (header, filters) only once ---\nfunction $0d2602a1ad8fee7b$var$renderModuleControls(container) {\n    container.innerHTML = `\n        <div class=\"data-table courses-table modules-table\">\n            <div class=\"table-header d-flex justify-content-between align-items-center flex-wrap\">\n                 <h3 class=\"table-title mb-2 mb-md-0\">\\u{421}\\u{43F}\\u{438}\\u{441}\\u{43E}\\u{43A} \\u{43C}\\u{43E}\\u{434}\\u{443}\\u{43B}\\u{435}\\u{439}</h3>\n                 <div class=\"d-flex align-items-center gap-2 flex-wrap\">\n                    <div class=\"filter-group\">\n                        <select class=\"form-select form-select-sm\" id=\"courseFilterSelect\" onchange=\"loadModules(1)\">\n                            <option value=\"\">\\u{424}\\u{438}\\u{43B}\\u{44C}\\u{442}\\u{440} \\u{43F}\\u{43E} \\u{43A}\\u{443}\\u{440}\\u{441}\\u{443}...</option>\n                        </select>\n                    </div>\n                    <div class=\"page-size-selector\">\n                        <div class=\"input-group input-group-sm\">\n                            <span class=\"input-group-text\">\\u{41E}\\u{442}\\u{43E}\\u{431}\\u{440}\\u{430}\\u{436}\\u{430}\\u{442}\\u{44C}</span>\n                            <select class=\"form-select\" id=\"modulesPageSizeSelect\" onchange=\"changeModulesPerPage(this.value)\">\n                                <option value=\"5\">5</option>\n                                <option value=\"10\">10</option>\n                                <option value=\"20\">20</option>\n                                <option value=\"50\">50</option>\n                            </select>\n                        </div>\n                    </div>\n                     <button class=\"btn btn-primary btn-sm\" onclick=\"openCreateModuleModal()\">\n                        <i class=\"bi bi-plus-circle me-1\"></i>\\u{41D}\\u{43E}\\u{432}\\u{44B}\\u{439} \\u{43C}\\u{43E}\\u{434}\\u{443}\\u{43B}\\u{44C}\n                    </button>\n                </div>\n            </div>\n            <!-- This container will be updated with new rows -->\n            <div class=\"table-content\" id=\"modules-table-content\">\n                <!-- Rows will be injected here -->\n            </div>\n        </div>\n    `;\n    // Set the initial value for the page size selector\n    document.getElementById('modulesPageSizeSelect').value = $0d2602a1ad8fee7b$var$modulesPerPage;\n}\n// --- NEW: Function to load courses for the filter dropdown (runs once) ---\nasync function $0d2602a1ad8fee7b$var$loadCoursesForFilter() {\n    const select = document.getElementById('courseFilterSelect');\n    if (!select) return;\n    try {\n        const response = await fetch('/admin/courses/all');\n        if (!response.ok) {\n            console.error(new Error('Failed to load courses'));\n            return null;\n        }\n        const json = await response.json();\n        if (!json.success || !json.data) {\n            console.error(new Error('Invalid data format for courses'));\n            return null;\n        }\n        json.data.forEach((course)=>{\n            const option = document.createElement('option');\n            option.value = course.id;\n            option.textContent = course.title;\n            select.appendChild(option);\n        });\n    } catch (error) {\n        console.error('Error loading courses for filter:', error);\n        showAlert(\"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0444\\u0438\\u043B\\u044C\\u0442\\u0440 \\u043A\\u0443\\u0440\\u0441\\u043E\\u0432.\", 'warning');\n    }\n}\n// --- MODIFIED: Fetches data and calls a specific function to render only the rows ---\nasync function $0d2602a1ad8fee7b$var$loadModules(page = 1) {\n    const contentContainer = document.getElementById('modules-table-content');\n    if (!contentContainer) {\n        $0d2602a1ad8fee7b$var$initModulesView(); // If the container doesn't exist, initialize the whole view\n        return;\n    }\n    $0d2602a1ad8fee7b$var$showLoadingModules(true);\n    try {\n        const courseId = document.getElementById('courseFilterSelect')?.value || '';\n        let url = `/admin/modules?page=${page}&size=${$0d2602a1ad8fee7b$var$modulesPerPage}`;\n        if (courseId) url += `&courseId=${courseId}`;\n        const response = await fetch(url);\n        const data = await response.json();\n        if (response.ok && data.success && data.data && typeof data.data.content !== 'undefined') {\n            const paginatedModules = data.data;\n            $0d2602a1ad8fee7b$var$currentModulesPage = paginatedModules[\"currentPage\"] || page;\n            $0d2602a1ad8fee7b$var$totalModulesPages = paginatedModules[\"totalPages\"] || 1;\n            $0d2602a1ad8fee7b$var$totalModulesItems = paginatedModules[\"totalItems\"] || 0;\n            $0d2602a1ad8fee7b$var$renderModuleRows(paginatedModules.content);\n            $0d2602a1ad8fee7b$var$renderModulesPagination();\n        } else $0d2602a1ad8fee7b$var$showErrorModules(data.message || \"\\u041F\\u043E\\u043B\\u0443\\u0447\\u0435\\u043D\\u044B \\u043D\\u0435\\u0432\\u0435\\u0440\\u043D\\u044B\\u0435 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435 \\u043E\\u0442 \\u0441\\u0435\\u0440\\u0432\\u0435\\u0440\\u0430.\");\n    } catch (error) {\n        console.error(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0438 \\u043C\\u043E\\u0434\\u0443\\u043B\\u0435\\u0439:\", error);\n        $0d2602a1ad8fee7b$var$showErrorModules(error.message);\n    } finally{\n        $0d2602a1ad8fee7b$var$showLoadingModules(false);\n    }\n}\n// --- NEW: Renders only the module rows into the content container ---\nfunction $0d2602a1ad8fee7b$var$renderModuleRows(modules) {\n    const container = document.getElementById('modules-table-content');\n    if (!container) return;\n    // Clear only the rows\n    container.innerHTML = '';\n    const headerRow = `\n        <div class=\"table-row header-row\">\n            <div class=\"table-cell\">ID</div>\n            <div class=\"table-cell\">\\u{41D}\\u{430}\\u{437}\\u{432}\\u{430}\\u{43D}\\u{438}\\u{435}</div>\n            <div class=\"table-cell\">\\u{41A}\\u{443}\\u{440}\\u{441}</div>\n            <div class=\"table-cell\">\\u{421}\\u{442}\\u{430}\\u{442}\\u{443}\\u{441}</div>\n            <div class=\"table-cell\">\\u{414}\\u{435}\\u{439}\\u{441}\\u{442}\\u{432}\\u{438}\\u{44F}</div>\n        </div>\n    `;\n    container.insertAdjacentHTML('beforeend', headerRow);\n    if (modules.length === 0) {\n        container.insertAdjacentHTML('beforeend', `\n            <div class=\"table-row\">\n                <div class=\"table-cell\" style=\"grid-column: 1 / -1; text-align: center; padding: 2rem; color: #94a3b8;\">\n                    <i class=\"bi bi-collection me-2\"></i>\n                    \\u{41C}\\u{43E}\\u{434}\\u{443}\\u{43B}\\u{438} \\u{43D}\\u{435} \\u{43D}\\u{430}\\u{439}\\u{434}\\u{435}\\u{43D}\\u{44B}. \\u{418}\\u{437}\\u{43C}\\u{435}\\u{43D}\\u{438}\\u{442}\\u{435} \\u{444}\\u{438}\\u{43B}\\u{44C}\\u{442}\\u{440} \\u{438}\\u{43B}\\u{438} \\u{434}\\u{43E}\\u{431}\\u{430}\\u{432}\\u{44C}\\u{442}\\u{435} \\u{43D}\\u{43E}\\u{432}\\u{44B}\\u{439} \\u{43C}\\u{43E}\\u{434}\\u{443}\\u{43B}\\u{44C}.\n                </div>\n            </div>\n        `);\n        return;\n    }\n    modules.forEach((module)=>{\n        const rowHTML = `\n            <div class=\"table-row\">\n                <div class=\"table-cell text-muted\">#${module.moduleId || 'N/A'}</div>\n                <div class=\"table-cell\">\n                    <div class=\"fw-bold\">${$0d2602a1ad8fee7b$var$escapeHtml(module[\"moduleTitle\"] || \"\\u0411\\u0435\\u0437 \\u043D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u044F\")}</div>\n                </div>\n                <div class=\"table-cell\">\n                    <span class=\"text-muted\">${$0d2602a1ad8fee7b$var$escapeHtml(module[\"courseName\"] || 'N/A')}</span>\n                </div>\n                <div class=\"table-cell\">\n                    <span class=\"badge ${module[\"moduleStatus\"] === 'ACTIVE' ? 'bg-success' : 'bg-secondary'}\" style=\"cursor: pointer\" onclick=\"adminUpdateModuleStatus(${module.moduleId}, '${module[\"moduleStatus\"]}')\">\n                        ${$0d2602a1ad8fee7b$var$escapeHtml($0d2602a1ad8fee7b$var$adaptiveModuleStatus(module[\"moduleStatus\"]))}\n                    </span>\n                </div>\n                <div class=\"table-cell action-buttons\">\n                    <button class=\"btn btn-primary btn-icon btn-sm edit-module-btn\" title=\"\\u{420}\\u{435}\\u{434}\\u{430}\\u{43A}\\u{442}\\u{438}\\u{440}\\u{43E}\\u{432}\\u{430}\\u{442}\\u{44C}\" data-module-id=\"${module.moduleId}\">\n                        <i class=\"bi bi-pencil\"></i>\n                    </button>\n                    <button class=\"btn btn-danger btn-icon btn-sm\" title=\"\\u{423}\\u{434}\\u{430}\\u{43B}\\u{438}\\u{442}\\u{44C}\" onclick=\"deleteModule(${module.moduleId}, '${$0d2602a1ad8fee7b$var$escapeHtml(module[\"moduleTitle\"])}')\">\n                        <i class=\"bi bi-trash\"></i>\n                    </button>\n                    <button class=\"btn btn-info btn-icon btn-sm\" title=\"\\u{423}\\u{440}\\u{43E}\\u{43A}\\u{438} \\u{43C}\\u{43E}\\u{434}\\u{443}\\u{43B}\\u{44F}\" onclick=\"loadModuleLessons(${module.moduleId})\">\n                        <i class=\"bi bi-card-checklist\"></i>\n                    </button>\n                </div>\n            </div>\n        `;\n        container.insertAdjacentHTML('beforeend', rowHTML);\n    });\n}\n// --- UNCHANGED (mostly) ---\nfunction $0d2602a1ad8fee7b$var$renderModulesPagination() {\n    let container = document.getElementById('modulesPagination');\n    if (!container) {\n        // If the main container exists but pagination doesn't, create it.\n        const mainContainer = document.getElementById('modulesContainer');\n        if (mainContainer) {\n            const paginationDiv = document.createElement('div');\n            paginationDiv.className = 'pagination-container mt-3';\n            paginationDiv.id = 'modulesPagination';\n            mainContainer.appendChild(paginationDiv);\n            container = paginationDiv;\n        } else return;\n    }\n    if ($0d2602a1ad8fee7b$var$totalModulesPages <= 1) {\n        container.innerHTML = '';\n        return;\n    }\n    let paginationHTML = `\n        <nav aria-label=\"Page navigation\">\n            <ul class=\"pagination justify-content-center\">\n                <li class=\"page-item ${$0d2602a1ad8fee7b$var$currentModulesPage === 1 ? 'disabled' : ''}\">\n                    <a class=\"page-link\" href=\"#\" onclick=\"changeModulesPage(${$0d2602a1ad8fee7b$var$currentModulesPage - 1}); return false;\">&laquo;</a>\n                </li>\n    `;\n    const maxVisiblePages = 5;\n    let startPage = Math.max(1, $0d2602a1ad8fee7b$var$currentModulesPage - Math.floor(maxVisiblePages / 2));\n    let endPage = Math.min($0d2602a1ad8fee7b$var$totalModulesPages, startPage + maxVisiblePages - 1);\n    if (endPage - startPage + 1 < maxVisiblePages) startPage = Math.max(1, endPage - maxVisiblePages + 1);\n    if (startPage > 1) {\n        paginationHTML += `<li class=\"page-item\"><a class=\"page-link\" href=\"#\" onclick=\"changeModulesPage(1); return false;\">1</a></li>`;\n        if (startPage > 2) paginationHTML += `<li class=\"page-item disabled\"><span class=\"page-link\">...</span></li>`;\n    }\n    for(let i = startPage; i <= endPage; i++)paginationHTML += `<li class=\"page-item ${i === $0d2602a1ad8fee7b$var$currentModulesPage ? 'active' : ''}\"><a class=\"page-link\" href=\"#\" onclick=\"changeModulesPage(${i}); return false;\">${i}</a></li>`;\n    if (endPage < $0d2602a1ad8fee7b$var$totalModulesPages) {\n        if (endPage < $0d2602a1ad8fee7b$var$totalModulesPages - 1) paginationHTML += `<li class=\"page-item disabled\"><span class=\"page-link\">...</span></li>`;\n        paginationHTML += `<li class=\"page-item\"><a class=\"page-link\" href=\"#\" onclick=\"changeModulesPage(${$0d2602a1ad8fee7b$var$totalModulesPages}); return false;\">${$0d2602a1ad8fee7b$var$totalModulesPages}</a></li>`;\n    }\n    paginationHTML += `\n                <li class=\"page-item ${$0d2602a1ad8fee7b$var$currentModulesPage === $0d2602a1ad8fee7b$var$totalModulesPages ? 'disabled' : ''}\">\n                    <a class=\"page-link\" href=\"#\" onclick=\"changeModulesPage(${$0d2602a1ad8fee7b$var$currentModulesPage + 1}); return false;\">&raquo;</a>\n                </li>\n            </ul>\n        </nav>\n        <div class=\"pagination-info text-center mt-2\">\n            <small class=\"text-muted\">\n                \\u{421}\\u{442}\\u{440}\\u{430}\\u{43D}\\u{438}\\u{446}\\u{430} ${$0d2602a1ad8fee7b$var$currentModulesPage} \\u{438}\\u{437} ${$0d2602a1ad8fee7b$var$totalModulesPages} \\u{2022} \\u{412}\\u{441}\\u{435}\\u{433}\\u{43E} \\u{43C}\\u{43E}\\u{434}\\u{443}\\u{43B}\\u{435}\\u{439}: ${$0d2602a1ad8fee7b$var$totalModulesItems}\n            </small>\n        </div>\n    `;\n    container.innerHTML = paginationHTML;\n}\nfunction $0d2602a1ad8fee7b$var$changeModulesPage(page) {\n    if (page < 1 || page > $0d2602a1ad8fee7b$var$totalModulesPages || page === $0d2602a1ad8fee7b$var$currentModulesPage) return;\n    $0d2602a1ad8fee7b$var$loadModules(page);\n}\nfunction $0d2602a1ad8fee7b$var$changeModulesPerPage(perPage) {\n    $0d2602a1ad8fee7b$var$modulesPerPage = parseInt(perPage) || 10;\n    $0d2602a1ad8fee7b$var$loadModules(1);\n}\nfunction $0d2602a1ad8fee7b$var$showLoadingModules(isLoading) {\n    const container = document.getElementById('modules-table-content');\n    if (!container) return;\n    if (isLoading) container.innerHTML = `\n            <div class=\"d-flex justify-content-center align-items-center\" style=\"height: 200px;\">\n                <div class=\"spinner-border text-primary\" role=\"status\">\n                    <span class=\"visually-hidden\">\\u{417}\\u{430}\\u{433}\\u{440}\\u{443}\\u{437}\\u{43A}\\u{430}...</span>\n                </div>\n            </div>\n        `;\n}\nfunction $0d2602a1ad8fee7b$var$showErrorModules(message) {\n    const container = document.getElementById('modulesContainer');\n    if (!container) return;\n    container.innerHTML = `\n        <div class=\"text-center py-4 text-danger\">\n            <i class=\"bi bi-exclamation-triangle-fill fa-2x mb-3\"></i>\n            <h5>\\u{41E}\\u{448}\\u{438}\\u{431}\\u{43A}\\u{430} \\u{437}\\u{430}\\u{433}\\u{440}\\u{443}\\u{437}\\u{43A}\\u{438}</h5>\n            <p>${$0d2602a1ad8fee7b$var$escapeHtml(message)}</p>\n            <button class=\"btn btn-primary btn-sm\" onclick=\"initModulesView()\">\n                <i class=\"bi bi-arrow-clockwise me-1\"></i> \\u{41F}\\u{43E}\\u{43F}\\u{440}\\u{43E}\\u{431}\\u{43E}\\u{432}\\u{430}\\u{442}\\u{44C} \\u{441}\\u{43D}\\u{43E}\\u{432}\\u{430}\n            </button>\n        </div>\n    `;\n}\nfunction $0d2602a1ad8fee7b$var$adaptiveModuleStatus(status) {\n    return status === 'ACTIVE' ? \"\\u0410\\u043A\\u0442\\u0438\\u0432\\u043D\\u044B\\u0439\" : \"\\u041D\\u0435\\u0430\\u043A\\u0442\\u0438\\u0432\\u043D\\u044B\\u0439\";\n}\nfunction $0d2602a1ad8fee7b$var$escapeHtml(text) {\n    if (typeof text !== 'string') return '';\n    const div = document.createElement('div');\n    div.textContent = text;\n    return div.innerHTML;\n}\nfunction $0d2602a1ad8fee7b$var$openCreateModuleModal() {\n    const tabLink = document.querySelector('a[data-tab=\"create-module-tab\"]');\n    if (tabLink) tabLink.click();\n}\n// --- MODIFIED: Initialization logic ---\ndocument.addEventListener('DOMContentLoaded', function() {\n    const modulesTabTrigger = document.querySelector('a[data-tab=\"modules-edit-tab\"]');\n    if (modulesTabTrigger) {\n        let isInitialized = false;\n        const observer = new MutationObserver(()=>{\n            if (document.getElementById('modules-edit-tab').classList.contains('active') && !isInitialized) {\n                $0d2602a1ad8fee7b$var$initModulesView();\n                isInitialized = true;\n            }\n        });\n        modulesTabTrigger.addEventListener('click', ()=>{\n            if (!isInitialized) {\n                $0d2602a1ad8fee7b$var$initModulesView();\n                isInitialized = true;\n            }\n        });\n        if (document.getElementById('modules-edit-tab').classList.contains('active')) {\n            $0d2602a1ad8fee7b$var$initModulesView();\n            isInitialized = true;\n        }\n    }\n});\nwindow.changeModulesPerPage = $0d2602a1ad8fee7b$var$changeModulesPerPage;\nwindow.openCreateModuleModal = $0d2602a1ad8fee7b$var$openCreateModuleModal;\nwindow.changeModulesPage = $0d2602a1ad8fee7b$var$changeModulesPage;\nwindow.initModulesView = $0d2602a1ad8fee7b$var$initModulesView;\nwindow.loadModules = $0d2602a1ad8fee7b$var$loadModules;\n\n\n// This file is deprecated. The deleteOffer function is now in getOffers.js\n\n\n// State variables for pagination and filtering\nlet $e673dd2d4573991e$var$currentOfferPage = 1;\nlet $e673dd2d4573991e$var$totalOfferPages = 1;\nlet $e673dd2d4573991e$var$totalOfferItems = 0;\nlet $e673dd2d4573991e$var$sortStatus = \"all\";\nlet $e673dd2d4573991e$var$offersPerPage = 10; // Default value\n/**\n * Fetches and renders offers for a given page and filters.\n * @param {number} page - The page number to load.\n */ async function $e673dd2d4573991e$var$loadOffers(page = 1) {\n    try {\n        const response = await fetch(`/admin/offers?page=${page}&size=${$e673dd2d4573991e$var$offersPerPage}&status=${$e673dd2d4573991e$var$sortStatus}`);\n        if (!response.ok) {\n            console.error(new Error(`\\u{41E}\\u{448}\\u{438}\\u{431}\\u{43A}\\u{430} \\u{441}\\u{435}\\u{440}\\u{432}\\u{435}\\u{440}\\u{430}: ${response.status}`));\n            showAlert(`\\u{41E}\\u{448}\\u{438}\\u{431}\\u{43A}\\u{430} \\u{441}\\u{435}\\u{440}\\u{432}\\u{435}\\u{440}\\u{430}: ${response.status}`, 'error');\n        }\n        const data = await response.json();\n        if (data.success && data[\"offers\"]) {\n            $e673dd2d4573991e$var$currentOfferPage = data[\"currentPage\"] || page;\n            $e673dd2d4573991e$var$totalOfferPages = data[\"totalPages\"] || 1;\n            $e673dd2d4573991e$var$totalOfferItems = data[\"totalItems\"] || data[\"offers\"].length;\n            $e673dd2d4573991e$var$renderOffersTable(data[\"offers\"]);\n            $e673dd2d4573991e$var$renderOfferPagePagination();\n        } else {\n            console.error(new Error(\"\\u041D\\u0435\\u0432\\u0435\\u0440\\u043D\\u044B\\u0439 \\u0444\\u043E\\u0440\\u043C\\u0430\\u0442 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445 \\u043E\\u0442 AdminOfferController\"));\n            showAlert(\"\\u041D\\u0435\\u0432\\u0435\\u0440\\u043D\\u044B\\u0439 \\u0444\\u043E\\u0440\\u043C\\u0430\\u0442 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445 \\u043E\\u0442 AdminOfferController\", 'error');\n        }\n    } catch (e) {\n        console.error(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u043F\\u0440\\u0438 \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0435 \\u0437\\u0430\\u044F\\u0432\\u043E\\u043A:\", e);\n        const offerTableContainer = document.querySelector('#requests-tab .card-body');\n        if (offerTableContainer) offerTableContainer.innerHTML = `<div class=\"text-center py-4 text-danger\">\\u{41D}\\u{435} \\u{443}\\u{434}\\u{430}\\u{43B}\\u{43E}\\u{441}\\u{44C} \\u{437}\\u{430}\\u{433}\\u{440}\\u{443}\\u{437}\\u{438}\\u{442}\\u{44C} \\u{437}\\u{430}\\u{44F}\\u{432}\\u{43A}\\u{438}.</div>`;\n    }\n}\n/**\n * Deletes an offer after user confirmation.\n * @param {string|number} offerId - The ID of the offer to delete.\n */ async function $e673dd2d4573991e$var$deleteOffer(offerId) {\n    // Use a more robust confirmation if a custom modal library is available\n    if (!confirm(\"\\u0412\\u044B \\u0443\\u0432\\u0435\\u0440\\u0435\\u043D\\u044B, \\u0447\\u0442\\u043E \\u0445\\u043E\\u0442\\u0438\\u0442\\u0435 \\u0443\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u044D\\u0442\\u0443 \\u0437\\u0430\\u044F\\u0432\\u043A\\u0443?\")) return;\n    try {\n        const csrfToken = typeof getCsrfToken === 'function' ? getCsrfToken() : document.querySelector('meta[name=\"_csrf\"]')?.getAttribute('content') || '';\n        const response = await fetch(`/admin/offers/delete/${offerId}`, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'X-CSRF-TOKEN': csrfToken\n            }\n        });\n        const result = await response.json();\n        if (response.ok && result.success) {\n            // Use a more robust alert if a custom one is available\n            showAlert(\"\\u0417\\u0430\\u044F\\u0432\\u043A\\u0430 \\u0443\\u0441\\u043F\\u0435\\u0448\\u043D\\u043E \\u0443\\u0434\\u0430\\u043B\\u0435\\u043D\\u0430!\", 'success');\n            $e673dd2d4573991e$var$loadOffers($e673dd2d4573991e$var$currentOfferPage); // Refresh the list\n        } else showAlert(result.error || \"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u043F\\u0440\\u0438 \\u0443\\u0434\\u0430\\u043B\\u0435\\u043D\\u0438\\u0438 \\u0437\\u0430\\u044F\\u0432\\u043A\\u0438\", 'error');\n    } catch (error) {\n        console.error(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0443\\u0434\\u0430\\u043B\\u0435\\u043D\\u0438\\u044F \\u0437\\u0430\\u044F\\u0432\\u043A\\u0438:\", error);\n        showAlert(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0441\\u0435\\u0440\\u0432\\u0435\\u0440\\u0430\", 'error');\n    }\n}\n/**\n * Renders the main table of offers.\n * @param {Array<object>} offers - The array of offer objects to render.\n */ function $e673dd2d4573991e$var$renderOffersTable(offers) {\n    const offerTableContainer = document.querySelector('#requests-tab .card-body');\n    if (!offerTableContainer) {\n        console.error(\"\\u041A\\u043E\\u043D\\u0442\\u0435\\u0439\\u043D\\u0435\\u0440 \\u0434\\u043B\\u044F \\u0442\\u0430\\u0431\\u043B\\u0438\\u0446\\u044B \\u0437\\u0430\\u044F\\u0432\\u043E\\u043A \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\");\n        return;\n    }\n    offerTableContainer.innerHTML = `\n    <div class=\"offers-table-container\">\n        <div class=\"data-table offers-table\">\n            <div class=\"table-header d-flex justify-content-between align-items-center\">\n                <h3 class=\"table-title\">\\u{421}\\u{43F}\\u{438}\\u{441}\\u{43E}\\u{43A} \\u{437}\\u{430}\\u{44F}\\u{432}\\u{43E}\\u{43A}</h3>\n                <div class=\"table-header-actions d-flex align-items-center\" style=\"gap: 1rem;\">\n                    <div class=\"input-group\">\n                        <span class=\"input-group-text\"><i class=\"bi bi-funnel\"></i></span>\n                        <select class=\"form-select form-select-sm\" id=\"statusFilter\">\n                            <option value=\"all\" ${$e673dd2d4573991e$var$sortStatus === 'all' ? 'selected' : ''}>\\u{412}\\u{441}\\u{435} \\u{441}\\u{442}\\u{430}\\u{442}\\u{443}\\u{441}\\u{44B}</option>\n                            <option value=\"PENDING\" ${$e673dd2d4573991e$var$sortStatus === 'PENDING' ? 'selected' : ''}>\\u{41D}\\u{430} \\u{440}\\u{430}\\u{441}\\u{441}\\u{43C}\\u{43E}\\u{442}\\u{440}\\u{435}\\u{43D}\\u{438}\\u{438}</option>\n                            <option value=\"APPROVED\" ${$e673dd2d4573991e$var$sortStatus === 'APPROVED' ? 'selected' : ''}>\\u{41E}\\u{434}\\u{43E}\\u{431}\\u{440}\\u{435}\\u{43D}\\u{44B}\\u{435}</option>\n                            <option value=\"COMPLETED\" ${$e673dd2d4573991e$var$sortStatus === 'COMPLETED' ? 'selected' : ''}>\\u{412}\\u{44B}\\u{43F}\\u{43E}\\u{43B}\\u{43D}\\u{435}\\u{43D}\\u{44B}\\u{435}</option>\n                            <option value=\"REJECTED\" ${$e673dd2d4573991e$var$sortStatus === 'REJECTED' ? 'selected' : ''}>\\u{41E}\\u{442}\\u{43A}\\u{43B}\\u{43E}\\u{43D}\\u{435}\\u{43D}\\u{43D}\\u{44B}\\u{435}</option>\n                        </select>\n                    </div>\n                    <div class=\"input-group\">\n                        <span class=\"input-group-text\">\\u{41F}\\u{43E}\\u{43A}\\u{430}\\u{437}\\u{44B}\\u{432}\\u{430}\\u{442}\\u{44C}</span>\n                        <select class=\"form-select form-select-sm\" id=\"pageSizeSelect\">\n                            <option value=\"5\" ${$e673dd2d4573991e$var$offersPerPage === 5 ? 'selected' : ''}>5</option>\n                            <option value=\"10\" ${$e673dd2d4573991e$var$offersPerPage === 10 ? 'selected' : ''}>10</option>\n                            <option value=\"20\" ${$e673dd2d4573991e$var$offersPerPage === 20 ? 'selected' : ''}>20</option>\n                            <option value=\"50\" ${$e673dd2d4573991e$var$offersPerPage === 50 ? 'selected' : ''}>50</option>\n                        </select>\n                    </div>\n                </div>\n            </div>\n\n            <div class=\"table-content\" id=\"offersTableContent\">\n                <!-- Table Header -->\n                <div class=\"table-row header-row\">\n                    <div class=\"table-cell\">ID</div>\n                    <div class=\"table-cell\">\\u{41F}\\u{43E}\\u{43B}\\u{44C}\\u{437}\\u{43E}\\u{432}\\u{430}\\u{442}\\u{435}\\u{43B}\\u{44C}</div>\n                    <div class=\"table-cell\">\\u{422}\\u{435}\\u{43C}\\u{430}</div>\n                    <div class=\"table-cell\">\\u{41E}\\u{43F}\\u{438}\\u{441}\\u{430}\\u{43D}\\u{438}\\u{435}</div>\n                    <div class=\"table-cell\">\\u{41E}\\u{442}\\u{432}\\u{435}\\u{442}</div>\n                    <div class=\"table-cell\">\\u{421}\\u{442}\\u{430}\\u{442}\\u{443}\\u{441}</div>\n                    <div class=\"table-cell\">\\u{421}\\u{43E}\\u{437}\\u{434}\\u{430}\\u{43D}\\u{430}</div>\n                    <div class=\"table-cell\">\\u{41E}\\u{431}\\u{43D}\\u{43E}\\u{432}\\u{43B}\\u{435}\\u{43D}\\u{430}</div>\n                    <div class=\"table-cell\">\\u{414}\\u{435}\\u{439}\\u{441}\\u{442}\\u{432}\\u{438}\\u{44F}</div>\n                </div>\n\n                <!-- Offer Rows -->\n                ${offers.length > 0 ? offers.map((offer)=>`\n                <div class=\"table-row\">\n                    <div class=\"table-cell text-muted\">#${offer.id || 'N/A'}</div>\n                    <div class=\"table-cell\">\n                        <div class=\"fw-bold\">${offer[\"fio\"] || 'N/A'}</div>\n                    </div>\n                    <div class=\"table-cell\">\n                        <div class=\"fw-bold\">${offer.topic || 'N/A'}</div>\n                    </div>\n                    <div class=\"table-cell\">\n                        <span class=\"course-description\">${offer.description || 'N/A'}</span>\n                    </div>\n                    <div class=\"table-cell\">\n                        <span class=\"course-description\">${offer.response || \"\\u041D\\u0435\\u0442 \\u043E\\u0442\\u0432\\u0435\\u0442\\u0430\"}</span>\n                    </div>\n                    <div class=\"table-cell\">${$e673dd2d4573991e$var$convertStatusIntoBadge(offer.status)}</div>\n                    <div class=\"table-cell text-sm text-muted\">${$e673dd2d4573991e$var$extractDate(offer[\"createdAt\"])}</div>\n                    <div class=\"table-cell text-sm text-muted\">${$e673dd2d4573991e$var$extractDate(offer[\"updatedAt\"])}</div>\n                    <div class=\"table-cell action-buttons justify-content-center\">\n                        ${createOfferResponseButton(offer)}\n                        <button class=\"btn btn-danger btn-icon btn-sm\" title=\"\\u{423}\\u{434}\\u{430}\\u{43B}\\u{438}\\u{442}\\u{44C}\" data-action=\"delete-offer\" data-offer-id=\"${offer.id}\">\n                            <i class=\"bi bi-trash\"></i>\n                        </button>\n                    </div>\n                </div>\n                `).join('') : `\n                <div class=\"table-row\" style=\"grid-template-columns: 1fr;\">\n                    <div class=\"text-center py-4 text-muted\">\n                        <i class=\"bi bi-inbox fs-3 d-block mb-2\"></i>\n                        \\u{417}\\u{430}\\u{44F}\\u{432}\\u{43A}\\u{438} \\u{43D}\\u{435} \\u{43D}\\u{430}\\u{439}\\u{434}\\u{435}\\u{43D}\\u{44B}\n                    </div>\n                </div>\n                `}\n            </div>\n        </div>\n    </div>`;\n    $e673dd2d4573991e$var$bindOfferTableEvents(); // Bind events after rendering\n}\n/**\n * Renders the pagination controls for the offers table.\n */ function $e673dd2d4573991e$var$renderOfferPagePagination() {\n    let offerPaginationContainer = document.querySelector('.pagination-container-edit-offers');\n    if (!offerPaginationContainer) {\n        const mainContainer = document.querySelector('#requests-tab .card-body');\n        if (mainContainer) {\n            const paginationDiv = document.createElement('div');\n            paginationDiv.className = 'pagination-container-edit-offers mt-3';\n            mainContainer.appendChild(paginationDiv);\n            offerPaginationContainer = paginationDiv;\n        } else {\n            console.error(\"\\u041E\\u0441\\u043D\\u043E\\u0432\\u043D\\u043E\\u0439 \\u043A\\u043E\\u043D\\u0442\\u0435\\u0439\\u043D\\u0435\\u0440 \\u0434\\u043B\\u044F \\u0442\\u0430\\u0431\\u043B\\u0438\\u0446\\u044B \\u0437\\u0430\\u044F\\u0432\\u043E\\u043A \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D, \\u043F\\u0430\\u0433\\u0438\\u043D\\u0430\\u0446\\u0438\\u044F \\u043D\\u0435 \\u0431\\u0443\\u0434\\u0435\\u0442 \\u043E\\u0442\\u043E\\u0431\\u0440\\u0430\\u0436\\u0435\\u043D\\u0430.\");\n            return;\n        }\n    }\n    if ($e673dd2d4573991e$var$totalOfferPages <= 1) {\n        offerPaginationContainer.innerHTML = '';\n        return;\n    }\n    let offerPaginationHTML = `\n        <nav aria-label=\"Page navigation\">\n            <ul class=\"pagination justify-content-center\">\n                <!-- Previous Button -->\n                <li class=\"page-item ${$e673dd2d4573991e$var$currentOfferPage === 1 ? 'disabled' : ''}\">\n                    <a class=\"page-link\" href=\"#\" data-action=\"change-page\" data-page-number=\"${$e673dd2d4573991e$var$currentOfferPage - 1}\" aria-label=\"Previous\">\n                        <span aria-hidden=\"true\">&laquo;</span>\n                    </a>\n                </li>`;\n    const maxVisiblePages = 5;\n    let offerStartPage = Math.max(1, $e673dd2d4573991e$var$currentOfferPage - Math.floor(maxVisiblePages / 2));\n    let offerEndPage = Math.min($e673dd2d4573991e$var$totalOfferPages, offerStartPage + maxVisiblePages - 1);\n    if (offerEndPage - offerStartPage + 1 < maxVisiblePages) offerStartPage = Math.max(1, offerEndPage - maxVisiblePages + 1);\n    if (offerStartPage > 1) {\n        offerPaginationHTML += `<li class=\"page-item\"><a class=\"page-link\" href=\"#\" data-action=\"change-page\" data-page-number=\"1\">1</a></li>`;\n        if (offerStartPage > 2) offerPaginationHTML += `<li class=\"page-item disabled\"><span class=\"page-link\">...</span></li>`;\n    }\n    for(let i = offerStartPage; i <= offerEndPage; i++)offerPaginationHTML += `\n            <li class=\"page-item ${i === $e673dd2d4573991e$var$currentOfferPage ? 'active' : ''}\">\n                <a class=\"page-link\" href=\"#\" data-action=\"change-page\" data-page-number=\"${i}\">${i}</a>\n            </li>`;\n    if (offerEndPage < $e673dd2d4573991e$var$totalOfferPages) {\n        if (offerEndPage < $e673dd2d4573991e$var$totalOfferPages - 1) offerPaginationHTML += `<li class=\"page-item disabled\"><span class=\"page-link\">...</span></li>`;\n        offerPaginationHTML += `<li class=\"page-item\"><a class=\"page-link\" href=\"#\" data-action=\"change-page\" data-page-number=\"${$e673dd2d4573991e$var$totalOfferPages}\">${$e673dd2d4573991e$var$totalOfferPages}</a></li>`;\n    }\n    offerPaginationHTML += `\n                <!-- Next Button -->\n                <li class=\"page-item ${$e673dd2d4573991e$var$currentOfferPage === $e673dd2d4573991e$var$totalOfferPages ? 'disabled' : ''}\">\n                    <a class=\"page-link\" href=\"#\" data-action=\"change-page\" data-page-number=\"${$e673dd2d4573991e$var$currentOfferPage + 1}\" aria-label=\"Next\">\n                        <span aria-hidden=\"true\">&raquo;</span>\n                    </a>\n                </li>\n            </ul>\n        </nav>\n        <div class=\"pagination-info text-center mt-2\">\n            <small class=\"text-muted\">\\u{421}\\u{442}\\u{440}\\u{430}\\u{43D}\\u{438}\\u{446}\\u{430} ${$e673dd2d4573991e$var$currentOfferPage} \\u{438}\\u{437} ${$e673dd2d4573991e$var$totalOfferPages} \\u{2022} \\u{412}\\u{441}\\u{435}\\u{433}\\u{43E} \\u{437}\\u{430}\\u{44F}\\u{432}\\u{43E}\\u{43A}: ${$e673dd2d4573991e$var$totalOfferItems}</small>\n        </div>`;\n    offerPaginationContainer.innerHTML = offerPaginationHTML;\n    $e673dd2d4573991e$var$bindOfferPaginationEvents(); // Bind events after rendering\n}\n/**\n * Binds event listeners for the offers table (filters, actions).\n */ function $e673dd2d4573991e$var$bindOfferTableEvents() {\n    const statusFilter = document.getElementById('statusFilter');\n    if (statusFilter) statusFilter.addEventListener('change', (event)=>{\n        $e673dd2d4573991e$var$sortStatus = event.target.value;\n        $e673dd2d4573991e$var$loadOffers(1); // Reset to first page\n    });\n    const pageSizeSelect = document.getElementById('pageSizeSelect');\n    if (pageSizeSelect) pageSizeSelect.addEventListener('change', (event)=>{\n        $e673dd2d4573991e$var$offersPerPage = parseInt(event.target.value, 10);\n        $e673dd2d4573991e$var$loadOffers(1); // Reset to first page\n    });\n    const tableContent = document.getElementById('offersTableContent');\n    if (tableContent) tableContent.addEventListener('click', (event)=>{\n        const target = event.target.closest('button[data-action=\"delete-offer\"]');\n        if (target) {\n            const offerId = target.dataset.offerId;\n            $e673dd2d4573991e$var$deleteOffer(offerId);\n        }\n    });\n}\n/**\n * Binds event listeners for the pagination controls.\n */ function $e673dd2d4573991e$var$bindOfferPaginationEvents() {\n    const offerPaginationContainer = document.querySelector('.pagination-container-edit-offers');\n    if (offerPaginationContainer) offerPaginationContainer.addEventListener('click', (event)=>{\n        event.preventDefault();\n        const target = event.target.closest('a[data-action=\"change-page\"]');\n        if (target) {\n            const pageNumber = parseInt(target.dataset.pageNumber, 10);\n            if (!isNaN(pageNumber)) $e673dd2d4573991e$var$changeOfferPage(pageNumber);\n        }\n    });\n}\n/**\n * Changes the current page of offers.\n * @param {number} page - The page number to switch to.\n */ function $e673dd2d4573991e$var$changeOfferPage(page) {\n    if (page < 1 || page > $e673dd2d4573991e$var$totalOfferPages || page === $e673dd2d4573991e$var$currentOfferPage) return;\n    $e673dd2d4573991e$var$loadOffers(page);\n}\n/**\n * Formats a date string into YYYY-MM-DD.\n * @param {string} dateString - The input date string.\n * @returns {string} The formatted date.\n */ function $e673dd2d4573991e$var$extractDate(dateString) {\n    if (!dateString) return 'N/A';\n    try {\n        return new Date(dateString).toISOString().split('T')[0];\n    } catch (e) {\n        return dateString; // Return original if parsing fails\n    }\n}\n/**\n * Converts an offer status string into a colored Bootstrap badge.\n * @param {string} status - The status string (e.g., 'PENDING').\n * @returns {string} The HTML for the badge.\n */ function $e673dd2d4573991e$var$convertStatusIntoBadge(status) {\n    switch(status){\n        case 'PENDING':\n            return '<span class=\"status-badge status-pending\">\\u041D\\u0435 \\u0440\\u0430\\u0441\\u0441\\u043C\\u043E\\u0442\\u0440\\u0435\\u043D\\u0430</span>';\n        case 'REJECTED':\n            return '<span class=\"status-badge status-rejected\">\\u041E\\u0442\\u043A\\u043B\\u043E\\u043D\\u0435\\u043D\\u0430</span>';\n        case 'APPROVED':\n            return '<span class=\"status-badge status-review\">\\u041E\\u0434\\u043E\\u0431\\u0440\\u0435\\u043D\\u0430</span>';\n        case 'COMPLETED':\n            return '<span class=\"status-badge status-completed\">\\u0412\\u044B\\u043F\\u043E\\u043B\\u043D\\u0435\\u043D\\u0430</span>';\n        default:\n            return `<span class=\"status-badge\">${status || 'N/A'}</span>`;\n    }\n}\n// Initial load when the DOM is ready and the tab is visible.\ndocument.addEventListener('DOMContentLoaded', function() {\n    // This assumes the tab is visible on load. A more robust solution might\n    // use a MutationObserver or a custom event when the tab is shown.\n    const offersTab = document.getElementById('requests-tab');\n    if (offersTab) $e673dd2d4573991e$var$loadOffers(1);\n});\n// Expose functions to the global scope if they are called from other scripts\n// or legacy inline handlers we might have missed.\nwindow.loadOffers = $e673dd2d4573991e$var$loadOffers;\n\n\n// offerModal.js - Merged functionality for handling offer responses.\nlet $c073e20d34594191$var$currentOffer = null;\n// --- INITIALIZATION ---\n// Initialize event listeners when the DOM is fully loaded.\ndocument.addEventListener('DOMContentLoaded', $c073e20d34594191$var$initOfferModal);\n/**\n * Initializes all event listeners for the offer response modal.\n */ function $c073e20d34594191$var$initOfferModal() {\n    const modalElement = document.getElementById('offerResponseModal');\n    // The form ID is 'adminUpdateForm' from admin.ftlh.\n    const responseForm = document.getElementById('adminUpdateForm');\n    if (modalElement) {\n        // Use event delegation for all buttons that open the response modal.\n        document.body.addEventListener('click', $c073e20d34594191$var$handleOpenModalClick);\n        // Clear the form when the modal is closed.\n        modalElement.addEventListener('hidden.bs.modal', $c073e20d34594191$var$clearModalForm);\n    }\n    if (responseForm) // Handle the form submission.\n    responseForm.addEventListener('submit', $c073e20d34594191$var$handleSubmitResponse);\n}\n// --- EVENT HANDLERS ---\n/**\n * Handles clicks on the body to open the modal if the target is a response button.\n * @param {Event} event - The click event.\n */ function $c073e20d34594191$var$handleOpenModalClick(event) {\n    const button = event.target.closest('.js-open-response-modal');\n    if (button) {\n        const offerData = {\n            id: button.dataset.id,\n            description: button.dataset.description,\n            response: button.dataset.response,\n            status: button.dataset.status\n        };\n        $c073e20d34594191$var$openOfferResponseModal(offerData);\n    }\n}\n/**\n * Handles the submission of the offer response form.\n * @param {Event} event - The submit event.\n */ async function $c073e20d34594191$var$handleSubmitResponse(event) {\n    event.preventDefault();\n    const form = event.target;\n    const offerId = form.querySelector('#offerId').value;\n    const status = form.querySelector('#responseStatus').value;\n    const responseText = form.querySelector('#responseText').value;\n    const updateData = {\n        offerId: offerId,\n        status: status,\n        response: responseText.trim()\n    };\n    const submitBtn = form.querySelector('button[type=\"submit\"]');\n    const originalText = submitBtn.innerHTML;\n    try {\n        submitBtn.disabled = true;\n        submitBtn.innerHTML = '<span class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span> \\u041E\\u0431\\u043D\\u043E\\u0432\\u043B\\u0435\\u043D\\u0438\\u0435...';\n        const response = await fetch('/admin/updateOffer', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'X-CSRF-TOKEN': $c073e20d34594191$var$getCsrfToken()\n            },\n            body: JSON.stringify(updateData)\n        });\n        const result = await response.json();\n        if (!response.ok) {\n            const errorMessage = result.errors ? \"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0438 \\u0432\\u0430\\u043B\\u0438\\u0434\\u0430\\u0446\\u0438\\u0438:\\n\" + Object.values(result.errors).join('\\n') : `\\u{41E}\\u{448}\\u{438}\\u{431}\\u{43A}\\u{430}: ${result.message || \"\\u041D\\u0435\\u0438\\u0437\\u0432\\u0435\\u0441\\u0442\\u043D\\u0430\\u044F \\u043E\\u0448\\u0438\\u0431\\u043A\\u0430\"}`;\n            showAlert(errorMessage, 'error');\n            return;\n        }\n        showAlert(\"\\u0417\\u0430\\u044F\\u0432\\u043A\\u0430 \\u0443\\u0441\\u043F\\u0435\\u0448\\u043D\\u043E \\u043E\\u0431\\u043D\\u043E\\u0432\\u043B\\u0435\\u043D\\u0430!\", 'success');\n        const modal = bootstrap.Modal.getInstance(document.getElementById('offerResponseModal'));\n        modal.hide();\n        // Refresh the offers list if the function exists.\n        if (typeof loadOffers === 'function') loadOffers();\n    } catch (error) {\n        console.error('Error updating offer:', error);\n        showAlert(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0441\\u0435\\u0440\\u0432\\u0435\\u0440\\u0430\", 'error');\n    } finally{\n        submitBtn.disabled = false;\n        submitBtn.innerHTML = originalText;\n    }\n}\n// --- MODAL AND FORM LOGIC ---\n/**\n * Opens the modal and populates it with the offer data.\n * @param {object} offerData - The data for the offer.\n */ function $c073e20d34594191$var$openOfferResponseModal(offerData) {\n    $c073e20d34594191$var$currentOffer = offerData;\n    $c073e20d34594191$var$populateModalForm(offerData);\n    const modal = new bootstrap.Modal(document.getElementById('offerResponseModal'));\n    modal.show();\n}\n/**\n * Fills the modal's form with data from the selected offer.\n * @param {object} offerData - The data for the offer.\n */ function $c073e20d34594191$var$populateModalForm(offerData) {\n    document.getElementById('responseOfferId').textContent = offerData.id;\n    document.getElementById('offerId').value = offerData.id;\n    document.getElementById('responseDescription').textContent = offerData.description || \"\\u041E\\u043F\\u0438\\u0441\\u0430\\u043D\\u0438\\u0435 \\u043E\\u0442\\u0441\\u0443\\u0442\\u0441\\u0442\\u0432\\u0443\\u0435\\u0442\";\n    document.getElementById('responseStatus').value = offerData.status || 'PENDING';\n    document.getElementById('responseText').value = offerData.response || '';\n}\n/**\n * Clears the form fields and resets the state.\n */ function $c073e20d34594191$var$clearModalForm() {\n    const form = document.getElementById('adminUpdateForm');\n    if (form) form.reset(); // Resets all form fields\n    // Manually clear elements not part of the form if needed\n    document.getElementById('responseOfferId').textContent = '';\n    document.getElementById('responseDescription').textContent = \"\\u041E\\u043F\\u0438\\u0441\\u0430\\u043D\\u0438\\u0435 \\u043E\\u0442\\u0441\\u0443\\u0442\\u0441\\u0442\\u0432\\u0443\\u0435\\u0442\";\n    $c073e20d34594191$var$currentOffer = null;\n}\n// --- UTILITY FUNCTIONS ---\n/**\n * Creates the HTML for the response button.\n * @param {object} offer - The offer object.\n * @returns {string} HTML string for the button.\n */ function $c073e20d34594191$var$createOfferResponseButton(offer) {\n    return `\n        <button class=\"btn btn-info btn-icon btn-sm js-open-response-modal\"\n                title=\"\\u{41E}\\u{442}\\u{432}\\u{435}\\u{442}\\u{438}\\u{442}\\u{44C}\"\n                data-id=\"${offer.id}\"\n                data-description=\"${$c073e20d34594191$var$escapeHtml(offer.description || '')}\"\n                data-response=\"${$c073e20d34594191$var$escapeHtml(offer.response || '')}\"\n                data-status=\"${offer.status}\">\n            <i class=\"bi bi-reply\"></i>\n        </button>\n    `;\n}\n/**\n * Gets the CSRF token from the page's meta tags.\n * @returns {string} The CSRF token.\n */ function $c073e20d34594191$var$getCsrfToken() {\n    return document.querySelector('meta[name=\"_csrf\"]')?.getAttribute('content') || '';\n}\n/**\n * Escapes HTML special characters to prevent XSS.\n * @param {string} text - The string to escape.\n * @returns {string} The escaped string.\n */ function $c073e20d34594191$var$escapeHtml(text) {\n    if (typeof text !== 'string') return '';\n    const map = {\n        '&': '&amp;',\n        '<': '&lt;',\n        '>': '&gt;',\n        '\"': '&quot;',\n        \"'\": '&#039;'\n    };\n    return text.replace(/[&<>\"]|'(?!$)/g, (m)=>map[m]);\n}\n// --- GLOBAL EXPOSURE ---\n// Expose functions to the global scope if they need to be called from inline scripts or other modules.\nwindow.openOfferResponseModal = $c073e20d34594191$var$openOfferResponseModal;\nwindow.createOfferResponseButton = $c073e20d34594191$var$createOfferResponseButton;\n\n\n// Глобальные переменные для хранения данных\nlet $1c387a80789f9a23$var$currentEditingUser = null;\n// Функция открытия модального окна редактирования\nasync function $1c387a80789f9a23$var$openEditUserModal(userId) {\n    try {\n        // Загружаем данные пользователя\n        const userResponse = await fetch(`/admin/user/${userId}`);\n        if (!userResponse.ok) throw new Error(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0438 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445 \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F\");\n        const userData = await userResponse.json();\n        if (!userData.success) throw new Error(userData.message || \"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445 \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F\");\n        $1c387a80789f9a23$var$currentEditingUser = userData.data;\n        console.log($1c387a80789f9a23$var$currentEditingUser);\n        const modalElement = document.getElementById('editUserModal');\n        if (!modalElement) throw new Error(\"\\u041C\\u043E\\u0434\\u0430\\u043B\\u044C\\u043D\\u043E\\u0435 \\u043E\\u043A\\u043D\\u043E \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\\u043E \\u0432 DOM\");\n        // Показываем модальное окно\n        const modal = new bootstrap.Modal(modalElement);\n        $('#editUserName').text(`${$1c387a80789f9a23$var$currentEditingUser[\"firstName\"]} ${$1c387a80789f9a23$var$currentEditingUser[\"lastName\"]}`);\n        $('#editUserUsername').text(`${$1c387a80789f9a23$var$currentEditingUser.username}`);\n        $('#editUserDepartment').val(`${$1c387a80789f9a23$var$currentEditingUser['department']}`);\n        $('#editUserJobTitle').val(`${$1c387a80789f9a23$var$currentEditingUser['jobTitle']}`);\n        $('#editUserQualification').val(`${$1c387a80789f9a23$var$currentEditingUser['qualification']}`);\n        $('#userIdForUpdate').val(`${$1c387a80789f9a23$var$currentEditingUser['id']}`);\n        // noinspection JSUnresolvedReference\n        modal.show();\n    } catch (error) {\n        console.error(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u043E\\u0442\\u043A\\u0440\\u044B\\u0442\\u0438\\u044F \\u043C\\u043E\\u0434\\u0430\\u043B\\u044C\\u043D\\u043E\\u0433\\u043E \\u043E\\u043A\\u043D\\u0430:\", error);\n        showAlert(\"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u043E\\u0442\\u043A\\u0440\\u044B\\u0442\\u044C \\u0444\\u043E\\u0440\\u043C\\u0443 \\u0440\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u044F\", 'error');\n    }\n}\n// Сохранение изменений\nasync function $1c387a80789f9a23$var$saveUserChanges() {\n    try {\n        const formData = {\n            userId: document.getElementById('userIdForUpdate').value,\n            department: document.getElementById('editUserDepartment').value,\n            jobTitle: document.getElementById('editUserJobTitle').value,\n            qualification: document.getElementById('editUserQualification').value,\n            role: document.getElementById('editUserRole').value\n        };\n        console.log(formData);\n        const response = await fetch('/admin/user/update', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'X-CSRF-TOKEN': $1c387a80789f9a23$var$getCsrfToken()\n            },\n            body: JSON.stringify(formData)\n        });\n        const result = await response.json();\n        console.log(result);\n        if (response.ok && result.success) {\n            showAlert(\"\\u0414\\u0430\\u043D\\u043D\\u044B\\u0435 \\u0443\\u0441\\u043F\\u0435\\u0448\\u043D\\u043E \\u043E\\u0431\\u043D\\u043E\\u0432\\u043B\\u0435\\u043D\\u044B!\", 'success');\n            // Закрываем модальное окно\n            const modal = bootstrap.Modal.getInstance(document.getElementById('editUserModal'));\n            modal.hide();\n            // Обновляем таблицу пользователей\n            loadUsers();\n        } else // Обработка ошибок валидации\n        if (result.errors) $1c387a80789f9a23$var$displayValidationErrors(result.errors);\n        else showAlert(result.error || \"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u043F\\u0440\\u0438 \\u0441\\u043E\\u0445\\u0440\\u0430\\u043D\\u0435\\u043D\\u0438\\u0438 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445\", 'error');\n    } catch (error) {\n        console.error(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0441\\u043E\\u0445\\u0440\\u0430\\u043D\\u0435\\u043D\\u0438\\u044F:\", error);\n        showAlert(\"\\u041F\\u0440\\u043E\\u0438\\u0437\\u043E\\u0448\\u043B\\u0430 \\u043E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u043F\\u0440\\u0438 \\u0441\\u043E\\u0445\\u0440\\u0430\\u043D\\u0435\\u043D\\u0438\\u0438 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445\", 'error');\n    }\n}\n// Функция для отображения ошибок валидации\nfunction $1c387a80789f9a23$var$displayValidationErrors(errors) {\n    let errorMessages = [];\n    // Проходим по всем ошибкам и собираем сообщения\n    for (const [field, message] of Object.entries(errors))errorMessages.push(`${$1c387a80789f9a23$var$getFieldDisplayName(field)}: ${message}`);\n    if (errorMessages.length > 0) showAlert(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0438 \\u0432\\u0430\\u043B\\u0438\\u0434\\u0430\\u0446\\u0438\\u0438:\\n\" + errorMessages.join('\\n'), 'error');\n}\n// Функция для получения читаемого имени поля\nfunction $1c387a80789f9a23$var$getFieldDisplayName(field) {\n    const fieldNames = {\n        'userId': \"ID \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F\",\n        'department': \"\\u041E\\u0442\\u0434\\u0435\\u043B\",\n        'jobTitle': \"\\u0414\\u043E\\u043B\\u0436\\u043D\\u043E\\u0441\\u0442\\u044C\",\n        'qualification': \"\\u041A\\u0432\\u0430\\u043B\\u0438\\u0444\\u0438\\u043A\\u0430\\u0446\\u0438\\u044F\",\n        'role': \"\\u0420\\u043E\\u043B\\u044C\"\n    };\n    return fieldNames[field] || field;\n}\n// Функция для получения CSRF токена\nfunction $1c387a80789f9a23$var$getCsrfToken() {\n    return document.querySelector('meta[name=\"_csrf\"]')?.getAttribute('content') || '';\n}\n// Инициализация при загрузке страницы\ndocument.addEventListener('DOMContentLoaded', function() {\n    document.getElementById('saveUserChangesBtn').addEventListener('click', $1c387a80789f9a23$var$saveUserChanges);\n});\n// Обновите функцию editUser в основном скрипте\nfunction $1c387a80789f9a23$var$editUser(userId) {\n    $1c387a80789f9a23$var$openEditUserModal(userId);\n}\nwindow.editUser = $1c387a80789f9a23$var$editUser;\n\n\nlet $638425cc06b147b7$var$currentPageUsers = 1;\nlet $638425cc06b147b7$var$totalPagesUsers = 1;\nlet $638425cc06b147b7$var$totalItemsUsers = 0;\nlet $638425cc06b147b7$var$usersPerPage = 10; // Default page size\nlet $638425cc06b147b7$var$roleFilter = 'ALL'; // Default role filter\nasync function $638425cc06b147b7$var$loadUsers(page = 1, size = $638425cc06b147b7$var$usersPerPage, role = $638425cc06b147b7$var$roleFilter) {\n    console.log(\"Refresh button clicked. Calling loadUsers.\"); // Added for debugging\n    try {\n        console.log(`\\u{417}\\u{430}\\u{433}\\u{440}\\u{443}\\u{437}\\u{43A}\\u{430} \\u{43F}\\u{43E}\\u{43B}\\u{44C}\\u{437}\\u{43E}\\u{432}\\u{430}\\u{442}\\u{435}\\u{43B}\\u{435}\\u{439}: \\u{441}\\u{442}\\u{440}\\u{430}\\u{43D}\\u{438}\\u{446}\\u{430} ${page}, \\u{440}\\u{430}\\u{437}\\u{43C}\\u{435}\\u{440} ${size}, \\u{440}\\u{43E}\\u{43B}\\u{44C} ${role}`);\n        const response = await fetch(`/admin/users?page=${page}&size=${size}&role=${role}`);\n        if (response.ok) {\n            const data = await response.json();\n            if (data.success && data.data) {\n                $638425cc06b147b7$var$currentPageUsers = data.data.currentPage || page;\n                $638425cc06b147b7$var$totalPagesUsers = data.data.totalPages || 1;\n                $638425cc06b147b7$var$totalItemsUsers = data.data.totalItems || data.data.content.length;\n                $638425cc06b147b7$var$renderUsersTable(data.data.content);\n            } else throw new Error(\"\\u041D\\u0435\\u0432\\u0435\\u0440\\u043D\\u044B\\u0439 \\u0444\\u043E\\u0440\\u043C\\u0430\\u0442 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445 \\u043E\\u0442 \\u0441\\u0435\\u0440\\u0432\\u0435\\u0440\\u0430\");\n        } else throw new Error(`\\u{41E}\\u{448}\\u{438}\\u{431}\\u{43A}\\u{430} \\u{441}\\u{435}\\u{440}\\u{432}\\u{435}\\u{440}\\u{430}: ${response.status}`);\n    } catch (e) {\n        console.error(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0438 \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u0435\\u0439:\", e);\n        $638425cc06b147b7$var$showError(\"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435 \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u0435\\u0439\");\n    }\n}\nfunction $638425cc06b147b7$var$rowsInUserTable(size) {\n    $638425cc06b147b7$var$usersPerPage = parseInt(size, 10);\n    $638425cc06b147b7$var$loadUsers(1, $638425cc06b147b7$var$usersPerPage, $638425cc06b147b7$var$roleFilter);\n}\nfunction $638425cc06b147b7$var$filterByUserRole(role) {\n    $638425cc06b147b7$var$roleFilter = role;\n    $638425cc06b147b7$var$loadUsers(1, $638425cc06b147b7$var$usersPerPage, $638425cc06b147b7$var$roleFilter);\n}\nasync function $638425cc06b147b7$var$deleteUsersRequest(userId) {\n    try {\n        const body = JSON.stringify({\n            userId: userId\n        });\n        const deleteRequest = await fetch(`/admin/users/delete`, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: body\n        });\n        const response = await deleteRequest.json();\n        console.log(response);\n        if (deleteRequest.ok) {\n            if (response.success) {\n                const successMessage = response.message || response.data;\n                showAlert(successMessage, 'success');\n                // Перезагружаем список пользователей\n                await $638425cc06b147b7$var$loadUsers($638425cc06b147b7$var$currentPageUsers, $638425cc06b147b7$var$usersPerPage, $638425cc06b147b7$var$roleFilter);\n            } else showAlert(response.message, 'error');\n        } else showAlert(`\\u{41E}\\u{448}\\u{438}\\u{431}\\u{43A}\\u{430} \\u{441}\\u{435}\\u{440}\\u{432}\\u{435}\\u{440}\\u{430}: ${response.error || \"\\u041D\\u0435\\u0438\\u0437\\u0432\\u0435\\u0441\\u0442\\u043D\\u0430\\u044F \\u043E\\u0448\\u0438\\u0431\\u043A\\u0430\"}`, 'error');\n    } catch (error) {\n        showAlert(`\\u{41E}\\u{448}\\u{438}\\u{431}\\u{43A}\\u{430} \\u{443}\\u{434}\\u{430}\\u{43B}\\u{435}\\u{43D}\\u{438}\\u{44F}: ${error.message}`, 'error');\n        console.error('Delete error:', error);\n    }\n}\nfunction $638425cc06b147b7$var$renderUsersTable(users) {\n    const tableContainer = document.querySelector('#users-tab .card-body');\n    if (!tableContainer) {\n        console.error(\"\\u041A\\u043E\\u043D\\u0442\\u0435\\u0439\\u043D\\u0435\\u0440 \\u0434\\u043B\\u044F \\u0442\\u0430\\u0431\\u043B\\u0438\\u0446\\u044B \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\");\n        return;\n    }\n    tableContainer.innerHTML = '';\n    const tableHTML = `\n    <div class=\"users-table-container\">\n        <div class=\"data-table users-table\">\n            <div class=\"table-header d-flex justify-content-between align-items-center\">\n                <h3 class=\"table-title\">\\u{421}\\u{43F}\\u{438}\\u{441}\\u{43E}\\u{43A} \\u{43F}\\u{43E}\\u{43B}\\u{44C}\\u{437}\\u{43E}\\u{432}\\u{430}\\u{442}\\u{435}\\u{43B}\\u{435}\\u{439}</h3>\n                <div class=\"table-header-actions d-flex align-items-center\" style=\"gap: 1rem;\">\n                    <div class=\"input-group\">\n                        <span class=\"input-group-text\"><i class=\"bi bi-people\"></i></span>\n                        <select class=\"form-select form-select-sm\" id=\"roleFilter\" onchange=\"filterByUserRole(this.value)\">\n                            <option value=\"ALL\" ${$638425cc06b147b7$var$roleFilter === 'ALL' ? 'selected' : ''}>\\u{412}\\u{441}\\u{435} \\u{440}\\u{43E}\\u{43B}\\u{438}</option>\n                            <option value=\"USER\" ${$638425cc06b147b7$var$roleFilter === 'USER' ? 'selected' : ''}>\\u{41F}\\u{43E}\\u{43B}\\u{44C}\\u{437}\\u{43E}\\u{432}\\u{430}\\u{442}\\u{435}\\u{43B}\\u{44C}</option>\n                            <option value=\"ADMIN\" ${$638425cc06b147b7$var$roleFilter === 'ADMIN' ? 'selected' : ''}>\\u{410}\\u{434}\\u{43C}\\u{438}\\u{43D}\\u{438}\\u{441}\\u{442}\\u{440}\\u{430}\\u{442}\\u{43E}\\u{440}</option>\n                        </select>\n                    </div>\n                    <div class=\"input-group\">\n                        <span class=\"input-group-text\">\\u{41F}\\u{43E}\\u{43A}\\u{430}\\u{437}\\u{44B}\\u{432}\\u{430}\\u{442}\\u{44C}</span>\n                        <select class=\"form-select form-select-sm\" id=\"pageSizeSelect\" onchange=\"rowsInUserTable(this.value)\">\n                            <option value=\"5\" ${$638425cc06b147b7$var$usersPerPage == 5 ? 'selected' : ''}>5</option>\n                            <option value=\"10\" ${$638425cc06b147b7$var$usersPerPage == 10 ? 'selected' : ''}>10</option>\n                            <option value=\"20\" ${$638425cc06b147b7$var$usersPerPage == 20 ? 'selected' : ''}>20</option>\n                            <option value=\"50\" ${$638425cc06b147b7$var$usersPerPage == 50 ? 'selected' : ''}>50</option>\n                        </select>\n                    </div>\n                </div>\n            </div>\n            \n            <div class=\"table-content\">\n                <!-- \\u{417}\\u{430}\\u{433}\\u{43E}\\u{43B}\\u{43E}\\u{432}\\u{43E}\\u{43A} \\u{442}\\u{430}\\u{431}\\u{43B}\\u{438}\\u{446}\\u{44B} -->\n                <div class=\"table-row header-row\">\n                    <div class=\"table-cell\">ID</div>\n                    <div class=\"table-cell\">\\u{410}\\u{432}\\u{430}\\u{442}\\u{430}\\u{440}</div>\n                    <div class=\"table-cell\">\\u{418}\\u{43C}\\u{44F}</div>\n                    <div class=\"table-cell\">\\u{424}\\u{430}\\u{43C}\\u{438}\\u{43B}\\u{438}\\u{44F}</div>\n                    <div class=\"table-cell\">\\u{41E}\\u{442}\\u{434}\\u{435}\\u{43B}</div>\n                    <div class=\"table-cell\">\\u{414}\\u{43E}\\u{43B}\\u{436}\\u{43D}\\u{43E}\\u{441}\\u{442}\\u{44C}</div>\n                    <div class=\"table-cell\">\\u{41A}\\u{432}\\u{430}\\u{43B}\\u{438}\\u{444}\\u{438}\\u{43A}\\u{430}\\u{446}\\u{438}\\u{44F}</div>\n                    <div class=\"table-cell\">\\u{41B}\\u{43E}\\u{433}\\u{438}\\u{43D}</div>\n                    <div class=\"table-cell\">\\u{421}\\u{43E}\\u{437}\\u{434}\\u{430}\\u{43D}</div>\n                    <div class=\"table-cell\">\\u{420}\\u{43E}\\u{43B}\\u{44C}</div>\n                    <div class=\"table-cell\">\\u{414}\\u{435}\\u{439}\\u{441}\\u{442}\\u{432}\\u{438}\\u{44F}</div>\n                </div>\n                \n                ${users.length > 0 ? users.map((user)=>`\n                    <div class=\"table-row\">\n                        <div class=\"table-cell text-muted\">#${user.id || 'N/A'}</div>\n                        <div class=\"table-cell\">\n                            <img src=\"/avatars/${user.avatar || 'avatar.png'}\" alt=\"\\u{410}\\u{432}\\u{430}\\u{442}\\u{430}\\u{440}\" class=\"user-avatar\">\n                        </div>\n                        <div class=\"table-cell\">${$638425cc06b147b7$var$escapeHtml(user.firstName || \"\\u041D\\u0435 \\u0443\\u043A\\u0430\\u0437\\u0430\\u043D\\u043E\")}</div>\n                        <div class=\"table-cell\">${$638425cc06b147b7$var$escapeHtml(user.lastName || \"\\u041D\\u0435 \\u0443\\u043A\\u0430\\u0437\\u0430\\u043D\\u043E\")}</div>\n                        <div class=\"table-cell\">${$638425cc06b147b7$var$escapeHtml(user.department || \"\\u041D\\u0435 \\u0443\\u043A\\u0430\\u0437\\u0430\\u043D\")}</div>\n                        <div class=\"table-cell\">${$638425cc06b147b7$var$escapeHtml(user.jobTitle || \"\\u041D\\u0435 \\u0443\\u043A\\u0430\\u0437\\u0430\\u043D\\u0430\")}</div>\n                        <div class=\"table-cell\">\n                            <span class=\"status-badge ${$638425cc06b147b7$var$getQualificationClass(user.qualification)}\">\n                                ${$638425cc06b147b7$var$escapeHtml(user.qualification || \"\\u041D\\u0435 \\u0443\\u043A\\u0430\\u0437\\u0430\\u043D\\u0430\")}\n                            </span>\n                        </div>\n                        <div class=\"table-cell\">${$638425cc06b147b7$var$escapeHtml(user.username || \"\\u041D\\u0435 \\u0443\\u043A\\u0430\\u0437\\u0430\\u043D\")}</div>\n                        <div class=\"table-cell text-sm text-muted\">${$638425cc06b147b7$var$formatDate(user.createdAt)}</div>\n                        <div class=\"table-cell\">${$638425cc06b147b7$var$displayRoles(user.role)}</div>\n                        <div class=\"table-cell action-buttons justify-content-center\">\n                            <button class=\"btn btn-primary btn-icon btn-sm\" title=\"\\u{420}\\u{435}\\u{434}\\u{430}\\u{43A}\\u{442}\\u{438}\\u{440}\\u{43E}\\u{432}\\u{430}\\u{442}\\u{44C}\" onclick=\"editUser(${user.id})\">\n                                <i class=\"bi bi-pencil\"></i>\n                            </button>\n                            <button class=\"btn btn-danger btn-icon btn-sm\" title=\"\\u{423}\\u{434}\\u{430}\\u{43B}\\u{438}\\u{442}\\u{44C}\" onclick=\"deleteUser(${user.id})\">\n                                <i class=\"bi bi-trash\"></i>\n                            </button>\n                            <button class=\"btn btn-success btn-icon btn-sm\" title=\"\\u{417}\\u{430}\\u{43F}\\u{438}\\u{441}\\u{430}\\u{442}\\u{44C} \\u{43D}\\u{430} \\u{43A}\\u{443}\\u{440}\\u{441}\" onclick=\"openEnrollModal(${user.id}, '${$638425cc06b147b7$var$escapeHtml(user.firstName)} ${$638425cc06b147b7$var$escapeHtml(user.lastName)}')\">\n                                <i class=\"bi bi-plus-circle\"></i>\n                            </button>\n                            <button class=\"btn btn-info btn-icon btn-sm\" title=\"\\u{41F}\\u{440}\\u{43E}\\u{441}\\u{43C}\\u{43E}\\u{442}\\u{440} \\u{43A}\\u{443}\\u{440}\\u{441}\\u{43E}\\u{432}\" onclick=\"openViewCoursesModal(${user.id}, '${$638425cc06b147b7$var$escapeHtml(user.firstName)} ${$638425cc06b147b7$var$escapeHtml(user.lastName)}')\">\n                                <i class=\"bi bi-card-list\"></i>\n                            </button>\n                        </div>\n                    </div>\n                `).join('') : `\n                    <div class=\"table-row\" style=\"grid-template-columns: 1fr;\">\n                        <div class=\"text-center py-4 text-muted\">\n                            <i class=\"bi bi-inbox fs-3 d-block mb-2\"></i>\n                            \\u{41F}\\u{43E}\\u{43B}\\u{44C}\\u{437}\\u{43E}\\u{432}\\u{430}\\u{442}\\u{435}\\u{43B}\\u{438} \\u{43D}\\u{435} \\u{43D}\\u{430}\\u{439}\\u{434}\\u{435}\\u{43D}\\u{44B}\n                        </div>\n                    </div>\n                `}\n            </div>\n        </div>\n    </div>\n        \n    <!-- \\u{41A}\\u{43E}\\u{43D}\\u{442}\\u{435}\\u{439}\\u{43D}\\u{435}\\u{440} \\u{434}\\u{43B}\\u{44F} \\u{43F}\\u{430}\\u{433}\\u{438}\\u{43D}\\u{430}\\u{446}\\u{438}\\u{438} -->\n    <div class=\"pagination-container mt-3\"></div>\n    \n    <!-- \\u{41A}\\u{43D}\\u{43E}\\u{43F}\\u{43A}\\u{430} \\u{43E}\\u{431}\\u{43D}\\u{43E}\\u{432}\\u{43B}\\u{435}\\u{43D}\\u{438}\\u{44F} -->\n    <div class=\"text-center mt-3\">\n        <button class=\"btn btn-primary\" onclick=\"refreshUsersTable()\">\n            <i class=\"bi bi-arrow-repeat\"></i> \\u{41E}\\u{431}\\u{43D}\\u{43E}\\u{432}\\u{438}\\u{442}\\u{44C} \\u{441}\\u{43F}\\u{438}\\u{441}\\u{43E}\\u{43A}\n        </button>\n    </div>\n    `;\n    tableContainer.innerHTML = tableHTML;\n    const paginationContainer = document.querySelector('#users-tab .pagination-container');\n    if (!paginationContainer) {\n        console.error(\"\\u041A\\u043E\\u043D\\u0442\\u0435\\u0439\\u043D\\u0435\\u0440 \\u0434\\u043B\\u044F \\u043F\\u0430\\u0433\\u0438\\u043D\\u0430\\u0446\\u0438\\u0438 \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\");\n        return;\n    }\n    if ($638425cc06b147b7$var$totalPagesUsers <= 1) {\n        paginationContainer.innerHTML = '';\n        return;\n    }\n    let paginationHTML = `\n        <nav aria-label=\"Page navigation\">\n            <ul class=\"pagination justify-content-center\">\n                <li class=\"page-item ${$638425cc06b147b7$var$currentPageUsers === 1 ? 'disabled' : ''}\">\n                    <a class=\"page-link\" href=\"#\" onclick=\"changeUsersPage(${$638425cc06b147b7$var$currentPageUsers - 1}); return false;\" aria-label=\"Previous\">\n                        <span aria-hidden=\"true\">&laquo;</span>\n                    </a>\n                </li>\n    `;\n    const maxVisiblePages = 5;\n    let startPage = Math.max(1, $638425cc06b147b7$var$currentPageUsers - Math.floor(maxVisiblePages / 2));\n    let endPage = Math.min($638425cc06b147b7$var$totalPagesUsers, startPage + maxVisiblePages - 1);\n    if (endPage - startPage + 1 < maxVisiblePages) startPage = Math.max(1, endPage - maxVisiblePages + 1);\n    if (startPage > 1) paginationHTML += `\n            <li class=\"page-item\">\n                <a class=\"page-link\" href=\"#\" onclick=\"changeUsersPage(1); return false;\">1</a>\n            </li>\n            ${startPage > 2 ? '<li class=\"page-item disabled\"><span class=\"page-link\">...</span></li>' : ''}\n        `;\n    for(let i = startPage; i <= endPage; i++)paginationHTML += `\n            <li class=\"page-item ${i === $638425cc06b147b7$var$currentPageUsers ? 'active' : ''}\">\n                <a class=\"page-link\" href=\"#\" onclick=\"changeUsersPage(${i}); return false;\">${i}</a>\n            </li>\n        `;\n    if (endPage < $638425cc06b147b7$var$totalPagesUsers) paginationHTML += `\n            ${endPage < $638425cc06b147b7$var$totalPagesUsers - 1 ? '<li class=\"page-item disabled\"><span class=\"page-link\">...</span></li>' : ''}\n            <li class=\"page-item\">\n                <a class=\"page-link\" href=\"#\" onclick=\"changeUsersPage(${$638425cc06b147b7$var$totalPagesUsers}); return false;\">${$638425cc06b147b7$var$totalPagesUsers}</a>\n            </li>\n        `;\n    paginationHTML += `\n                <li class=\"page-item ${$638425cc06b147b7$var$currentPageUsers === $638425cc06b147b7$var$totalPagesUsers ? 'disabled' : ''}\">\n                    <a class=\"page-link\" href=\"#\" onclick=\"changeUsersPage(${$638425cc06b147b7$var$currentPageUsers + 1}); return false;\" aria-label=\"Next\">\n                        <span aria-hidden=\"true\">&raquo;</span>\n                    </a>\n                </li>\n            </ul>\n        </nav>\n        \n        <div class=\"pagination-info text-center mt-2\">\n            <small class=\"text-muted\">\n                \\u{421}\\u{442}\\u{440}\\u{430}\\u{43D}\\u{438}\\u{446}\\u{430} ${$638425cc06b147b7$var$currentPageUsers} \\u{438}\\u{437} ${$638425cc06b147b7$var$totalPagesUsers} \\u{2022} \n                \\u{412}\\u{441}\\u{435}\\u{433}\\u{43E} \\u{43F}\\u{43E}\\u{43B}\\u{44C}\\u{437}\\u{43E}\\u{432}\\u{430}\\u{442}\\u{435}\\u{43B}\\u{435}\\u{439}: ${$638425cc06b147b7$var$totalItemsUsers}\n            </small>\n        </div>\n    `;\n    paginationContainer.innerHTML = paginationHTML;\n}\nfunction $638425cc06b147b7$var$changeUsersPage(page) {\n    if (page < 1 || page > $638425cc06b147b7$var$totalPagesUsers || page === $638425cc06b147b7$var$currentPageUsers) return;\n    $638425cc06b147b7$var$loadUsers(page, $638425cc06b147b7$var$usersPerPage, $638425cc06b147b7$var$roleFilter);\n}\n// Вспомогательные функции\nfunction $638425cc06b147b7$var$escapeHtml(text) {\n    if (text === null || text === undefined) return '';\n    const div = document.createElement('div');\n    div.textContent = text;\n    return div.innerHTML;\n}\nfunction $638425cc06b147b7$var$formatDate(dateString) {\n    if (!dateString) return \"\\u041D\\u0435 \\u0443\\u043A\\u0430\\u0437\\u0430\\u043D\\u043E\";\n    try {\n        const date = new Date(dateString);\n        return date.toLocaleDateString('ru-RU', {\n            year: 'numeric',\n            month: '2-digit',\n            day: '2-digit'\n        });\n    } catch (e) {\n        return dateString;\n    }\n}\nfunction $638425cc06b147b7$var$getQualificationClass(qualification) {\n    if (!qualification) return 'status-pending';\n    const qual = qualification.toLowerCase();\n    if (qual.includes('expert') || qual.includes('senior') || qual.includes('lead')) return 'status-completed';\n    else if (qual.includes('middle') || qual.includes('intermediate')) return 'status-review';\n    else if (qual.includes('junior') || qual.includes('trainee')) return 'status-pending';\n    else return 'status-pending';\n}\nfunction $638425cc06b147b7$var$displayRoles(role) {\n    return role === '[ROLE_USER]' ? \"\\u041F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044C\" : \"\\u0410\\u0434\\u043C\\u0438\\u043D\\u0438\\u0441\\u0442\\u0440\\u0430\\u0442\\u043E\\u0440\";\n}\nfunction $638425cc06b147b7$var$showError(message) {\n    const tableContainer = document.querySelector('#users-tab .card-body');\n    if (tableContainer) tableContainer.innerHTML = `\n            <div class=\"alert alert-danger\" role=\"alert\">\n                <i class=\"fas fa-exclamation-triangle\"></i>\n                ${$638425cc06b147b7$var$escapeHtml(message)}\n            </div>\n            <div style=\"text-align: center; margin-top: 1rem;\">\n                <button class=\"btn btn-primary\" onclick=\"loadUsers(1)\">\n                    <i class=\"fas fa-redo\"></i> \\u{41F}\\u{43E}\\u{43F}\\u{440}\\u{43E}\\u{431}\\u{43E}\\u{432}\\u{430}\\u{442}\\u{44C} \\u{441}\\u{43D}\\u{43E}\\u{432}\\u{430}\n                </button>\n            </div>\n        `;\n}\nfunction $638425cc06b147b7$var$deleteUser(userId) {\n    if (confirm(\"\\u0412\\u044B \\u0443\\u0432\\u0435\\u0440\\u0435\\u043D\\u044B, \\u0447\\u0442\\u043E \\u0445\\u043E\\u0442\\u0438\\u0442\\u0435 \\u0443\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u044D\\u0442\\u043E\\u0433\\u043E \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F?\")) $638425cc06b147b7$var$deleteUsersRequest(userId);\n}\n// Функция для открытия модального окна\nasync function $638425cc06b147b7$var$openEnrollModal(userId, userName) {\n    // 1. Устанавливаем имя и ID пользователя в модальном окне\n    document.getElementById('enrollUserName').textContent = userName;\n    document.getElementById('enrollUserId').value = userId;\n    const courseSelect = document.getElementById('courseSelect');\n    courseSelect.innerHTML = \"<option>\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u043A\\u0443\\u0440\\u0441\\u043E\\u0432...</option>\";\n    // 2. Показываем модальное окно\n    const modal = new bootstrap.Modal(document.getElementById('enrollUserModal'));\n    modal.show();\n    // 3. Загружаем список курсов с бэкенда\n    try {\n        const response = await fetch('/admin/courses');\n        const data = await response.json();\n        console.log(data);\n        if (data.success && data.data && data.data.content) {\n            courseSelect.innerHTML = ''; // Очищаем\n            if (data.data.content.length === 0) courseSelect.innerHTML = \"<option>\\u041D\\u0435\\u0442 \\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u044B\\u0445 \\u043A\\u0443\\u0440\\u0441\\u043E\\u0432</option>\";\n            else data.data.content.forEach((course)=>{\n                const option = document.createElement('option');\n                option.value = course.id;\n                option.textContent = course.title;\n                courseSelect.appendChild(option);\n            });\n        }\n    } catch (e) {\n        courseSelect.innerHTML = \"<option>\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0438 \\u043A\\u0443\\u0440\\u0441\\u043E\\u0432</option>\";\n        console.error(e);\n    }\n}\n// Функция для подтверждения и отправки запроса\nasync function $638425cc06b147b7$var$confirmEnrollment() {\n    const userId = document.getElementById('enrollUserId').value;\n    const courseId = document.getElementById('courseSelect').value;\n    if (!courseId || isNaN(courseId)) {\n        alert(\"\\u041F\\u043E\\u0436\\u0430\\u043B\\u0443\\u0439\\u0441\\u0442\\u0430, \\u0432\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u043A\\u0443\\u0440\\u0441.\");\n        return;\n    }\n    const requestData = {\n        userId: parseInt(userId),\n        courseId: parseInt(courseId)\n    };\n    console.log(\"enrollment data \", requestData);\n    try {\n        const response = await fetch('/admin/user/enroll', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify(requestData)\n        });\n        const result = await response.json();\n        if (response.ok && result.success) {\n            showAlert(result.message);\n            // Закрываем модальное окно\n            const modal = bootstrap.Modal.getInstance(document.getElementById('enrollUserModal'));\n            modal.hide();\n        } else showAlert(`\\u{41E}\\u{448}\\u{438}\\u{431}\\u{43A}\\u{430}: ${result.message || \"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u0437\\u0430\\u043F\\u0438\\u0441\\u0430\\u0442\\u044C \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F.\"}`, 'error');\n    } catch (e) {\n        showAlert(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0441\\u0435\\u0440\\u0432\\u0435\\u0440\\u0430\", 'error');\n        console.error(e);\n    }\n}\nasync function $638425cc06b147b7$var$openViewCoursesModal(userId, userName) {\n    document.getElementById('viewUserName').textContent = userName;\n    const userCoursesList = document.getElementById('userCoursesList');\n    userCoursesList.innerHTML = '<li class=\"list-group-item\">\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u043A\\u0443\\u0440\\u0441\\u043E\\u0432...</li>';\n    // Сохраняем данные для перезагрузки\n    userCoursesList.dataset.userId = userId;\n    userCoursesList.dataset.userName = userName;\n    const modal = new bootstrap.Modal(document.getElementById('viewUserCoursesModal'));\n    modal.show();\n    await $638425cc06b147b7$var$refreshUserCoursesList(userId, userName);\n}\nasync function $638425cc06b147b7$var$refreshUserCoursesList(userId, userName) {\n    const userCoursesList = document.getElementById('userCoursesList');\n    userCoursesList.innerHTML = '<li class=\"list-group-item\">\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u043A\\u0443\\u0440\\u0441\\u043E\\u0432...</li>';\n    try {\n        const response = await fetch(`/admin/user/${userId}/courses`);\n        const data = await response.json();\n        if (data.success && data.data) {\n            userCoursesList.innerHTML = '';\n            if (data.data.length === 0) userCoursesList.innerHTML = '<li class=\"list-group-item\">\\u041F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044C \\u043D\\u0435 \\u0437\\u0430\\u043F\\u0438\\u0441\\u0430\\u043D \\u043D\\u0438 \\u043D\\u0430 \\u043E\\u0434\\u0438\\u043D \\u043A\\u0443\\u0440\\u0441.</li>';\n            else data.data.forEach((course)=>{\n                const listItem = document.createElement('li');\n                listItem.className = 'list-group-item d-flex justify-content-between align-items-center';\n                const titleSpan = document.createElement('span');\n                titleSpan.textContent = course.title;\n                listItem.appendChild(titleSpan);\n                const unenrollButton = document.createElement('button');\n                unenrollButton.className = 'btn btn-danger btn-sm';\n                unenrollButton.textContent = \"\\u041E\\u0442\\u043F\\u0438\\u0441\\u0430\\u0442\\u044C\";\n                unenrollButton.onclick = ()=>$638425cc06b147b7$var$confirmUnenrollment(userId, userName, course.id, course.title);\n                listItem.appendChild(unenrollButton);\n                userCoursesList.append(listItem);\n            });\n        } else {\n            userCoursesList.innerHTML = '<li class=\"list-group-item text-danger\">\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0438 \\u043A\\u0443\\u0440\\u0441\\u043E\\u0432.</li>';\n            console.error('Failed to load user courses:', data.error);\n        }\n    } catch (e) {\n        userCoursesList.innerHTML = '<li class=\"list-group-item text-danger\">\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0441\\u0435\\u0440\\u0432\\u0435\\u0440\\u0430.</li>';\n        console.error('Network error loading user courses:', e);\n    }\n}\nfunction $638425cc06b147b7$var$confirmUnenrollment(userId, userName, courseId, courseTitle) {\n    const message = `\\u{412}\\u{44B} \\u{443}\\u{432}\\u{435}\\u{440}\\u{435}\\u{43D}\\u{44B}, \\u{447}\\u{442}\\u{43E} \\u{445}\\u{43E}\\u{442}\\u{438}\\u{442}\\u{435} \\u{43E}\\u{442}\\u{43F}\\u{438}\\u{441}\\u{430}\\u{442}\\u{44C} \\u{43F}\\u{43E}\\u{43B}\\u{44C}\\u{437}\\u{43E}\\u{432}\\u{430}\\u{442}\\u{435}\\u{43B}\\u{44F} \"${userName}\" \\u{43E}\\u{442} \\u{43A}\\u{443}\\u{440}\\u{441}\\u{430} \"${courseTitle}\"?`;\n    if (confirm(message)) $638425cc06b147b7$var$unenrollRequest(userId, courseId, userName);\n}\nasync function $638425cc06b147b7$var$unenrollRequest(userId, courseId, userName) {\n    const requestData = {\n        userId: userId,\n        courseId: courseId\n    };\n    try {\n        const response = await fetch('/admin/user/unenroll', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify(requestData)\n        });\n        const result = await response.json();\n        if (response.ok && result.success) {\n            alert(result.message);\n            // Обновляем список курсов в модальном окне\n            await $638425cc06b147b7$var$refreshUserCoursesList(userId, userName);\n        } else showAlert(`\\u{41E}\\u{448}\\u{438}\\u{431}\\u{43A}\\u{430}: ${result.message || \"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u043E\\u0442\\u043F\\u0438\\u0441\\u0430\\u0442\\u044C \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F.\"}`, 'error');\n    } catch (e) {\n        showAlert(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0441\\u0435\\u0440\\u0432\\u0435\\u0440\\u0430\", 'error');\n        console.error(e);\n    }\n}\n// Инициализация\ndocument.addEventListener('DOMContentLoaded', function() {\n    // Загружаем пользователей при загрузке страницы\n    const usersTab = document.getElementById('users-tab');\n    if (usersTab) $638425cc06b147b7$var$loadUsers(1, $638425cc06b147b7$var$usersPerPage, $638425cc06b147b7$var$roleFilter);\n});\n// Expose functions to global scope for onclick attributes\nwindow.loadUsers = $638425cc06b147b7$var$loadUsers;\nwindow.deleteUser = $638425cc06b147b7$var$deleteUser;\nwindow.openEnrollModal = $638425cc06b147b7$var$openEnrollModal;\nwindow.confirmEnrollment = $638425cc06b147b7$var$confirmEnrollment;\nwindow.openViewCoursesModal = $638425cc06b147b7$var$openViewCoursesModal;\nwindow.confirmUnenrollment = $638425cc06b147b7$var$confirmUnenrollment;\nwindow.unenrollRequest = $638425cc06b147b7$var$unenrollRequest;\nwindow.changeUsersPage = $638425cc06b147b7$var$changeUsersPage;\nwindow.currentPageUsers = $638425cc06b147b7$var$currentPageUsers;\nwindow.rowsInUserTable = $638425cc06b147b7$var$rowsInUserTable;\nwindow.filterByUserRole = $638425cc06b147b7$var$filterByUserRole;\nwindow.refreshUsersTable = function() {\n    $638425cc06b147b7$var$loadUsers($638425cc06b147b7$var$currentPageUsers, $638425cc06b147b7$var$usersPerPage, $638425cc06b147b7$var$roleFilter);\n};\n\n\nlet $b280201063cd81bd$var$currentDocsPage = 1;\nlet $b280201063cd81bd$var$totalDocsPages = 1;\nlet $b280201063cd81bd$var$totalDocsItems = 0;\nlet $b280201063cd81bd$var$docsPerPage = 5;\nlet $b280201063cd81bd$var$currentSortBy = 'id'; // Default sort by ID\nlet $b280201063cd81bd$var$currentSortDir = 'asc'; // Default sort direction ascending\nasync function $b280201063cd81bd$var$loadCoursesForFilter() {\n    try {\n        const response = await fetch('/admin/documents/courses');\n        if (!response.ok) return null;\n        const result = await response.json();\n        console.log(result);\n        if (result.success && result.data) {\n            const select = document.getElementById('courseFilterSelect');\n            if (!select) return;\n            const currentFilter = select.value;\n            select.innerHTML = '<option value=\"\">\\u0412\\u0441\\u0435 \\u043A\\u0443\\u0440\\u0441\\u044B</option>';\n            result.data.forEach((course)=>{\n                const option = document.createElement('option');\n                option.value = course.id;\n                option.textContent = course.title;\n                select.appendChild(option);\n            });\n            if (currentFilter) select.value = currentFilter;\n        } else return null;\n    } catch (error) {\n        showAlert(\"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0444\\u0438\\u043B\\u044C\\u0442\\u0440 \\u043A\\u0443\\u0440\\u0441\\u043E\\u0432.\", 'warning');\n    }\n}\nasync function $b280201063cd81bd$var$loadCategoriesForFilter() {\n    try {\n        const response = await fetch('/admin/documents/categories');\n        if (!response.ok) return null;\n        const result = await response.json();\n        console.log(result);\n        if (result.success && result.data) {\n            const select = document.getElementById('categoryFilterSelect');\n            if (!select) return;\n            const currentFilter = select.value;\n            select.innerHTML = '<option value=\"\">\\u0412\\u0441\\u0435 \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0438</option>';\n            result.data.forEach((category)=>{\n                const option = document.createElement('option');\n                option.value = category.id;\n                option.textContent = category.name;\n                select.appendChild(option);\n            });\n            if (currentFilter) select.value = currentFilter;\n        } else return null;\n    } catch (error) {\n        showAlert(\"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0444\\u0438\\u043B\\u044C\\u0442\\u0440 \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0439.\", 'warning');\n    }\n}\nasync function $b280201063cd81bd$var$loadDocuments(page = 1) {\n    console.log('loadDocuments called. Current docsPerPage:', $b280201063cd81bd$var$docsPerPage);\n    try {\n        $b280201063cd81bd$var$showLoading(true);\n        const courseId = document.getElementById('courseFilterSelect')?.value || '';\n        const categoryId = document.getElementById('categoryFilterSelect')?.value || '';\n        let url = `/admin/documents?page=${page}&size=${$b280201063cd81bd$var$docsPerPage}`;\n        if (courseId) {\n            url += `&courseId=${courseId}`;\n            console.log('Filtering by Course ID:', courseId);\n        }\n        if (categoryId) {\n            url += `&categoryId=${categoryId}`;\n            console.log('Filtering by Category ID:', categoryId);\n        }\n        console.log('Fetching documents from URL:', url);\n        const response = await fetch(url);\n        if (response.ok) {\n            const result = await response.json();\n            console.log('Documents API Response:', result);\n            if (result.success && result.data) {\n                const paginatedData = result.data;\n                console.log('Paginated Data Content:', paginatedData.content);\n                $b280201063cd81bd$var$currentDocsPage = paginatedData.currentPage || page;\n                $b280201063cd81bd$var$totalDocsPages = paginatedData.totalPages || 1;\n                $b280201063cd81bd$var$totalDocsItems = paginatedData.totalItems || 0;\n                $b280201063cd81bd$var$renderDocumentsTable(paginatedData.content);\n                $b280201063cd81bd$var$renderDocumentsPagination(paginatedData.content);\n            } else showAlert(result.message || \"\\u041D\\u0435\\u0432\\u0435\\u0440\\u043D\\u044B\\u0439 \\u0444\\u043E\\u0440\\u043C\\u0430\\u0442 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445\", 'error');\n        } else {\n            if (response.status === 404) {\n                $b280201063cd81bd$var$renderDocumentsTable([]);\n                $b280201063cd81bd$var$renderDocumentsPagination([]);\n            } else return null;\n        }\n    } catch (error) {\n        showAlert(error.message, 'error');\n    } finally{\n        $b280201063cd81bd$var$showLoading(false);\n    }\n}\nfunction $b280201063cd81bd$var$renderDocumentsTable(documents) {\n    const container = document.getElementById('documentsContainer');\n    if (!container) return;\n    container.innerHTML = '';\n    const tableWrapper = document.createElement('div');\n    tableWrapper.className = 'documents-table-container';\n    tableWrapper.innerHTML = `\n        <div class=\"data-table documents-table\">\n            <div class=\"table-header d-flex justify-content-between align-items-center flex-wrap\">\n                <h3 class=\"table-title mb-2 mb-md-0\">\\u{421}\\u{43F}\\u{438}\\u{441}\\u{43E}\\u{43A} \\u{434}\\u{43E}\\u{43A}\\u{443}\\u{43C}\\u{435}\\u{43D}\\u{442}\\u{43E}\\u{432}</h3>\n            </div>\n\n            <div class=\"table-content\">\n                <div class=\"table-row header-row\">\n                    <div class=\"table-cell\">ID</div>\n                    <div class=\"table-cell\">\\u{41D}\\u{430}\\u{437}\\u{432}\\u{430}\\u{43D}\\u{438}\\u{435}</div>\n                    <div class=\"table-cell\">\\u{41A}\\u{443}\\u{440}\\u{441}</div>\n                    <div class=\"table-cell\">\\u{41A}\\u{430}\\u{442}\\u{435}\\u{433}\\u{43E}\\u{440}\\u{438}\\u{44F}</div>\n                    <div class=\"table-cell\">\\u{422}\\u{435}\\u{433}\\u{438}</div>\n                    <div class=\"table-cell\">\\u{414}\\u{435}\\u{439}\\u{441}\\u{442}\\u{432}\\u{438}\\u{44F}</div>\n                </div>\n\n                ${documents.length > 0 ? documents.map((doc)=>`\n                <div class=\"table-row\">\n                    <div class=\"table-cell text-muted\">#${doc.id || 'N/A'}</div>\n                    <div class=\"table-cell\">\n                        <div class=\"fw-bold\">${$b280201063cd81bd$var$escapeHtml(doc.name || \"\\u0411\\u0435\\u0437 \\u043D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u044F\")}</div>\n                    </div>\n                    <div class=\"table-cell\">\n                        <span class=\"text-muted\">${$b280201063cd81bd$var$escapeHtml(doc.courseName || 'N/A')}</span>\n                    </div>\n                    <div class=\"table-cell\">\n                        <span class=\"text-muted\">${$b280201063cd81bd$var$escapeHtml(doc.categoryName || 'N/A')}</span>\n                    </div>\n                    <div class=\"table-cell\">\n                        <span class=\"text-muted\">${$b280201063cd81bd$var$truncateText(doc.tags || \"\\u041D\\u0435\\u0442 \\u0442\\u0435\\u0433\\u043E\\u0432\", 50)}</span>\n                    </div>\n                    <div class=\"table-cell action-buttons\">\n                        ${doc.file ? `<a href=\"/docs/${doc.file}\" class=\"btn btn-success btn-icon btn-sm\" title=\"\\u{41E}\\u{442}\\u{43A}\\u{440}\\u{44B}\\u{442}\\u{44C} \\u{444}\\u{430}\\u{439}\\u{43B}\" target=\"_blank\"><i class=\"bi bi-eye\"></i></a>` : ''}\n                        <button class=\"btn btn-info btn-icon btn-sm edit-doc-btn\" title=\"\\u{420}\\u{435}\\u{434}\\u{430}\\u{43A}\\u{442}\\u{438}\\u{440}\\u{43E}\\u{432}\\u{430}\\u{442}\\u{44C}\" data-doc-id=\"${doc.id}\">\n                            <i class=\"bi bi-pencil\"></i>\n                        </button>\n                        <button class=\"btn btn-danger btn-icon btn-sm\" title=\"\\u{423}\\u{434}\\u{430}\\u{43B}\\u{438}\\u{442}\\u{44C}\"\n                                onclick=\"deleteDocument(${doc.id}, '${$b280201063cd81bd$var$escapeHtml(doc.name)}')\">\n                            <i class=\"bi bi-trash\"></i>\n                        </button>\n                    </div>\n                </div>\n                `).join('') : `\n                <div class=\"table-row\">\n                    <div class=\"table-cell\" style=\"grid-column: 1 / -1; text-align: center; padding: 2rem; color: #94a3b8;\">\n                        <i class=\"bi bi-file-earmark-text me-2\"></i>\n                        \\u{414}\\u{43E}\\u{43A}\\u{443}\\u{43C}\\u{435}\\u{43D}\\u{442}\\u{44B} \\u{43D}\\u{435} \\u{43D}\\u{430}\\u{439}\\u{434}\\u{435}\\u{43D}\\u{44B}. \\u{418}\\u{437}\\u{43C}\\u{435}\\u{43D}\\u{438}\\u{442}\\u{435} \\u{444}\\u{438}\\u{43B}\\u{44C}\\u{442}\\u{440} \\u{438}\\u{43B}\\u{438} \\u{434}\\u{43E}\\u{431}\\u{430}\\u{432}\\u{44C}\\u{442}\\u{435} \\u{43D}\\u{43E}\\u{432}\\u{44B}\\u{439} \\u{434}\\u{43E}\\u{43A}\\u{443}\\u{43C}\\u{435}\\u{43D}\\u{442}.\n                    </div>\n                </div>\n                `}\n            </div>\n        </div>\n    `;\n    container.appendChild(tableWrapper);\n}\nfunction $b280201063cd81bd$var$renderDocumentsPagination(documents) {\n    console.log('Rendering documents pagination with:', documents);\n    const container = document.getElementById('documentsPagination');\n    if (!container) return;\n    if ($b280201063cd81bd$var$totalDocsPages <= 1) {\n        container.innerHTML = '';\n        return;\n    }\n    let paginationHTML = `\n        <nav aria-label=\"Page navigation\">\n            <ul class=\"pagination justify-content-center\">\n                <li class=\"page-item ${$b280201063cd81bd$var$currentDocsPage === 1 ? 'disabled' : ''}\">\n                    <a class=\"page-link\" href=\"#\" onclick=\"changeDocsPage(${$b280201063cd81bd$var$currentDocsPage - 1}); return false;\">&laquo;</a>\n                </li>\n    `;\n    const maxVisiblePages = 5;\n    let startPage = Math.max(1, $b280201063cd81bd$var$currentDocsPage - Math.floor(maxVisiblePages / 2));\n    let endPage = Math.min($b280201063cd81bd$var$totalDocsPages, startPage + maxVisiblePages - 1);\n    if (endPage - startPage + 1 < maxVisiblePages) startPage = Math.max(1, endPage - maxVisiblePages + 1);\n    if (startPage > 1) {\n        paginationHTML += `<li class=\"page-item\"><a class=\"page-link\" href=\"#\" onclick=\"changeDocsPage(1); return false;\">1</a></li>`;\n        if (startPage > 2) paginationHTML += `<li class=\"page-item disabled\"><span class=\"page-link\">...</span></li>`;\n    }\n    for(let i = startPage; i <= endPage; i++)paginationHTML += `<li class=\"page-item ${i === $b280201063cd81bd$var$currentDocsPage ? 'active' : ''}\"><a class=\"page-link\" href=\"#\" onclick=\"changeDocsPage(${i}); return false;\">${i}</a></li>`;\n    if (endPage < $b280201063cd81bd$var$totalDocsPages) {\n        if (endPage < $b280201063cd81bd$var$totalDocsPages - 1) paginationHTML += `<li class=\"page-item disabled\"><span class=\"page-link\">...</span></li>`;\n        paginationHTML += `<li class=\"page-item\"><a class=\"page-link\" href=\"#\" onclick=\"changeDocsPage(${$b280201063cd81bd$var$totalDocsPages}); return false;\">${$b280201063cd81bd$var$totalDocsPages}</a></li>`;\n    }\n    paginationHTML += `\n                <li class=\"page-item ${$b280201063cd81bd$var$currentDocsPage === $b280201063cd81bd$var$totalDocsPages ? 'disabled' : ''}\">\n                    <a class=\"page-link\" href=\"#\" onclick=\"changeDocsPage(${$b280201063cd81bd$var$currentDocsPage + 1}); return false;\">&raquo;</a>\n                </li>\n            </ul>\n        </nav>\n        \n        <div class=\"pagination-info text-center mt-2\">\n            <small class=\"text-muted\">\n                \\u{421}\\u{442}\\u{440}\\u{430}\\u{43D}\\u{438}\\u{446}\\u{430} ${$b280201063cd81bd$var$currentDocsPage} \\u{438}\\u{437} ${$b280201063cd81bd$var$totalDocsPages} \\u{2022} \\u{41F}\\u{43E}\\u{43A}\\u{430}\\u{437}\\u{430}\\u{43D}\\u{43E} ${documents.length} \\u{438}\\u{437} ${$b280201063cd81bd$var$totalDocsItems} \\u{434}\\u{43E}\\u{43A}\\u{443}\\u{43C}\\u{435}\\u{43D}\\u{442}\\u{43E}\\u{432}\n            </small>\n        </div>\n    `;\n    container.innerHTML = paginationHTML;\n}\nfunction $b280201063cd81bd$var$changeDocsPage(page) {\n    if (page < 1 || page > $b280201063cd81bd$var$totalDocsPages || page === $b280201063cd81bd$var$currentDocsPage) return;\n    $b280201063cd81bd$var$loadDocuments(page);\n}\nfunction $b280201063cd81bd$var$changeDocsPerPage(perPage) {\n    console.log('changeDocsPerPage called with:', perPage);\n    $b280201063cd81bd$var$docsPerPage = parseInt(perPage) || 10;\n    console.log('docsPerPage set to:', $b280201063cd81bd$var$docsPerPage);\n    $b280201063cd81bd$var$loadDocuments(1);\n}\nfunction $b280201063cd81bd$var$showLoading(show) {\n    const container = document.getElementById('documentsContainer');\n    if (!container) return;\n    if (show) container.innerHTML = `\n            <div class=\"d-flex justify-content-center align-items-center\" style=\"height: 200px;\">\n                <div class=\"spinner-border text-primary\" role=\"status\">\n                    <span class=\"visually-hidden\">\\u{417}\\u{430}\\u{433}\\u{440}\\u{443}\\u{437}\\u{43A}\\u{430}...</span>\n                </div>\n            </div>\n        `;\n}\nfunction $b280201063cd81bd$var$truncateText(text, maxLength) {\n    if (!text || text.length <= maxLength) return $b280201063cd81bd$var$escapeHtml(text || '');\n    return $b280201063cd81bd$var$escapeHtml(text.substring(0, maxLength)) + '...';\n}\nfunction $b280201063cd81bd$var$escapeHtml(text) {\n    if (typeof text !== 'string') return '';\n    const div = document.createElement('div');\n    div.textContent = text;\n    return div.innerHTML;\n}\nasync function $b280201063cd81bd$var$deleteDocument(docId, docName) {\n    if (!confirm(`\\u{412}\\u{44B} \\u{443}\\u{432}\\u{435}\\u{440}\\u{435}\\u{43D}\\u{44B}, \\u{447}\\u{442}\\u{43E} \\u{445}\\u{43E}\\u{442}\\u{438}\\u{442}\\u{435} \\u{443}\\u{434}\\u{430}\\u{43B}\\u{438}\\u{442}\\u{44C} \\u{434}\\u{43E}\\u{43A}\\u{443}\\u{43C}\\u{435}\\u{43D}\\u{442} \"${docName}\"?`)) return;\n    try {\n        const headers = {\n            'Content-Type': 'application/json'\n        };\n        const response = await fetch(`/admin/documents/${docId}/delete`, {\n            method: 'DELETE',\n            headers: headers\n        });\n        const result = await response.json().catch(()=>({}));\n        if (response.ok && result.success) {\n            showAlert(`\\u{414}\\u{43E}\\u{43A}\\u{443}\\u{43C}\\u{435}\\u{43D}\\u{442} \"${docName}\" \\u{443}\\u{441}\\u{43F}\\u{435}\\u{448}\\u{43D}\\u{43E} \\u{443}\\u{434}\\u{430}\\u{43B}\\u{435}\\u{43D}.`, 'success');\n            $b280201063cd81bd$var$loadDocuments($b280201063cd81bd$var$currentDocsPage || 1);\n        } else {\n            const errorMessage = result.message || `\\u{41E}\\u{448}\\u{438}\\u{431}\\u{43A}\\u{430} \\u{443}\\u{434}\\u{430}\\u{43B}\\u{435}\\u{43D}\\u{438}\\u{44F}: ${response.status}`;\n            showAlert(errorMessage, 'error');\n        }\n    } catch (error) {\n        showAlert(error.message, 'error');\n    }\n}\nasync function $b280201063cd81bd$var$openCreateDocumentModal() {\n    const modalElement = document.getElementById('createDocumentModal');\n    if (!modalElement) {\n        console.error('Create document modal not found');\n        return;\n    }\n    const modal = new bootstrap.Modal(modalElement);\n    const form = document.getElementById('createDocumentForm');\n    form.reset();\n    const courseSelect = document.getElementById('docCourse');\n    const categorySelect = document.getElementById('docCategory');\n    // Reset and disable category select\n    categorySelect.innerHTML = '<option value=\"\">\\u0421\\u043D\\u0430\\u0447\\u0430\\u043B\\u0430 \\u0432\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u043A\\u0443\\u0440\\u0441</option>';\n    categorySelect.disabled = true;\n    // Load Courses\n    try {\n        const courseResponse = await fetch('/admin/documents/courses');\n        const courseResult = await courseResponse.json();\n        if (courseResult.success && courseResult.data) {\n            courseSelect.innerHTML = '<option value=\"\" disabled selected>\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u043A\\u0443\\u0440\\u0441</option>';\n            courseResult.data.forEach((course)=>{\n                const option = document.createElement('option');\n                option.value = course.id;\n                option.textContent = course.title;\n                courseSelect.appendChild(option);\n            });\n        } else courseSelect.innerHTML = '<option value=\"\">\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u043A\\u0443\\u0440\\u0441\\u044B</option>';\n    } catch (error) {\n        courseSelect.innerHTML = '<option value=\"\">\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0438</option>';\n    }\n    modal.show();\n}\nasync function $b280201063cd81bd$var$handleCourseChangeForModal(courseId) {\n    const categorySelect = document.getElementById('docCategory');\n    if (!courseId) {\n        categorySelect.innerHTML = '<option value=\"\">\\u0421\\u043D\\u0430\\u0447\\u0430\\u043B\\u0430 \\u0432\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u043A\\u0443\\u0440\\u0441</option>';\n        categorySelect.disabled = true;\n        return;\n    }\n    categorySelect.innerHTML = '<option value=\"\">\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0439...</option>';\n    categorySelect.disabled = false;\n    try {\n        const response = await fetch(`/admin/documents/categories?courseId=${courseId}`);\n        const result = await response.json();\n        if (result.success && result.data && result.data.length > 0) {\n            categorySelect.innerHTML = '<option value=\"\" disabled selected>\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u044E</option>';\n            result.data.forEach((category)=>{\n                const option = document.createElement('option');\n                option.value = category.id;\n                option.textContent = category.name;\n                categorySelect.appendChild(option);\n            });\n        } else categorySelect.innerHTML = '<option value=\"\">\\u041A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0438 \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\\u044B</option>';\n    } catch (error) {\n        categorySelect.innerHTML = '<option value=\"\">\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0438 \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0439</option>';\n    }\n}\nasync function $b280201063cd81bd$var$handleCreateDocumentSubmit(event) {\n    event.preventDefault();\n    const form = event.target;\n    const formData = new FormData(form);\n    const submitButton = form.closest('.modal-content').querySelector('button[type=\"submit\"]');\n    submitButton.disabled = true;\n    submitButton.innerHTML = '<span class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span> \\u0421\\u043E\\u0437\\u0434\\u0430\\u043D\\u0438\\u0435...';\n    try {\n        const response = await fetch('/admin/documents/create', {\n            method: 'POST',\n            body: formData\n        });\n        const result = await response.json();\n        if (response.ok && result.success) {\n            showAlert(\"\\u0414\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442 \\u0443\\u0441\\u043F\\u0435\\u0448\\u043D\\u043E \\u0441\\u043E\\u0437\\u0434\\u0430\\u043D!\", 'success');\n            const modal = bootstrap.Modal.getInstance(document.getElementById('createDocumentModal'));\n            modal.hide();\n            await $b280201063cd81bd$var$loadDocuments(1);\n        } else if (response.status === 400 && result.errors) {\n            let errorMessages = Object.values(result.errors).join(', ');\n            showAlert(`\\u{41E}\\u{448}\\u{438}\\u{431}\\u{43A}\\u{430} \\u{432}\\u{430}\\u{43B}\\u{438}\\u{434}\\u{430}\\u{446}\\u{438}\\u{438}: ${errorMessages}`, 'error');\n        } else showAlert(result.message || \"\\u041F\\u0440\\u043E\\u0438\\u0437\\u043E\\u0448\\u043B\\u0430 \\u043E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u043F\\u0440\\u0438 \\u0441\\u043E\\u0437\\u0434\\u0430\\u043D\\u0438\\u0438 \\u0434\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u0430.\", 'error');\n    } catch (error) {\n        showAlert(\"\\u0421\\u0435\\u0442\\u0435\\u0432\\u0430\\u044F \\u043E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0438\\u043B\\u0438 \\u043E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0441\\u0435\\u0440\\u0432\\u0435\\u0440\\u0430.\", 'error');\n    } finally{\n        submitButton.disabled = false;\n        submitButton.innerHTML = \"\\u0421\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C\";\n    }\n}\ndocument.addEventListener('DOMContentLoaded', function() {\n    const docsTabTrigger = document.querySelector('a[data-tab=\"docs-tab\"]');\n    if (docsTabTrigger) {\n        docsTabTrigger.addEventListener('click', function() {\n            setTimeout(()=>$b280201063cd81bd$var$loadDocuments(1), 10);\n        });\n        if (document.getElementById('docs-tab')?.classList.contains('active')) $b280201063cd81bd$var$loadDocuments(1);\n    }\n    const createDocumentForm = document.getElementById('createDocumentForm');\n    if (createDocumentForm) createDocumentForm.addEventListener('submit', $b280201063cd81bd$var$handleCreateDocumentSubmit);\n    if (document.getElementById('docs-tab')?.classList.contains('active')) {\n        $b280201063cd81bd$var$loadDocuments(1);\n        $b280201063cd81bd$var$loadCoursesForFilter();\n        $b280201063cd81bd$var$loadCategoriesForFilter();\n    }\n});\nwindow.loadDocuments = $b280201063cd81bd$var$loadDocuments;\nwindow.changeDocsPerPage = $b280201063cd81bd$var$changeDocsPerPage;\nwindow.changeDocsPage = $b280201063cd81bd$var$changeDocsPage;\nwindow.deleteDocument = $b280201063cd81bd$var$deleteDocument;\nwindow.loadCoursesForFilter = $b280201063cd81bd$var$loadCoursesForFilter;\nwindow.loadCategoriesForFilter = $b280201063cd81bd$var$loadCategoriesForFilter;\nwindow.openCreateDocumentModal = $b280201063cd81bd$var$openCreateDocumentModal;\nwindow.handleCourseChangeForModal = $b280201063cd81bd$var$handleCourseChangeForModal;\n\n\n\n})();\n//# sourceMappingURL=admin-bundle.js.map\n","import './admin.js';\r\nimport './admin-courses/adminAddCourse.js';\r\nimport './admin-courses/adminEditCourse.js';\r\nimport './admin-courses/getModulesOfCourse.js';\r\nimport './admin-lessons/admin-lesson-edit.js';\r\nimport './admin-lessons/createLesson.js';\r\nimport './admin-lessons/generateTest.js';\r\nimport './admin-lessons/getLessons.js';\r\nimport './admin-module/admin-module-edit.js';\r\nimport './admin-module/adminCreateModule.js';\r\nimport './admin-module/adminDeleteModule.js';\r\nimport './admin-module/adminUpdateModuleStatus.js';\r\nimport './admin-module/getModuleLessons.js';\r\nimport './admin-module/getModules.js';\r\nimport './admin-offers/deleteOffer.js';\r\nimport './admin-offers/getOffers.js';\r\nimport './admin-offers/reponseOffer.js';\r\nimport './admin-users/editUser.js';\r\nimport './admin-users/getUsers.js';\r\nimport './admin-docs/getDocuments.js'","// Original content of admin.js\nasync function getOfferDescription(offerId) {\n    try {\n        const response = await fetch(`/admin/offers/${offerId}`, {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json'\n            }\n        });\n\n        if (!response.ok) {\n            throw new Error(`Ошибка HTTP: ${response.status}`);\n        }\n\n        const offerData = await response.json();\n\n        \n        populateModal(offerData);\n\n    } catch (error) {\n        console.error('Ошибка при получении данных заявки:', error);\n        alert('Не удалось загрузить данные заявки');\n    }\n}\n\n// Заполнение модального окна данными\nfunction populateModal(offerData) {\n    $('#offerTitle').text(`Просмотр информации по заявке ${offerData.userId}`);\n    $('#offerTopic').text(offerData.topic);\n    $('#offerDescriptionBody').text(offerData.description)\n\n    // Показываем модальное окно\n    const modal = new bootstrap.Modal(document.getElementById('offerContentModal'));\n    modal.show();\n}\n\n// Обработчик события для закрытия модального окна\ndocument.getElementById('offerContentModal').addEventListener('hidden.bs.modal', function () {\n    // Очищаем поля при закрытии\n    document.getElementById('modalUserId').textContent = '';\n    document.getElementById('modalTopic').textContent = '';\n    document.getElementById('modalDescription').textContent = '';\n});\nfunction switchToView(viewType) {\n    $('.view-content').addClass('d-none')\n    $(`.${viewType}`).removeClass('d-none')\n}\n\nwindow.getOfferDescription = getOfferDescription;\nwindow.switchToView = switchToView;","document.addEventListener('DOMContentLoaded', function() {\n    const form = document.getElementById('addCourseForm');\n    const descriptionTextarea = document.getElementById('courseDescription');\n    const charCount = document.getElementById('charCount');\n    const uploadPlaceholder = document.getElementById('uploadPlaceholder');\n    const fileInput = document.getElementById('courseImage');\n    const imagePreview = document.getElementById('imagePreview');\n    const removeImageBtn = document.getElementById('removeImage');\n    const courseTitle = document.getElementById('courseTitle');\n    const courseSlug = document.getElementById('courseSlug');\n\n    // Счетчик символов для описания\n    descriptionTextarea.addEventListener('input', function() {\n    const length = this.value.length;\n    charCount.textContent = length;\n\n    if (length > 1900) {\n    charCount.classList.add('text-warning');\n} else {\n    charCount.classList.remove('text-warning');\n}\n});\n\n    // Загрузка изображения\n    uploadPlaceholder.addEventListener('click', function() {\n    fileInput.click();\n});\n\n    fileInput.addEventListener('change', function(e) {\n    if (this.files && this.files[0]) {\n    const file = this.files[0];\n\n    // Проверка размера файла\n    if (file.size > 5 * 1024 * 1024) {\n    showAlert('Файл слишком большой. Максимальный размер: 5MB', 'error');\n    this.value = '';\n    return;\n}\n\n    // Показ превью\n    const reader = new FileReader();\n    reader.onload = function(e) {\n    imagePreview.querySelector('img').src = e.target.result;\n    imagePreview.style.display = 'block';\n    uploadPlaceholder.style.display = 'none';\n}\n    reader.readAsDataURL(file);\n}\n});\n\n    // Удаление изображения\n    removeImageBtn.addEventListener('click', function() {\n    fileInput.value = '';\n    imagePreview.style.display = 'none';\n    uploadPlaceholder.style.display = 'block';\n});\n\n    // --- Slug Generation Logic ---\n    let isSlugManuallyEdited = false;\n\n    if (courseTitle && courseSlug) {\n        // Generate slug as user types in the title field\n        courseTitle.addEventListener('input', () => {\n            if (!isSlugManuallyEdited) {\n                generateSlugFromTitle();\n            }\n        });\n\n        // Detect when user edits the slug field manually to disable auto-generation\n        courseSlug.addEventListener('input', () => {\n            isSlugManuallyEdited = true;\n        });\n    }\n\n    function generateSlugFromTitle() {\n        const title = courseTitle.value.trim();\n        if (title) {\n            const translitMap = {\n                'а': 'a', 'б': 'b', 'в': 'v', 'г': 'g', 'д': 'd', 'е': 'e', 'ё': 'yo', 'ж': 'zh',\n                'з': 'z', 'и': 'i', 'й': 'y', 'к': 'k', 'л': 'l', 'м': 'm', 'н': 'n', 'о': 'o',\n                'п': 'p', 'р': 'r', 'с': 's', 'т': 't', 'у': 'u', 'ф': 'f', 'х': 'h', 'ц': 'ts',\n                'ч': 'ch', 'ш': 'sh', 'щ': 'shch', 'ъ': '', 'ы': 'y', 'ь': '', 'э': 'e', 'ю': 'yu', 'я': 'ya'\n            };\n\n            let slug = title.toLowerCase();\n            let result = '';\n            for (let i = 0; i < slug.length; i++) {\n                result += translitMap[slug[i]] || slug[i];\n            }\n\n            slug = result\n                .replace(/['\"’]/g, '')      // remove quotes\n                .replace(/\\s+/g, '-')       // collapse whitespace and replace by -\n                .replace(/[^a-z0-9-]/g, '') // remove invalid chars\n                .replace(/-+/g, '-')        // collapse dashes\n                .replace(/^-|-$/g, '');     // trim - from start or end\n\n            courseSlug.value = slug;\n        }\n    }\n    // --- End Slug Generation Logic ---\n\n    // Функция очистки формы\n    window.resetForm = function() {\n    form.reset();\n    form.classList.remove('was-validated');\n    charCount.textContent = '0';\n    fileInput.value = '';\n    imagePreview.style.display = 'none';\n    uploadPlaceholder.style.display = 'block';\n};\n\n    // --- Form Submission Logic ---\n    form.addEventListener('submit', async function(event) {\n        // 1. Предотвращаем стандартную отправку формы\n        event.preventDefault();\n        event.stopPropagation();\n\n        // 2. Проверяем валидность формы с помощью Bootstrap\n        if (!form.checkValidity()) {\n            form.classList.add('was-validated');\n            return;\n        }\n\n        // Дополнительная проверка на наличие файла\n        if (fileInput.files.length === 0) {\n            showAlert('Пожалуйста, выберите изображение для курса.', 'error');\n            return;\n        }\n\n        const submitButton = form.querySelector('button[type=\"submit\"]');\n        const originalButtonText = submitButton.innerHTML;\n\n        try {\n            // 3. Показываем индикатор загрузки\n            submitButton.disabled = true;\n            submitButton.innerHTML = '<span class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span> Создание...';\n\n            // 4. Собираем данные формы с помощью FormData\n            const formData = new FormData(form);\n\n            // 5. Отправляем данные на сервер\n            const response = await fetch('/admin/course/create', {\n                method: 'POST',\n                body: formData\n            });\n\n            // 6. Обрабатываем ответ\n            if (response.status === 201) { // 201 Created\n                showAlert('Курс успешно создан!', 'success');\n                window.resetForm(); // Используем уже существующую функцию для очистки\n            } else {\n                const errorData = await response.json();\n                const errorMessage = errorData.error || Object.values(errorData).join(', ');\n               return null;\n            }\n\n        } catch (error) {\n            showAlert(`Ошибка: ${error.message}`, 'error');\n        } finally {\n            // 7. Возвращаем кнопку в исходное состояние\n            submitButton.disabled = false;\n            submitButton.innerHTML = originalButtonText;\n        }\n    });\n});","let currentPage = 1;\nlet totalPages = 1;\nlet totalItems = 0;\nlet coursesPerPage = 10; // Default courses per page\n\n// --- NEW: Function to switch to the Add Course tab ---\nfunction openAddCourseForm() {\n    const tabLink = document.querySelector('a[data-tab=\"courses-add-tab\"]');\n    if (tabLink) {\n        tabLink.click();\n    } else {\n        showAlert('Не удалось найти вкладку для добавления курса', 'error');\n    }\n}\n\n// --- MODIFIED: Renamed for consistency ---\nfunction changeCoursesPerPage(perPage) {\n    coursesPerPage = parseInt(perPage) || 10;\n    void loadCourses(1);\n}\n\nasync function loadCourses(page = 1) {\n    try {\n        const response = await fetch(`/admin/courses?page=${page}&size=${coursesPerPage}`);\n        if (!response.ok) {\n            return null;\n        }\n        \n        const data = await response.json();\n        if (!data.success || !data.data || !data.data.content) {\n            return null;\n        }\n\n        currentPage = data.data[\"currentPage\"] || page;\n        totalPages = data.data[\"totalPages\"] || 1;\n        totalItems = data.data[\"totalItems\"] || data.data.content.length;\n\n        renderCoursesTable(data.data.content);\n        renderPagination();\n\n    } catch (e) {\n        showAlert(`Ошибка загрузки курсов ${e}`, 'error')\n    }\n}\n\nasync function deleteCourse(courseId, courseTitle) {\n    if (!confirm(`Вы уверены, что хотите удалить курс \"${courseTitle}\"? Это действие удалит все модули и уроки этого курса, и его нельзя будет отменить.`)) {\n        return null;\n    }\n\n    try {\n        const headers = { 'Content-Type': 'application/json' };\n\n        const response = await fetch(`/admin/courses/${courseId}/delete`, {\n            method: 'DELETE',\n            headers: headers\n        });\n\n        const result = await response.json().catch(() => ({}));\n\n        if (response.ok) {\n            showAlert(`Курс \"${courseTitle}\" успешно удален!`, 'success');\n            setTimeout(()=>{\n                loadCourses(currentPage || 1);\n            }, 1500)\n\n        } else {\n            return null;\n        }\n\n    } catch (error) {\n        showAlert(`Ошибка удаления: ${error.message}`, 'error');\n    }\n}\n\n// --- MODIFIED: renderCoursesTable with new header ---\nfunction renderCoursesTable(courses) {\n    const tableContainer = document.querySelector('#courses-edit-tab .card-body');\n    if (!tableContainer) {\n        return;\n    }\n\n    tableContainer.innerHTML = ''; // Clear previous content\n\n    tableContainer.innerHTML = `\n        <div class=\"data-table courses-table\">\n            <div class=\"table-header d-flex justify-content-between align-items-center flex-wrap\">\n                <h3 class=\"table-title mb-2 mb-md-0\">Список курсов</h3>\n                <div class=\"d-flex align-items-center gap-2 flex-wrap\">\n                    <div class=\"page-size-selector\">\n                        <div class=\"input-group input-group-sm\">\n                            <span class=\"input-group-text\">Отображать</span>\n                            <select class=\"form-select\" id=\"pageSizeSelect\" onchange=\"changeCoursesPerPage(this.value)\">\n                                <option value=\"5\">5</option>\n                                <option value=\"10\">10</option>\n                                <option value=\"20\">20</option>\n                                <option value=\"50\">50</option>\n                            </select>\n                        </div>\n                    </div>\n                    <button class=\"btn btn-primary btn-sm\" onclick=\"openAddCourseForm()\">\n                        <i class=\"bi bi-plus-circle me-1\"></i>Новый курс\n                    </button>\n                </div>\n            </div>\n\n            <div class=\"table-content\">\n                <div class=\"table-row header-row\">\n                    <div class=\"table-cell\">ID</div>\n                    <div class=\"table-cell\">Изображение</div>\n                    <div class=\"table-cell\">Название</div>\n                    <div class=\"table-cell\">Описание</div>\n                    <div class=\"table-cell\">URI</div>\n                    <div class=\"table-cell\">Статус</div>\n                    <div class=\"table-cell\">Создан</div>\n                    <div class=\"table-cell\">Обновлен</div>\n                    <div class=\"table-cell\">Действия</div>\n                </div>\n\n                ${courses.length > 0 ? courses.map(course => `\n                <div class=\"table-row\" id=\"course-row-${course.id}\">\n                    <div class=\"table-cell text-muted\">#${course.id || 'N/A'}</div>\n                    <div class=\"table-cell\">\n                        <img src=\"/img/course-brand/${course.image}\" alt=\"Изображение курса\"\n                             class=\"course-image\" data-image-name=\"${course.image}\" onclick=\"openViewCourseImageModal('${course.image}')\" style=\"cursor: pointer\">\n                    </div>\n                    <div class=\"table-cell\">\n                        <div class=\"fw-bold\">${course.title || 'N/A'}</div>\n                    </div>\n                    <div class=\"table-cell\">\n                        <span class=\"course-description\">${course.description || 'N/A'}</span>\n                    </div>\n                    <div class=\"table-cell\">\n                        ${getActiveLinks(course)}\n                    </div>\n                    <div class=\"table-cell\" data-course-id=\"${course.id}\">\n                    ${adaptiveCourseStatus(course.status, course.id)}\n                    </div>\n                    <div class=\"table-cell text-sm text-muted\">${formatCourseDate(course[\"createdAt\"])}</div>\n                    <div class=\"table-cell text-sm text-muted\">${formatCourseDate(course[\"updatedAt\"])}</div>\n                    <div class=\"table-cell action-buttons\">\n                        <button class=\"btn btn-primary btn-icon btn-sm\" title=\"Редактировать\" onclick=\"openEditCourseModal(${course.id})\">\n                            <i class=\"bi bi-pencil\"></i>\n                        </button>\n                        <button class=\"btn btn-primary btn-icon btn-sm\" title=\"Модули\" onclick=\"showCourseModules(${course.id}, '${course.title}')\">\n                            М\n                        </button>\n                        <button class=\"btn btn-danger btn-icon btn-sm\" title=\"Удалить\" onclick=\"deleteCourse(${course.id}, '${course.title}')\">\n                            <i class=\"bi bi-trash\"></i>\n                        </button>\n                    </div>\n                </div>\n                `).join('') : `\n                <div class=\"table-row\">\n                    <div class=\"table-cell\" style=\"grid-column: 1 / -1; text-align: center; padding: 2rem; color: #94a3b8;\">\n                        <i class=\"bi bi-journal-x me-2\"></i>\n                        Курсы не найдены\n                    </div>\n                </div>\n                `}\n            </div>\n        </div>\n\n        <div class=\"pagination-container-edit-course mt-3\"></div>\n    `;\n    document.getElementById('pageSizeSelect').value = coursesPerPage;\n\n    const dropdownToggleElements = tableContainer.querySelectorAll('[data-bs-toggle=\"dropdown\"]');\n    dropdownToggleElements.forEach(dropdownToggleEl => {\n        new bootstrap.Dropdown(dropdownToggleEl);\n    });\n\n    // Force overflow to be visible on table cells to prevent dropdown clipping\n    const tableCells = tableContainer.querySelectorAll('.table-cell');\n    tableCells.forEach(cell => {\n        cell.style.overflow = 'visible';\n    });\n}\n\nfunction getActiveLinks(course) {\n    return course.status === 'ACTIVE'? `<code class=\"click-for-redirect\" style=\"cursor: pointer\">/course/${course.slug}</code>`\n        : `<p>Невозможно просмотреть курс</p>`;\n}\n\nfunction adaptiveCourseStatus(status, courseId) {\n    const statusMap = {\n        'ACTIVE': { text: 'Активный', bg: 'success' },\n        'INACTIVE': { text: 'Неактивный', bg: 'secondary' },\n        'ARCHIVED': { text: 'В архиве', bg: 'dark' }\n    };\n\n    const currentStatusInfo = statusMap[status] || { text: 'Неизвестно', bg: 'light' };\n\n    const dropdownItems = Object.keys(statusMap).map(s => {\n        if (s === status) return '';\n        const newStatusInfo = statusMap[s];\n        return `<li><a class=\"dropdown-item\" href=\"#\" onclick=\"event.preventDefault(); updateCourseStatus(${courseId}, '${currentStatusInfo.text}', '${s}', '${newStatusInfo.text}')\">${newStatusInfo.text}</a></li>`;\n    }).join('');\n\n    return `\n        <div class=\"dropdown\">\n            <button class=\"btn btn-sm dropdown-toggle badge rounded-pill text-bg-${currentStatusInfo.bg}\" type=\"button\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\">\n                ${currentStatusInfo.text}\n            </button>\n            <ul class=\"dropdown-menu\">\n                ${dropdownItems}\n            </ul>\n        </div>\n    `;\n}\n\nasync function updateCourseStatus(courseId, currentStatusText, newStatus, newStatusText) {\n    if (!confirm(`Вы уверены, что хотите изменить статус курса с \"${currentStatusText}\" на \"${newStatusText}\"?`)) {\n        return;\n    }\n\n    const headers = {\n        'Content-Type': 'application/json'\n    };\n\n    try {\n        const response = await fetch(`/admin/courses/update/status`, {\n            method: 'POST',\n            headers: headers,\n            body: JSON.stringify({ courseId: courseId, status: newStatus })\n        });\n\n        const result = await response.json().catch(() => ({}));\n\n        if (response.ok && result.success) {\n            showAlert(`Статус курса успешно изменен на \"${newStatusText}\"!`, 'success');\n            await loadCourses(currentPage);\n        } else {\n            const errorMessage = result.error || `Ошибка сервера: ${response.status}`;\n            throw new Error(errorMessage);\n        }\n    } catch (error) {\n        showAlert(error.message, 'error');\n    }\n}\n\nfunction renderPagination() {\n    const paginationContainer = document.querySelector('.pagination-container-edit-course');\n    if (!paginationContainer) return;\n\n    if (totalPages <= 1) {\n        paginationContainer.innerHTML = '';\n        return;\n    }\n\n    let paginationHTML = `\n        <nav aria-label=\"Page navigation\">\n            <ul class=\"pagination justify-content-center\">\n                <li class=\"page-item ${currentPage === 1 ? 'disabled' : ''}\">\n                    <a class=\"page-link\" href=\"#\" onclick=\"changePage(${currentPage - 1}); return false;\">&laquo;</a>\n                </li>\n    `;\n\n    const maxVisiblePages = 5;\n    let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));\n    let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);\n\n    if (endPage - startPage + 1 < maxVisiblePages) {\n        startPage = Math.max(1, endPage - maxVisiblePages + 1);\n    }\n\n    if (startPage > 1) {\n        paginationHTML += `<li class=\"page-item\"><a class=\"page-link\" href=\"#\" onclick=\"changePage(1); return false;\">1</a></li>`;\n        if (startPage > 2) paginationHTML += `<li class=\"page-item disabled\"><span class=\"page-link\">...</span></li>`;\n    }\n\n    for (let i = startPage; i <= endPage; i++) {\n        paginationHTML += `<li class=\"page-item ${i === currentPage ? 'active' : ''}\"><a class=\"page-link\" href=\"#\" onclick=\"changePage(${i}); return false;\">${i}</a></li>`;\n    }\n\n    if (endPage < totalPages) {\n        if (endPage < totalPages - 1) paginationHTML += `<li class=\"page-item disabled\"><span class=\"page-link\">...</span></li>`;\n        paginationHTML += `<li class=\"page-item\"><a class=\"page-link\" href=\"#\" onclick=\"changePage(${totalPages}); return false;\">${totalPages}</a></li>`;\n    }\n\n    paginationHTML += `\n                <li class=\"page-item ${currentPage === totalPages ? 'disabled' : ''}\">\n                    <a class=\"page-link\" href=\"#\" onclick=\"changePage(${currentPage + 1}); return false;\">&raquo;</a>\n                </li>\n            </ul>\n        </nav>\n        <div class=\"pagination-info text-center mt-2\">\n            <small class=\"text-muted\">Страница ${currentPage} из ${totalPages} • Всего курсов: ${totalItems}</small>\n        </div>\n    `;\n\n    paginationContainer.innerHTML = paginationHTML;\n}\n\nfunction changePage(page) {\n    if (page < 1 || page > totalPages || page === currentPage) return;\n    void loadCourses(page);\n}\n\nfunction formatCourseDate(dateString) {\n    if (!dateString) return 'Не указано';\n    try {\n        const date = new Date(dateString);\n        return date.toLocaleDateString('ru-RU', { year: 'numeric', month: '2-digit', day: '2-digit' });\n    } catch (e) {\n        return dateString;\n    }\n}\n\nfunction openViewCourseImageModal(img) {\n    if (!document.getElementById('viewImageModal')) {\n        renderImageViewModal();\n    }\n    const modalImg = document.getElementById('modalImgCourse');\n    if (modalImg) {\n        modalImg.src = `/img/course-brand/${img}`;\n        modalImg.alt = `Изображение курса: ${img}`;\n    }\n    const modalElement = document.getElementById('viewImageModal');\n    if (modalElement) {\n        const modal = new bootstrap.Modal(modalElement);\n        modal.show();\n    }\n}\n\nfunction renderImageViewModal() {\n    if (!document.getElementById('viewImageModal')) {\n        document.getElementById('img-view-modal').innerHTML += `\n            <div class=\"modal fade\" id=\"viewImageModal\" tabindex=\"-1\" aria-hidden=\"true\">\n                <div class=\"modal-dialog modal-lg\">\n                    <div class=\"modal-content\">\n                        <div class=\"modal-header\">\n                            <h5 class=\"modal-title\">Изображение курса</h5>\n                            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n                        </div>\n                        <div class=\"modal-body text-center\">\n                            <img id=\"modalImgCourse\" class=\"img-fluid\" style=\"max-height: 70vh; object-fit: contain;\">\n                        </div>\n                        <div class=\"modal-footer\">\n                            <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Закрыть</button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        `;\n    }\n}\n\ndocument.addEventListener('DOMContentLoaded', function() {\n    const coursesTabTrigger = document.querySelector('a[data-tab=\"courses-edit-tab\"]');\n    const coursesContainer = document.getElementById('courses-edit-tab');\n\n    if (coursesContainer) {\n        coursesContainer.addEventListener('click', function (event) {\n            if (event.target && event.target.classList.contains('click-for-redirect')) {\n                const url = event.target.textContent.trim();\n                if (url) {\n                    window.location.href = url;\n                }\n            }\n\n            \n        });\n    }\n    \n    if (coursesTabTrigger) {\n        let isInitialized = false;\n        coursesTabTrigger.addEventListener('click', () => {\n            if (!isInitialized) {\n                void loadCourses(1);\n                renderImageViewModal();\n                renderEditCourseModal(); // Render the edit modal structure on tab click\n                isInitialized = true;\n            }\n        });\n\n        if (document.getElementById('courses-edit-tab')?.classList.contains('active')) {\n            void loadCourses(1);\n            renderImageViewModal();\n            renderEditCourseModal(); // Also render here if the tab is already active\n            isInitialized = true;\n        }\n    }\n});\n\n// --- NEW: Functions for Edit Course Modal ---\n\nfunction renderEditCourseModal() {\n    if (document.getElementById('editCourseModal')) {\n        return; // Already rendered\n    }\n\n    const modalHTML = `\n        <div class=\"modal fade\" id=\"editCourseModal\" tabindex=\"-1\" aria-labelledby=\"editCourseModalLabel\" aria-hidden=\"true\">\n            <div class=\"modal-dialog modal-lg\">\n                <div class=\"modal-content\">\n                    <div class=\"modal-header\">\n                        <h5 class=\"modal-title\" id=\"editCourseModalLabel\">Редактировать курс</h5>\n                        <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n                    </div>\n                    <div class=\"modal-body\">\n                        <form id=\"editCourseForm\" onsubmit=\"handleCourseUpdate(event)\">\n                            <input type=\"hidden\" id=\"editCourseId\" name=\"id\">\n                            \n                            <div class=\"mb-3\">\n                                <label for=\"editCourseTitle\" class=\"form-label\">Название</label>\n                                <input type=\"text\" class=\"form-control\" id=\"editCourseTitle\" name=\"title\" required minlength=\"2\" maxlength=\"100\">\n                            </div>\n                            \n                            <div class=\"mb-3\">\n                                <label for=\"editCourseDescription\" class=\"form-label\">Описание</label>\n                                <textarea class=\"form-control\" id=\"editCourseDescription\" name=\"description\" rows=\"3\" required minlength=\"2\" maxlength=\"100\"></textarea>\n                            </div>\n                            \n                            <div class=\"mb-3\">\n                                <label for=\"editCourseSlug\" class=\"form-label\">URI (Slug)</label>\n                                <input type=\"text\" class=\"form-control\" id=\"editCourseSlug\" name=\"slug\" required minlength=\"2\" maxlength=\"100\">\n                            </div>\n\n                            <div class=\"mb-3\">\n                                <label for=\"editCourseImage\" class=\"form-label\">Изображение курса</label>\n                                <input class=\"form-control\" type=\"file\" id=\"editCourseImage\" name=\"image\" accept=\"image/png, image/jpeg, image/gif\">\n                                <div class=\"mt-2\">\n                                    <small class=\"text-muted\">Текущее изображение:</small>\n                                    <img id=\"currentCourseImage\" src=\"\" alt=\"Current Image\" class=\"img-thumbnail mt-1\" style=\"max-width: 150px;\">\n                                </div>\n                            </div>\n                            \n                            <div class=\"modal-footer\">\n                                <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Отмена</button>\n                                <button type=\"submit\" class=\"btn btn-primary\">Сохранить изменения</button>\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            </div>\n        </div>\n    `;\n    document.body.insertAdjacentHTML('beforeend', modalHTML);\n}\n\nasync function openEditCourseModal(courseId) {\n    const modalElement = document.getElementById('editCourseModal');\n    if (!modalElement) {\n        return;\n    }\n\n    const courseRow = document.getElementById(`course-row-${courseId}`);\n    if (!courseRow) {\n        showAlert('Не удалось найти данные для курса.', 'error');\n        return;\n    }\n\n    // Extract data from the table row\n    const title = courseRow.querySelector('.fw-bold').textContent.trim();\n    const description = courseRow.querySelector('.course-description').textContent.trim();\n    const slug = courseRow.querySelector('code').textContent.replace('/courses/', '').trim();\n    const imageUrl = courseRow.querySelector('.course-image').src;\n\n    // Populate the form\n    document.getElementById('editCourseId').value = courseId;\n    document.getElementById('editCourseTitle').value = title;\n    document.getElementById('editCourseDescription').value = description;\n    document.getElementById('editCourseSlug').value = slug;\n    document.getElementById('currentCourseImage').src = imageUrl;\n    document.getElementById('editCourseImage').value = ''; // Clear file input\n\n    const modal = new bootstrap.Modal(modalElement);\n    modal.show();\n}\n\nasync function handleCourseUpdate(event) {\n    event.preventDefault();\n    const form = event.target;\n    const formData = new FormData(form);\n    const courseId = formData.get('id');\n    const courseTitle = formData.get('title');\n\n    const headers = {};\n\n    try {\n        // NOTE: The backend endpoint /admin/courses/update is assumed to exist.\n        // It should handle a multipart/form-data POST request.\n        const response = await fetch('/admin/courses/update', {\n            method: 'POST',\n            headers: headers,\n            body: formData\n        });\n\n        const result = await response.json().catch(() => ({}));\n\n        if (response.ok && result.success) {\n            showAlert(`Курс \"${courseTitle}\" успешно обновлен!`, 'success');\n            const modal = bootstrap.Modal.getInstance(document.getElementById('editCourseModal'));\n            modal.hide();\n            void loadCourses(currentPage); // Refresh the table\n        } else {\n            // Prefer a server-sent message, otherwise use a generic one.\n            const errorMessage = result.error || `Ошибка сервера: ${response.status}`;\n            return null;\n        }\n    } catch (error) {\n        showAlert(`Ошибка обновления: ${error.message}`, 'error');\n    }\n}\n\nwindow.openAddCourseForm = openAddCourseForm;\nwindow.changeCoursesPerPage = changeCoursesPerPage;\nwindow.deleteCourse = deleteCourse;\nwindow.changePage = changePage;\nwindow.openViewCourseImageModal = openViewCourseImageModal;\nwindow.openEditCourseModal = openEditCourseModal;\nwindow.handleCourseUpdate = handleCourseUpdate;\nwindow.updateCourseStatus = updateCourseStatus;\nwindow.loadCourses = loadCourses;\n","// Глобальные переменные\nlet currentCourse = null;\nlet courseModules = [];\n\n// Функция открытия модального окна с модулями курса\nasync function openCourseModulesModal(courseId) {\n    try {\n        // Загружаем модули курса\n        const response = await fetch(`/admin/courses/${courseId}/modules`);\n        if (!response.ok) {\n            if (response.status === 404) {\n                showAlert('В этом модуле нет курсов', 'info');\n            } else {\n                showAlert('Ошибка загрузки модулей курса', 'error');\n            }\n            return;\n        }\n\n        const data = await response.json();\n        if (!data.success || !Array.isArray(data.data)) { // Проверяем, что data.data - это массив\n            showAlert(data.message || 'Модулей нет', 'info');\n            courseModules = []; // Устанавливаем пустой массив, если данные неверны\n            currentCourse = { id: courseId, name: \"Неизвестный курс\" }; // Устанавливаем дефолтное имя\n            return; // Выходим из функции, так как нет данных\n        }\n\n        courseModules = data.data || []; // Теперь data.data - это сам массив модулей\n        // Проверяем, что courseModules не пустой, прежде чем обращаться к первому элементу\n        currentCourse = { id: courseId, name: courseModules.length > 0 ? courseModules[0][\"courseName\"] : \"Неизвестный курс\" };\n\n        // Рендерим модальное окно\n        renderCourseModulesModal();\n\n        // Показываем модальное окно\n        const modalElement = document.getElementById('courseModulesModal');\n        if (!modalElement) {\n            return null;\n        }\n\n        const modal = new bootstrap.Modal(modalElement);\n        // noinspection JSUnresolvedReference\n        modal.show();\n\n    } catch (error) {\n    }\n}\n\n// Функция рендеринга модального окна\nfunction renderCourseModulesModal() {\n    const modalContainer = document.getElementById('courseModulesModal');\n\n    if (!modalContainer) {\n        // Создаем модальное окно если его нет\n        createModulesModalElement();\n        return;\n    }\n\n    // Заполняем заголовок\n    const modalTitle = modalContainer.querySelector('.modal-title');\n    if (modalTitle) {\n        modalTitle.textContent = `Модули курса: ${currentCourse.name}`;\n    }\n\n    if(courseModules.length > 0) {\n        document.getElementById('modulesCount').innerText = `Модулей: ${courseModules.length}`\n    }\n\n    // Заполняем список модулей\n    const modulesList = modalContainer.querySelector('#modulesList');\n    if (modulesList) {\n        modulesList.innerHTML = courseModules.length > 0 ?\n            renderModulesList() :\n            '<div class=\"text-center py-4 text-muted\">Модули не найдены</div>';\n    }\n}\n\n// Функция рендеринга списка модулей\nfunction renderModulesList() {\n    return courseModules.map((module, index) => `\n        <div class=\"module-item\" data-module-id=\"${module.moduleId}\">\n            <div class=\"module-header d-flex justify-content-between align-items-center\">\n                <div class=\"module-info\">\n                    <h6 class=\"module-title mb-1\">${module.order || index + 1}. ${escapeHtml(module[\"moduleTitle\"] || 'Без названия')}</h6>\n                    <small class=\"text-muted\">ID: ${module.moduleId} </small>\n                </div>\n                <div class=\"module-actions\">\n                    <button class=\"btn btn-sm btn-outline-primary me-1\" onclick=\"editModule(${module.id})\">\n                        <i class=\"fas fa-edit\"></i>\n                    </button>\n                    <a class=\"btn btn-sm btn-outline-danger\" href=\"/admin/modules\">\n                        <i class=\"fas fa-trash\"></i>\n                    </a>\n                </div>\n            </div>\n            <hr class=\"my-2\">\n        </div>\n    `).join('');\n}\n\n// Функция создания элемента модального окна\nfunction createModulesModalElement() {\n    const modalHTML = `\n        <div class=\"modal fade\" id=\"courseModulesModal\" tabindex=\"-1\" aria-hidden=\"true\">\n            <div class=\"modal-dialog modal-lg\">\n                <div class=\"modal-content\">\n                    <div class=\"modal-header\">\n                        <h5 class=\"modal-title\">Модули курса</h5>\n                        <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n                    </div>\n                    <div class=\"modal-body\">\n                        <div class=\"d-flex justify-content-between align-items-center mb-3\">\n                            <span class=\"text-muted\" id=\"modulesCount\">Модулей: 0</span>\n                        </div>\n                        \n                        <div id=\"modulesList\" class=\"modules-list\">\n                            <div class=\"text-center py-4 text-muted\">\n                                <i class=\"fas fa-spinner fa-spin me-2\"></i>\n                                Загрузка модулей...\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"modal-footer\">\n                        <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Закрыть</button>\n                        <button type=\"button\" class=\"btn btn-primary\" onclick=\"manageCourse(${currentCourse?.id})\">\n                            Управление курсом\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    `;\n\n    // Добавляем модальное окно в body\n    document.body.insertAdjacentHTML('beforeend', modalHTML);\n    renderCourseModulesModal();\n}\n\n// Вспомогательные функции\nfunction escapeHtml(text) {\n    if (text === null || text === undefined) return '';\n    const div = document.createElement('div');\n    div.textContent = text;\n    return div.innerHTML;\n}\n\nfunction formatDate(dateString) {\n    if (!dateString) return 'Не указано';\n    try {\n        const date = new Date(dateString);\n        return date.toLocaleDateString('ru-RU');\n    } catch (e) {\n        return dateString;\n    }\n}\n\n// Функции действий (заглушки)\nfunction addNewModule() {\n    alert(`Добавление модуля для курса: ${currentCourse?.name}`);\n}\n\nfunction editModule(moduleId) {\n    showAlert(`Редактирование модуля: ${moduleId}`, 'info');\n}\n\nfunction manageCourse(courseId) {\n    // Переход на страницу управления курсом\n    window.location.href = `/admin/courses/${courseId}/edit`;\n}\n\n// Обновляем функцию в основном скрипте для вызова модального окна\nfunction showCourseModules(courseId, courseName) {\n    void openCourseModulesModal(courseId, courseName);\n}\n\n// Инициализация при загрузке страницы\ndocument.addEventListener('DOMContentLoaded', function() {\n    // Обработчик для закрытия модального окна\n    document.addEventListener('hidden.bs.modal', function(event) {\n        if (event.target.id === 'courseModulesModal') {\n            // Очищаем данные при закрытии\n            currentCourse = null;\n            courseModules = [];\n        }\n    });\n});\n\nwindow.addNewModule = addNewModule;\nwindow.editModule = editModule;\nwindow.manageCourse = manageCourse;\nwindow.showCourseModules = showCourseModules;","document.addEventListener('DOMContentLoaded', function () {\n\n    const editLessonModal = new bootstrap.Modal(document.getElementById('editLessonModal'));\n    const editLessonForm = document.getElementById('editLessonForm');\n\n    // Инициализация TinyMCE\n    function initTinyMCE(content = '') {\n        tinymce.remove('#editLessonTextContent'); // Удаляем предыдущий инстанс, если он был\n        tinymce.init({\n            selector: '#editLessonTextContent',\n            plugins: 'code table lists image link',\n            toolbar: 'undo redo | blocks | bold italic | alignleft aligncenter alignright | indent outdent | bullist numlist | code | image | link',\n            height: 400,\n            setup: function (editor) {\n                editor.on('init', function () {\n                    editor.setContent(content);\n                });\n            }\n        });\n    }\n\n    // Глобальный обработчик кликов для делегирования событий\n    document.body.addEventListener('click', async function (event) {\n        const editButton = event.target.closest('.edit-lesson-btn');\n        if (editButton) {\n            const lessonId = editButton.dataset.lessonId;\n            if (!lessonId) return;\n\n            // 1. Получаем данные урока с бэкенда\n            try {\n                const response = await fetch(`/api/admin/lessons/${lessonId}`);\n                const result = await response.json();\n\n                if (!response.ok || !result.success) {\n                    const errorMsg = result.message || 'Не удалось загрузить данные урока.';\n                    showAlert(errorMsg, 'error');\n                    return;\n                }\n                const lessonData = result.data; // Data is in result.data\n\n                // 2. Заполняем форму\n                document.getElementById('editLessonId').value = lessonId;\n                document.getElementById('editLessonTitle').value = lessonData.title;\n                document.getElementById('editLessonVideoUrl').value = lessonData.videoUrl;\n\n                // 3. Инициализируем TinyMCE с контентом\n                initTinyMCE(lessonData.textContent || '');\n\n                // 4. Показываем модальное окно\n                editLessonModal.show();\n\n            } catch (error) {\n                showAlert(error.message, 'error');\n            }\n        }\n    });\n\n    // Обработчик отправки формы\n    editLessonForm.addEventListener('submit', async function (event) {\n        event.preventDefault();\n\n        const lessonId = document.getElementById('editLessonId').value;\n        const title = document.getElementById('editLessonTitle').value;\n        const videoUrl = document.getElementById('editLessonVideoUrl').value;\n        const textContent = tinymce.get('editLessonTextContent').getContent();\n\n        const lessonDto = {\n            title,\n            videoUrl,\n            textContent\n        };\n\n        try {\n            const response = await fetch(`/api/admin/lessons/${lessonId}`, {\n                method: 'PUT',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify(lessonDto)\n            });\n\n            const result = await response.json();\n\n            if (!response.ok || !result.success) {\n                const errorMessage = result.message || 'Произошла ошибка при сохранении.';\n                throw new Error(errorMessage);\n            }\n\n            // Успех\n            editLessonModal.hide();\n            showAlert(result.message || 'Урок успешно обновлен!', 'success');\n            // Обновляем таблицу уроков, чтобы увидеть изменения\n            if (typeof loadLessons === 'function') {\n                loadLessons();\n            }\n\n        } catch (error) {\n            showAlert(error.message, 'error');\n        }\n    });\n});\n","// Глобальные переменные\nlet modulesList = [];\n\n// Инициализация формы\nfunction initCreateLessonForm() {\n    loadModules();\n    bindFormEvents();\n}\n\n// Загрузка списка модулей\nasync function loadModules() {\n    try {\n        const response = await fetch('/admin/modules/json');\n        if (response.ok) {\n            const data = await response.json();\n            if (data.success && data.data) {\n                modulesList = data.data;\n                populateModulesSelect();\n            }\n        }\n    } catch (error) {\n        showAlert('Не удалось загрузить список модулей', 'error');\n    }\n}\n\n// Заполнение select модулей\nfunction populateModulesSelect() {\n    const select = document.getElementById('moduleId');\n    select.innerHTML = '<option value=\"\">Выберите модуль</option>';\n\n    modulesList.forEach(module => {\n        const option = document.createElement('option');\n        option.value = module.moduleId;\n        if(module.moduleStatus === \"ACTIVE\") {\n            option.textContent = `(Курс: ${module.courseName}) Модуль: ${module.moduleTitle}`;\n        } else {\n            option.textContent = `НЕАКТИВЕН (Курс: ${module.courseName}) Модуль: ${module.moduleTitle}`;\n            option.disabled = true;\n        }\n        select.appendChild(option);\n    });\n}\n\n// Привязка событий формы\nfunction bindFormEvents() {\n    const submitBtn = document.getElementById('submitLessonBtn');\n    const form = document.getElementById('createLessonForm');\n\n    if (submitBtn) {\n        submitBtn.addEventListener('click', handleLessonSubmit);\n    }\n\n    if (form) {\n        form.addEventListener('submit', function(e) {\n            e.preventDefault();\n            handleLessonSubmit();\n        });\n    }\n\n    // Очистка формы при закрытии модального окна\n    const modal = document.getElementById('createLessonModal');\n    if (modal) {\n        modal.addEventListener('hidden.bs.modal', resetForm);\n    }\n}\n\n// Обработчик отправки формы\nasync function handleLessonSubmit() {\n    if (!validateLessonForm()) {\n        return;\n    }\n\n    try {\n        showLoading(true);\n\n        const formData = new FormData();\n        formData.append('file', document.getElementById('videoFile').files[0]);\n        formData.append('moduleId', document.getElementById('moduleId').value);\n        formData.append('title', document.getElementById('lessonTitle').value);\n        formData.append('description', document.getElementById('description').value);\n        formData.append('shortDescription', document.getElementById('shortDescription').value);\n        formData.append('testCode', document.getElementById('testCode').value);\n\n        const response = await fetch('/admin/lesson/upload', {\n            method: 'POST',\n            body: formData\n        });\n\n        const result = await response.json();\n\n        if (response.ok) {\n            handleSuccessResponse(result);\n        } else {\n            handleErrorResponse(result);\n        }\n\n    } catch (error) {\n        showAlert('Произошла ошибка при создании урока', 'error');\n    } finally {\n        showLoading(false);\n    }\n}\n\n// Валидация формы\nfunction validateLessonForm() {\n    const form = document.getElementById('createLessonForm');\n\n    if (!form.checkValidity()) {\n        form.reportValidity();\n        return false;\n    }\n\n    // Проверка размера файла (максимум 500MB)\n    const fileInput = document.getElementById('videoFile');\n    if (fileInput.files[0] && fileInput.files[0].size > 200 * 1024 * 1024) {\n        showAlert('Размер файла не должен превышать 200MB', 'error');\n        return false;\n    }\n\n    return true;\n}\n\n// Обработка успешного ответа\nfunction handleSuccessResponse(result) {\n    showAlert('Урок успешно создан!', 'success');\n\n    // Закрываем модальное окно\n    const modal = bootstrap.Modal.getInstance(document.getElementById('createLessonModal'));\n    modal.hide();\n\n    void loadLessons()\n}\n\n// Обработка ошибки\nfunction handleErrorResponse(result) {\n    const errorMessage = result.message || 'Не удалось создать урок';\n    showAlert(errorMessage, 'error');\n\n    // Дополнительная обработка специфических ошибок\n    if (result.message && result.message.includes('file')) {\n        highlightFileInput();\n    }\n}\n\n// Сброс формы\nfunction resetForm() {\n    document.getElementById('createLessonForm').reset();\n    removeValidationStyles();\n}\n\n// Удаление стилей валидации\nfunction removeValidationStyles() {\n    const inputs = document.querySelectorAll('#createLessonForm .is-invalid');\n    inputs.forEach(input => {\n        input.classList.remove('is-invalid');\n    });\n}\n\n// Подсветка поля файла\nfunction highlightFileInput() {\n    const fileInput = document.getElementById('videoFile');\n    fileInput.classList.add('is-invalid');\n}\n\n// Показать/скрыть загрузку\nfunction showLoading(show) {\n    const submitBtn = document.getElementById('submitLessonBtn');\n    if (submitBtn) {\n        if (show) {\n            submitBtn.disabled = true;\n            submitBtn.innerHTML = '<i class=\"fas fa-spinner fa-spin me-1\"></i> Создание...';\n        } else {\n            submitBtn.disabled = false;\n            submitBtn.innerHTML = '<i class=\"fas fa-plus me-1\"></i> Создать урок';\n        }\n    }\n}\n\n// Функция для открытия модального окна\nfunction openCreateLessonModal() {\n    // Загружаем модули если еще не загружены\n    if (modulesList.length === 0) {\n        loadModules();\n    }\n\n    const modal = new bootstrap.Modal(document.getElementById('createLessonModal'));\n    modal.show();\n}\n\n// Инициализация при загрузке документа\ndocument.addEventListener('DOMContentLoaded', function() {\n    initCreateLessonForm();\n\n    // Добавляем кнопку открытия модального окна если нужно\n    const addButton = document.querySelector('[onclick=\"openCreateLessonModal()\"]');\n    if (addButton) {\n        addButton.addEventListener('click', openCreateLessonModal);\n    }\n});\n\n// CSS стили для формы\nconst formStyles = `\n#createLessonModal .modal-content {\n    background: var(--card-bg);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n#createLessonModal .modal-header {\n    background: var(--primary-gradient);\n    border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n#createLessonModal .modal-title {\n    color: white;\n    font-weight: 600;\n}\n\n#createLessonModal .form-select {\n    background-color: rgba(255, 255, 255, 0.05);\n    border-color: rgba(255, 255, 255, 0.1);\n    color: #e2e8f0;\n}\n\n#createLessonModal .form-select option {\n    background-color: var(--card-bg);\n    color: #e2e8f0;\n}\n\n#createLessonModal .form-control:focus,\n#createLessonModal .form-select:focus {\n    background: rgba(255, 255, 255, 0.12);\n    border-color: #6366f1;\n    box-shadow: 0 0 0 0.25rem rgba(99, 102, 241, 0.25);\n    color: #e2e8f0;\n}\n\n#createLessonModal .is-invalid {\n    border-color: #ef4444 !important;\n}\n\n#createLessonModal .form-text {\n    color: #94a3b8;\n    font-size: 0.875rem;\n}\n`;\n\n// Добавляем стили в документ\nconst styleSheet = document.createElement('style');\nstyleSheet.textContent = formStyles;\ndocument.head.appendChild(styleSheet);\n\nwindow.openCreateLessonModal = openCreateLessonModal;","document.addEventListener('DOMContentLoaded', function () {\n    const testGeneratorTab = document.getElementById('create-lesson-test-tab');\n\n    // Если на странице нет вкладки генератора тестов, ничего не делаем.\n    if (!testGeneratorTab) {\n        return;\n    }\n\n    const questionsContainer = testGeneratorTab.querySelector('#questionsContainer');\n    const testGeneratorForm = testGeneratorTab.querySelector('#testGeneratorForm');\n\n    let questionCounter = 0;\n\n    function createQuestionNode(questionIndex) {\n        const questionId = `question-${questionIndex}`;\n        const node = document.createElement('div');\n        node.className = 'card bg-dark border-secondary mb-4 question-card';\n        node.id = questionId;\n\n        node.innerHTML = `\n            <div class=\"card-header d-flex justify-content-between align-items-center\">\n                <h6 class=\"mb-0\">Вопрос <span class=\"question-number\">${questionIndex + 1}</span></h6>\n                <button type=\"button\" class=\"btn btn-outline-danger btn-sm remove-question-btn\">\n                    <i class=\"bi bi-trash\"></i> Удалить\n                </button>\n            </div>\n            <div class=\"card-body\">\n                <div class=\"mb-3\">\n                    <label for=\"${questionId}-text\" class=\"form-label\">Текст вопроса:</label>\n                    <input type=\"text\" id=\"${questionId}-text\" class=\"form-control question-text\" placeholder=\"Введите текст вопроса\" required>\n                </div>\n                <div class=\"answers-container\">\n                    <label class=\"form-label\">Варианты ответов (отметьте правильный):</label>\n                    ${[0, 1, 2].map(answerIndex => `\n                        <div class=\"input-group mb-2\">\n                            <input type=\"text\" class=\"form-control answer-text\" placeholder=\"Вариант ответа ${answerIndex + 1}\" required>\n                            <div class=\"input-group-text\">\n                                <input class=\"form-check-input correct-answer-radio\" type=\"radio\" name=\"${questionId}-correct\" value=\"${answerIndex}\" required>\n                            </div>\n                        </div>\n                    `).join('')}\n                </div>\n            </div>\n        `;\n\n        node.querySelector('.remove-question-btn').addEventListener('click', function() {\n            node.remove();\n            updateQuestionNumbers();\n        });\n\n        return node;\n    }\n\n    function updateQuestionNumbers() {\n        const allQuestions = questionsContainer.querySelectorAll('.question-card');\n        allQuestions.forEach((question, index) => {\n            question.querySelector('.question-number').textContent = index + 1;\n        });\n    }\n\n    function addNewQuestion() {\n        const newNode = createQuestionNode(questionCounter);\n        questionsContainer.appendChild(newNode);\n        questionCounter++;\n        updateQuestionNumbers();\n    }\n\n    // --- ИСПРАВЛЕНИЕ: Используем делегирование событий ---\n    testGeneratorTab.addEventListener('click', function(event) {\n        // Проверяем, был ли клик по кнопке \"Добавить вопрос\"\n        if (event.target && event.target.id === 'addQuestionBtn') {\n            addNewQuestion();\n        }\n    });\n\n    if (testGeneratorForm) {\n        testGeneratorForm.addEventListener('submit', function(e) {\n            e.preventDefault();\n            generateTestCode();\n        });\n    }\n\n    function generateTestCode() {\n        const questionCards = questionsContainer.querySelectorAll('.question-card');\n        const generatedQuestions = [];\n        let isValid = true;\n\n        if (questionCards.length === 0) {\n            showAlert('Пожалуйста, добавьте хотя бы один вопрос.', 'info');\n            return;\n        }\n\n        questionCards.forEach((card) => {\n            const questionText = card.querySelector('.question-text').value;\n            const answerInputs = card.querySelectorAll('.answer-text');\n            const correctAnswerRadio = card.querySelector('.correct-answer-radio:checked');\n\n            if (!questionText || !correctAnswerRadio) {\n                isValid = false;\n            }\n\n            const answers = [];\n            answerInputs.forEach((input, answerIndex) => {\n                if (!input.value) {\n                    isValid = false;\n                }\n                answers.push({\n                    text: input.value,\n                    correct: answerIndex === parseInt(correctAnswerRadio.value)\n                });\n            });\n\n            generatedQuestions.push({\n                question: questionText,\n                answers: answers\n            });\n        });\n\n        if (!isValid) {\n            showAlert('Пожалуйста, заполните все текстовые поля и выберите правильный ответ для каждого вопроса.', 'info');\n            return;\n        }\n\n        const code = `const questions = [\\n${generatedQuestions.map(q => \n`    {\\n        question: \"${q.question.replace(new RegExp('\"', 'g'), '\\\\\"')}\",\\n        answers: [\\n${q.answers.map(a => \n`            { text: \"${a.text.replace(new RegExp('\"', 'g'), '\\\\\"')}\", correct: ${a.correct} }`).join(',\\n')}\\n        ]\\n    }`\n).join(',\\n')}\\n];`;\n\n        document.getElementById('generatedCode').textContent = code;\n        document.getElementById('resultContainer').style.display = 'block';\n        window.generatedCodeForCopy = code;\n    }\n\n    // Добавляем первый вопрос только один раз, когда вкладка становится видимой\n    const tabObserver = new MutationObserver(mutations => {\n        mutations.forEach(mutation => {\n            if (mutation.attributeName === 'class' && testGeneratorTab.classList.contains('active')) {\n                // Если контейнер пуст, добавляем первый вопрос\n                if (questionsContainer.children.length === 0) {\n                    addNewQuestion();\n                }\n            }\n        });\n    });\n\n    tabObserver.observe(testGeneratorTab, { attributes: true });\n});\n\nfunction copyToClipboard() {\n    if (!window.generatedCodeForCopy) return;\n    navigator.clipboard.writeText(window.generatedCodeForCopy).then(() => {\n        showAlert('Код скопирован в буфер обмена!', 'success');\n    }).catch(err => {\n        showAlert('Не удалось скопировать код', 'error');\n    });\n}\n\nwindow.copyToClipboard = copyToClipboard;","// lessonsTable.js\nlet currentLessonsPage = 1;\nlet totalLessonsPages = 1;\nlet totalLessonsItems = 0;\nlet lessonsPerPage = 5;\n\n// --- NEW: Function to load modules for the filter dropdown ---\nasync function loadModulesForFilter() {\n    try {\n        const response = await fetch('/admin/modules/json');\n        if (!response.ok) {\n            return null;\n        }\n        const data = await response.json();\n        if (data.success && data.data) {\n            const select = document.getElementById('moduleFilterSelect');\n            if (!select) return;\n\n            // Save selected value if it exists\n            const currentFilter = select.value;\n\n            select.innerHTML = '<option value=\"\">Все модули</option>'; // Reset and add default option\n            data.data.forEach(module => {\n                const option = document.createElement('option');\n                option.value = module.moduleId;\n                option.textContent = `${module[\"moduleTitle\"]}`;\n                select.appendChild(option);\n            });\n\n            // Restore selected value\n            if (currentFilter) {\n                select.value = currentFilter;\n            }\n\n        } else {\n            return null;\n        }\n    } catch (error) {\n        showAlert('Не удалось загрузить фильтр модулей.', 'warning');\n    }\n}\n\n// --- MODIFIED: Load lessons with filtering capability ---\nasync function loadLessons(page = 1) {\n    try {\n        showLoading(true);\n\n        const moduleId = document.getElementById('moduleFilterSelect')?.value || '';\n        let url = `/admin/lessons?page=${page}&size=${lessonsPerPage}`;\n        if (moduleId) {\n            url += `&moduleId=${moduleId}`;\n        }\n\n        const response = await fetch(url);\n\n        if (response.ok) {\n            const result = await response.json();\n\n            if (result.success && result.data) {\n                const paginatedData = result.data;\n                currentLessonsPage = paginatedData.currentPage || page;\n                totalLessonsPages = paginatedData.totalPages || 1;\n                totalLessonsItems = paginatedData.totalItems || 0;\n\n                renderLessonsTable(paginatedData.content);\n                renderLessonsPagination(paginatedData.content);\n            } else {\n                 showAlert(result.message || 'Неверный формат данных', 'error');\n            }\n        } else {\n            // Handle cases like 404 when no lessons are found for a filter\n            if (response.status === 404) {\n                renderLessonsTable([]);\n                renderLessonsPagination([]);\n            } else {\n                return null;\n            }\n        }\n    } catch (error) {\n        showAlert(error.message, 'error');\n    } finally {\n        showLoading(false);\n    }\n}\n\n// --- MODIFIED: Render lessons table with filter dropdown ---\nfunction renderLessonsTable(lessons) {\n    const container = document.getElementById('lessonsContainer');\n    if (!container) {\n        return;\n    }\n\n    container.innerHTML = '';\n\n    const tableWrapper = document.createElement('div');\n    tableWrapper.className = 'courses-table-container';\n\n    tableWrapper.innerHTML = `\n        <div class=\"data-table courses-table lessons-table\">\n            <div class=\"table-header d-flex justify-content-between align-items-center flex-wrap\">\n                <h3 class=\"table-title mb-2 mb-md-0\">Список уроков</h3>\n                <div class=\"d-flex align-items-center gap-2 flex-wrap\">\n                    <!-- NEW: Module Filter -->\n                    <div class=\"filter-group\">\n                        <select class=\"form-select form-select-sm\" id=\"moduleFilterSelect\" onchange=\"loadLessons(1)\">\n                            <option value=\"\">Фильтр по модулю...</option>\n                        </select>\n                    </div>\n                    <div class=\"page-size-selector\">\n                        <div class=\"input-group input-group-sm\">\n                            <span class=\"input-group-text\">Отображать</span>\n                            <select class=\"form-select\" id=\"lessonsPageSizeSelect\" onchange=\"changeLessonsPerPage(this.value)\">\n                                <option value=\"5\" ${lessonsPerPage === 5 ? 'selected' : ''}>5</option>\n                                <option value=\"10\" ${lessonsPerPage === 10 ? 'selected' : ''}>10</option>\n                                <option value=\"20\" ${lessonsPerPage === 20 ? 'selected' : ''}>20</option>\n                                <option value=\"50\" ${lessonsPerPage === 50 ? 'selected' : ''}>50</option>\n                            </select>\n                        </div>\n                    </div>\n                    <button class=\"btn btn-primary btn-sm\" onclick=\"openCreateLessonModal()\">\n                        <i class=\"bi bi-plus-circle me-1\"></i>Новый урок\n                    </button>\n                </div>\n            </div>\n\n            <div class=\"table-content\">\n                <div class=\"table-row header-row\">\n                    <div class=\"table-cell\">ID</div>\n                    <div class=\"table-cell\">Название</div>\n                    <div class=\"table-cell\">Модуль</div>\n                    <div class=\"table-cell\">Описание</div>\n                    <div class=\"table-cell\">Видео</div>\n                    <div class=\"table-cell\">Действия</div>\n                </div>\n\n                ${lessons.length > 0 ? lessons.map(lesson => `\n                <div class=\"table-row\">\n                    <div class=\"table-cell text-muted\">#${lesson.id || 'N/A'}</div>\n                    <div class=\"table-cell\">\n                        <div class=\"fw-bold\">${escapeHtml(lesson.title || 'Без названия')}</div>\n                    </div>\n                    <div class=\"table-cell\">\n                        <span class=\"text-muted\">${escapeHtml(lesson[\"moduleName\"] || 'N/A')}</span>\n                    </div>\n                    <div class=\"table-cell\">\n                        <span class=\"lesson-description\">${truncateText(lesson.description || 'Нет описания', 100)}</span>\n                    </div>\n                    <div class=\"table-cell\">\n                        ${lesson.video ? `\n                            <a href=\"/admin/video/${lesson.video}\" class=\"text-primary text-decoration-none\">\n                                <i class=\"bi bi-camera-video me-1\"></i> Смотреть\n                            </a>\n                        ` : '<span class=\"text-muted\">Нет видео</span>'}\n                    </div>\n                    <div class=\"table-cell action-buttons\">\n                        <button class=\"btn btn-info btn-icon btn-sm edit-lesson-btn\" title=\"Редактировать\" data-lesson-id=\"${lesson.id}\">\n                            <i class=\"bi bi-pencil\"></i>\n                        </button>\n                        <button class=\"btn btn-danger btn-icon btn-sm\" title=\"Удалить\"\n                                onclick=\"deleteLesson(${lesson.id}, '${escapeHtml(lesson.title)}')\">\n                            <i class=\"bi bi-trash\"></i>\n                        </button>\n                    </div>\n                </div>\n                `).join('') : `\n                <div class=\"table-row\">\n                    <div class=\"table-cell\" style=\"grid-column: 1 / -1; text-align: center; padding: 2rem; color: #94a3b8;\">\n                        <i class=\"bi bi-book-open me-2\"></i>\n                        Уроки не найдены. Измените фильтр или добавьте новый урок.\n                    </div>\n                </div>\n                `}\n            </div>\n        </div>\n    `;\n    container.appendChild(tableWrapper);\n\n    // --- NEW: Populate the filter after rendering the table structure ---\n    void loadModulesForFilter();\n}\n\n// Рендер пагинации\nfunction renderLessonsPagination(lessons) {\n    const container = document.getElementById('lessonsPagination');\n    if (!container) {\n        return;\n    }\n\n    if (totalLessonsPages <= 1) {\n        container.innerHTML = '';\n        return;\n    }\n\n    let paginationHTML = `\n        <nav aria-label=\"Page navigation\">\n            <ul class=\"pagination justify-content-center\">\n                <li class=\"page-item ${currentLessonsPage === 1 ? 'disabled' : ''}\">\n                    <a class=\"page-link\" href=\"#\" onclick=\"changeLessonsPage(${currentLessonsPage - 1}); return false;\">&laquo;</a>\n                </li>\n    `;\n\n    const maxVisiblePages = 5;\n    let startPage = Math.max(1, currentLessonsPage - Math.floor(maxVisiblePages / 2));\n    let endPage = Math.min(totalLessonsPages, startPage + maxVisiblePages - 1);\n\n    if (endPage - startPage + 1 < maxVisiblePages) {\n        startPage = Math.max(1, endPage - maxVisiblePages + 1);\n    }\n\n    if (startPage > 1) {\n        paginationHTML += `<li class=\"page-item\"><a class=\"page-link\" href=\"#\" onclick=\"changeLessonsPage(1); return false;\">1</a></li>`;\n        if (startPage > 2) {\n            paginationHTML += `<li class=\"page-item disabled\"><span class=\"page-link\">...</span></li>`;\n        }\n    }\n\n    for (let i = startPage; i <= endPage; i++) {\n        paginationHTML += `<li class=\"page-item ${i === currentLessonsPage ? 'active' : ''}\"><a class=\"page-link\" href=\"#\" onclick=\"changeLessonsPage(${i}); return false;\">${i}</a></li>`;\n    }\n\n    if (endPage < totalLessonsPages) {\n        if (endPage < totalLessonsPages - 1) {\n            paginationHTML += `<li class=\"page-item disabled\"><span class=\"page-link\">...</span></li>`;\n        }\n        paginationHTML += `<li class=\"page-item\"><a class=\"page-link\" href=\"#\" onclick=\"changeLessonsPage(${totalLessonsPages}); return false;\">${totalLessonsPages}</a></li>`;\n    }\n\n    paginationHTML += `\n                <li class=\"page-item ${currentLessonsPage === totalLessonsPages ? 'disabled' : ''}\">\n                    <a class=\"page-link\" href=\"#\" onclick=\"changeLessonsPage(${currentLessonsPage + 1}); return false;\">&raquo;</a>\n                </li>\n            </ul>\n        </nav>\n        \n        <div class=\"pagination-info text-center mt-2\">\n            <small class=\"text-muted\">\n                Страница ${currentLessonsPage} из ${totalLessonsPages} • Показано ${lessons.length} из ${totalLessonsItems} уроков\n            </small>\n        </div>\n    `;\n\n    container.innerHTML = paginationHTML;\n}\n\n// Смена страницы\nfunction changeLessonsPage(page) {\n    if (page < 1 || page > totalLessonsPages || page === currentLessonsPage) return;\n    void loadLessons(page);\n}\n\n// Изменение количества уроков на странице\nfunction changeLessonsPerPage(perPage) {\n    lessonsPerPage = parseInt(perPage) || 10;\n     void loadLessons(1);\n}\n\n// Вспомогательные функции\nfunction showLoading(show) {\n    const container = document.getElementById('lessonsContainer');\n    if (!container) return;\n\n    if (show) {\n        container.innerHTML = `\n            <div class=\"d-flex justify-content-center align-items-center\" style=\"height: 200px;\">\n                <div class=\"spinner-border text-primary\" role=\"status\">\n                    <span class=\"visually-hidden\">Загрузка...</span>\n                </div>\n            </div>\n        `;\n    }\n}\n\nfunction truncateText(text, maxLength) {\n    if (!text || text.length <= maxLength) return escapeHtml(text || '');\n    return escapeHtml(text.substring(0, maxLength)) + '...';\n}\n\nfunction escapeHtml(text) {\n    if (typeof text !== 'string') return '';\n    const div = document.createElement('div');\n    div.textContent = text;\n    return div.innerHTML;\n}\n\nasync function deleteLesson(lessonId, lessonTitle) {\n    if (!confirm(`Вы уверены, что хотите удалить урок \"${lessonTitle}\"?`)) {\n        return;\n    }\n\n    try {\n        const headers = {\n            'Content-Type': 'application/json'\n        };\n\n        const response = await fetch(`/admin/lessons/${lessonId}/delete`, {\n            method: 'DELETE',\n            headers: headers\n        });\n\n        const result = await response.json().catch(() => ({})); // Handle empty response\n\n        if (response.ok && result.success) {\n            showAlert(`Урок \"${lessonTitle}\" успешно удален.`, 'success');\n            void loadLessons(currentLessonsPage || 1);\n        } else {\n            const errorMessage = result.message || `Ошибка удаления: ${response.status}`;\n            showAlert(errorMessage, 'error');\n        }\n\n    } catch (error) {\n        showAlert(error.message, 'error');\n    }\n}\n\n// Инициализация\ndocument.addEventListener('DOMContentLoaded', function() {\n    const lessonsTabTrigger = document.querySelector('a[data-tab=\"lessons-edit-tab\"]');\n    if (lessonsTabTrigger) {\n        lessonsTabTrigger.addEventListener('click', function() {\n            // Ensure we load lessons only when the tab is activated\n            setTimeout(() => loadLessons(1), 10); \n        });\n\n        // If the tab is already active on page load, load lessons\n        if (document.getElementById('lessons-edit-tab')?.classList.contains('active')) {\n            void loadLessons(1);\n        }\n    }\n});\n\nwindow.loadLessons = loadLessons;\nwindow.changeLessonsPerPage = changeLessonsPerPage;\nwindow.changeLessonsPage = changeLessonsPage;\nwindow.deleteLesson = deleteLesson;\n","\ndocument.addEventListener('DOMContentLoaded', function () {\n    // Используем делегирование событий для кнопок редактирования\n    document.getElementById('modulesContainer').addEventListener('click', function (event) {\n        const editButton = event.target.closest('.edit-module-btn');\n        if (editButton) {\n            const moduleId = editButton.dataset.moduleId;\n            void openEditModuleModal(moduleId);\n        }\n    });\n\n    // Обработка отправки формы\n    const editModuleForm = document.getElementById('editModuleForm');\n    if (editModuleForm) {\n        editModuleForm.addEventListener('submit', async function (event) {\n            event.preventDefault();\n            await submitEditModuleForm();\n        });\n    }\n});\n\nasync function openEditModuleModal(moduleId) {\n    try {\n        // 1. Получаем данные модуля\n        const response = await fetch(`/admin/module/${moduleId}`);\n        const result = await response.json();\n\n        if (response.ok && result.success && result.data) {\n            const module = result.data;\n\n            // 2. Заполняем поля формы\n            document.getElementById('editModuleId').value = module.moduleId;\n            document.getElementById('editModuleTitle').value = module[\"moduleTitle\"];\n            document.getElementById('editModuleSlug').value = module[\"moduleSlug\"];\n\n            // 3. Загружаем и устанавливаем курс\n            const courseSelect = document.getElementById('editModuleCourseId');\n            await loadCoursesIntoSelect(courseSelect, module[\"courseName\"]);\n\n            // 4. Показываем модальное окно\n            const modal = new bootstrap.Modal(document.getElementById('editModuleModal'));\n            modal.show();\n        } else {\n            showAlert(result.message || 'Не удалось получить данные модуля.', 'error');\n        }\n\n    } catch (error) {\n        console.error('Ошибка при открытии модального окна:', error);\n        showAlert('Критическая ошибка при загрузке данных модуля.', 'error');\n    }\n}\n\nasync function submitEditModuleForm() {\n    const form = document.getElementById('editModuleForm');\n    const moduleId = document.getElementById('editModuleId').value;\n    const modal = bootstrap.Modal.getInstance(document.getElementById('editModuleModal'));\n\n    const formData = {\n        moduleId: moduleId,\n        name: document.getElementById('editModuleTitle').value,\n        slug: document.getElementById('editModuleSlug').value,\n        courseId: document.getElementById('editModuleCourseId').value\n    };\n\n    try {\n        const response = await fetch(`/admin/modules/update`, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'X-CSRF-TOKEN': getCsrfToken()\n            },\n            body: JSON.stringify(formData)\n        });\n\n        const result = await response.json();\n\n        if (response.ok && result.status === 'success') {\n            showAlert(result.message || 'Модуль успешно обновлен!', 'success');\n            modal.hide();\n            // Обновляем таблицу модулей\n            if (typeof loadModules === 'function') {\n                void loadModules(window.currentModulesPage || 1);\n            }\n        } else {\n            // Обработка ошибок валидации или других сообщений об ошибках\n            if (result.errors) {\n                const errorMessages = Object.values(result.errors).join('\\n');\n                showAlert('Ошибка валидации:\\n' + errorMessages, 'error');\n            } else {\n                showAlert(result.message || 'Не удалось обновить модуль.', 'error');\n                console.error(new Error(result.message || 'Не удалось обновить модуль.'));\n            }\n        }\n    } catch (error) {\n        console.error('Ошибка при обновлении модуля:', error);\n        showAlert('Ошибка: ' + error.message, 'error');\n    }\n}\n\n// Загрузка списка курсов в select\nasync function loadCoursesIntoSelect(selectElement, selectedCourseTitle) {\n    try {\n        const response = await fetch('/admin/courses/all');\n        if (!response.ok) {\n            console.error(new Error('Не удалось загрузить список курсов.'));\n        }\n        const data = await response.json();\n        const courses = data.data; // Corrected: data is in data.data\n\n        selectElement.innerHTML = '<option value=\"\">Выберите курс</option>';\n        courses.forEach(course => {\n            const option = document.createElement('option');\n            option.value = course.id;\n            option.textContent = course.title;\n            if (course.title === selectedCourseTitle) {\n                option.selected = true;\n            }\n            selectElement.appendChild(option);\n        });\n    } catch (error) {\n        console.error(error);\n        selectElement.innerHTML = '<option value=\"\">Ошибка загрузки курсов</option>';\n    }\n}\n\nfunction getCsrfToken() {\n    return document.querySelector('meta[name=\"_csrf\"]')?.content || document.querySelector('input[name=\"_csrf\"]')?.value;\n}\n\nwindow.loadCoursesIntoSelect = loadCoursesIntoSelect;\nwindow.submitEditModuleForm = submitEditModuleForm;\nwindow.openEditModuleModal = openEditModuleModal;\n\n","document.addEventListener('DOMContentLoaded', function() {\n    const form = document.getElementById('createModuleForm');\n    const courseSelect = document.getElementById('moduleCourseId');\n    const titleInput = document.getElementById('moduleTitle');\n    const slugInput = document.getElementById('moduleSlug');\n\n\n    const courseSelectAdminCreateModule = document.getElementById('moduleCourseId');\n    void loadCoursesIntoSelect(courseSelectAdminCreateModule, null)\n\n    // Load courses when the tab is shown\n    const createModuleTab = document.querySelector('a[data-tab=\"create-module-tab\"]');\n    if (createModuleTab) {\n        createModuleTab.addEventListener('click', loadCourses);\n    }\n    \n    // Also load courses if the tab is already active on page load\n    if (document.getElementById('create-module-tab')?.classList.contains('active')) {\n        void loadCourses();\n    }\n\n\n    if (form) {\n        form.addEventListener('submit', async function(event) {\n            event.preventDefault();\n\n            if (!validateForm()) {\n                return;\n            }\n\n            try {\n                const formData = {\n                    courseId: courseSelect.value,\n                    slug: slugInput.value,\n                    title: titleInput.value,\n                };\n\n                const csrfToken = document.querySelector('meta[name=\"_csrf\"]')?.content;\n                const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]')?.content;\n\n                const headers = {\n                    'Content-Type': 'application/json'\n                };\n                if (csrfToken && csrfHeader) {\n                    headers[csrfHeader] = csrfToken;\n                }\n\n\n                const response = await fetch('/admin/modules/create', {\n                    method: 'POST',\n                    headers: headers,\n                    body: JSON.stringify(formData)\n                });\n\n                const result = await response.json();\n\n                if (response.ok && result.status === 'success') {\n                    showAlert(result.message || 'Модуль успешно создан!', 'success');\n                    form.reset();\n                    // Optionally, switch back to the modules list tab\n                    const modulesTab = document.querySelector('a[data-tab=\"modules-edit-tab\"]');\n                    if (modulesTab) {\n                        modulesTab.click();\n                    }\n                } else {\n                    if (result.errors) {\n                        const errorMessages = Object.values(result.errors).join('\\n');\n                        showAlert('Ошибка валидации:\\n' + errorMessages, 'error');\n                    } else {\n                        showAlert(result.message || \"Ошибка при создании модуля\", 'error');\n                    }\n                    console.error('Server error:', result.message || result.errors);\n                }\n\n            } catch (error) {\n                console.error('Ошибка отправки:', error);\n                showAlert('Произошла критическая ошибка при отправке данных', 'error');\n            }\n        });\n    }\n\n    function validateForm() {\n        if (!courseSelect.value) {\n            showAlert('Пожалуйста, выберите курс', 'error');\n            return false;\n        }\n        if (!titleInput.value.trim()) {\n            showAlert('Пожалуйста, введите название модуля', 'error');\n            return false;\n        }\n        if (!slugInput.value.trim()) {\n            showAlert('Пожалуйста, укажите URI модуля', 'error');\n            return false;\n        }\n\n        const slugRegex = /^[a-z0-9-]+$/;\n        if (!slugRegex.test(slugInput.value)) {\n            showAlert('URI может содержать только латинские буквы в нижнем регистре, цифры и дефисы', 'error');\n            return false;\n        }\n        return true;\n    }\n\n    let isSlugManuallyEdited = false;\n\n    if (titleInput && slugInput) {\n        // Generate slug as user types in the title field\n        titleInput.addEventListener('input', () => {\n            if (!isSlugManuallyEdited) {\n                generateSlugFromTitle();\n            }\n        });\n\n        // Detect when user edits the slug field manually to disable auto-generation\n        slugInput.addEventListener('input', () => {\n            isSlugManuallyEdited = true;\n        });\n    }\n\n    function generateSlugFromTitle() {\n        const title = titleInput.value.trim();\n        if (title) {\n            const translitMap = {\n                'а': 'a', 'б': 'b', 'в': 'v', 'г': 'g', 'д': 'd', 'е': 'e', 'ё': 'yo', 'ж': 'zh',\n                'з': 'z', 'и': 'i', 'й': 'y', 'к': 'k', 'л': 'l', 'м': 'm', 'н': 'n', 'о': 'o',\n                'п': 'p', 'р': 'r', 'с': 's', 'т': 't', 'у': 'u', 'ф': 'f', 'х': 'h', 'ц': 'ts',\n                'ч': 'ch', 'ш': 'sh', 'щ': 'shch', 'ъ': '', 'ы': 'y', 'ь': '', 'э': 'e', 'ю': 'yu', 'я': 'ya'\n            };\n\n            let slug = title.toLowerCase();\n            let result = '';\n            for (let i = 0; i < slug.length; i++) {\n                result += translitMap[slug[i]] || slug[i];\n            }\n\n            slug = result\n                .replace(/['\"’]/g, '')      // remove quotes\n                .replace(/\\s+/g, '-')       // collapse whitespace and replace by -\n                .replace(/[^a-z0-9-]/g, '') // remove invalid chars\n                .replace(/-+/g, '-')        // collapse dashes\n                .replace(/^-|-$/g, '');     // trim - from start or end\n\n            slugInput.value = slug;\n        }\n    }\n});","function deleteModule(id) {\n    // Показываем подтверждающее окно\n    const isConfirmed = confirm('Вы уверены, что хотите удалить этот модуль, и все его уроки? Это действие нельзя отменить.');\n\n    if (!isConfirmed) {\n        return; // Если пользователь отменил, прерываем выполнение\n    }\n\n    // Отправляем запрос на сервер\n    fetch(`/admin/module/${id}/delete`, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n            'X-CSRF-TOKEN': document.querySelector('meta[name=\"_csrf\"]')?.content || '' // Для Spring Security CSRF\n        }\n    })\n        .then(response => {\n            // Всегда пытаемся парсить JSON, даже для \"плохих\" ответов\n            return response.json().then(data => {\n                if (!response.ok) {\n                    // Если ответ не \"ok\", создаем ошибку с сообщением от сервера\n                    throw new Error(data.message || 'Ошибка при удалении модуля');\n                }\n                return data; // Возвращаем данные, если все в порядке\n            });\n        })\n        .then(data => {\n            // Успешное удаление\n            showAlert(data.message || 'Модуль успешно удален', 'success');\n\n            // Обновляем таблицу модулей без перезагрузки страницы\n            if (typeof loadModules === 'function') {\n                void loadModules(window.currentModulesPage || 1);\n            }\n        })\n        .catch(error => {\n            // Обработка ошибок\n            showAlert(`Ошибка: ${error.message}`, 'error');\n            console.error('Ошибка при удалении модуля:', error);\n        });\n}\n\nwindow.deleteModule = deleteModule;\n","function adminUpdateModuleStatus(moduleID, status) {\n    const isConfirmed = confirm('Вы уверены, что хотите обновить статус?');\n\n    if (!isConfirmed) {\n        return; // Если пользователь отменил, прерываем выполнение\n    }\n\n    if(status === 'ACTIVE') {\n        status = 'INACTIVE'\n    }else{\n        status = 'ACTIVE'\n    }\n\n    // Отправляем запрос на сервер\n    fetch(`/admin/modules/updateStatus/${moduleID}/${status}`, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n            'X-CSRF-TOKEN': document.querySelector('meta[name=\"_csrf\"]')?.content || '' // Для Spring Security CSRF\n        }\n    })\n        .then(response => {\n            return response.json().then(data => {\n                if (!response.ok) {\n                    throw new Error(data.message || 'Ошибка при обновлении статуса');\n                }\n                return data;\n            });\n        })\n        .then(data => {\n            // Успешное обновление\n            showAlert(data.message, 'success');\n\n            // Обновляем таблицу модулей без перезагрузки страницы\n            if (typeof loadModules === 'function') {\n                void loadModules(window.currentModulesPage || 1);\n            }\n        })\n        .catch(error => {\n            // Обработка ошибок\n            showAlert(`Ошибка: ${error.message}`, 'error');\n            console.error('Ошибка при обновлении статуса:', error);\n        });\n}\n\nwindow.adminUpdateModuleStatus = adminUpdateModuleStatus;\n","async function loadModuleLessons(moduleId) {\n    try {\n        const response = await fetch(`/admin/modules/${moduleId}/lessons`);\n\n        // Case 1: Success (200 OK)\n        if (response.ok) {\n            const result = await response.json();\n            if (result.success) {\n                showLessonsModal(result.data);\n            } else {\n                showAlert(result.message || 'Получен неожиданный ответ от сервера.', 'warning');\n            }\n            return;\n        }\n\n        // Case 2: Not Found (404)\n        if (response.status === 404) {\n            showAlert('В этом модуле пока нет уроков.', 'info');\n            // Show an empty modal for better UX\n            showLessonsModal([]);\n            return;\n        }\n\n        // Case 3: Server Error (500) or other client errors (4xx)\n        let errorMessage = `HTTP ошибка: ${response.status} ${response.statusText}`;\n        try {\n            // Try to get a more specific error message from the response body\n            const errorData = await response.json();\n            if (errorData && errorData.error) {\n                errorMessage = `Ошибка на сервере: ${errorData.error}`;\n            }\n        } catch (e) {\n            // Body is not JSON or is empty, stick with the generic HTTP error message\n            console.error(\"Could not parse error JSON.\", e);\n        }\n\n        showAlert(errorMessage, 'error');\n        console.error('Failed to load lessons:', errorMessage);\n\n    } catch (error) {\n        // Case 4: Network error or other fetch-related failures\n        console.error('Network or fetch error:', error);\n        showAlert('Сетевая ошибка. Не удалось подключиться к серверу.', 'error');\n    }\n}\n\nfunction showLessonsModal(lessons) {\n    // Create the modal if it doesn't exist yet\n    if (!document.getElementById('lessonsModal')) {\n        const modalHtml = `\n            <div class=\"modal fade\" id=\"lessonsModal\" tabindex=\"-1\" aria-labelledby=\"lessonsModalLabel\" aria-hidden=\"true\">\n                <div class=\"modal-dialog modal-lg\">\n                    <div class=\"modal-content\">\n                        <div class=\"modal-header\">\n                            <h5 class=\"modal-title\" id=\"lessonsModalLabel\">Уроки модуля</h5>\n                            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n                        </div>\n                        <div class=\"modal-body\" id=\"lessonsModalBody\">\n                            <!-- Lesson list will be inserted here -->\n                        </div>\n                        <div class=\"modal-footer\">\n                            <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Закрыть</button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        `;\n        document.body.insertAdjacentHTML('beforeend', modalHtml);\n    }\n\n    const modalBody = document.getElementById('lessonsModalBody');\n    const modalTitle = document.getElementById('lessonsModalLabel');\n\n    if (lessons.length === 0) {\n        modalTitle.textContent = 'Уроки модуля';\n        modalBody.innerHTML = `\n            <div class=\"text-center py-4\">\n                <i class=\"bi bi-book-half fa-3x text-muted mb-3\"></i>\n                <h5 class=\"text-muted\">В этом модуле нет уроков</h5>\n                <p class=\"text-muted\">Вы можете создать первый урок в разделе \"Уроки\".</p>\n            </div>\n        `;\n    } else {\n        const moduleName = lessons[0]?.moduleName || 'Модуль';\n        modalTitle.textContent = `Уроки модуля: ${moduleName}`;\n\n        modalBody.innerHTML = `\n            <div class=\"list-group\">\n                ${lessons.map(lesson => `\n                    <div class=\"list-group-item list-group-item-action\">\n                        <div class=\"d-flex justify-content-between align-items-center\">\n                            <div class=\"flex-grow-1\">\n                                <h6 class=\"mb-1\">${lesson.title || 'Без названия'}</h6>\n                                <small class=\"text-muted\">ID: ${lesson.id}</small>\n                            </div>\n                            <div class=\"btn-group ms-3\">\n                                <button class=\"btn btn-outline-info btn-sm\" onclick=\"viewLesson(${lesson.id}, '${lesson.courseSlug}', '${lesson.moduleSlug}')\">\n                                    <i class=\"bi bi-eye\"></i> Просмотреть\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                `).join('')}\n            </div>\n            <div class=\"mt-3\">\n                <small class=\"text-muted\">Всего уроков: ${lessons.length}</small>\n            </div>\n        `;\n    }\n\n    const modal = new bootstrap.Modal(document.getElementById('lessonsModal'));\n    modal.show();\n}\n\nfunction viewLesson(lessonId, courseSlug, moduleSlug) {\n    if (!courseSlug || !moduleSlug) {\n        showAlert('Недостаточно данных для перехода к уроку (отсутствует slug курса или модуля).', 'error');\n        return;\n    }\n    const url = `/course/${courseSlug}/module/${moduleSlug}/lesson/${lessonId}`;\n    console.log(`Redirecting to: ${url}`);\n    window.location.href = url;\n}\n\nwindow.loadModuleLessons = loadModuleLessons;\nwindow.viewLesson = viewLesson;\n","let currentModulesPage = 1;\nlet totalModulesPages = 1;\nlet totalModulesItems = 0;\nlet modulesPerPage = 5;\n\n// --- NEW: Initialize the entire view (controls and data) ---\nfunction initModulesView() {\n    const container = document.getElementById('modulesContainer');\n    if (!container) {\n        console.error('Module container not found!');\n        return;\n    }\n\n    // 1. Render the static part of the table (header, filters)\n    renderModuleControls(container);\n\n    // 2. Populate the filter with data\n    void loadCoursesForFilter();\n\n    // 3. Load the initial set of data\n    void loadModules(1);\n}\n\n// --- NEW: Renders the static controls (header, filters) only once ---\nfunction renderModuleControls(container) {\n    container.innerHTML = `\n        <div class=\"data-table courses-table modules-table\">\n            <div class=\"table-header d-flex justify-content-between align-items-center flex-wrap\">\n                 <h3 class=\"table-title mb-2 mb-md-0\">Список модулей</h3>\n                 <div class=\"d-flex align-items-center gap-2 flex-wrap\">\n                    <div class=\"filter-group\">\n                        <select class=\"form-select form-select-sm\" id=\"courseFilterSelect\" onchange=\"loadModules(1)\">\n                            <option value=\"\">Фильтр по курсу...</option>\n                        </select>\n                    </div>\n                    <div class=\"page-size-selector\">\n                        <div class=\"input-group input-group-sm\">\n                            <span class=\"input-group-text\">Отображать</span>\n                            <select class=\"form-select\" id=\"modulesPageSizeSelect\" onchange=\"changeModulesPerPage(this.value)\">\n                                <option value=\"5\">5</option>\n                                <option value=\"10\">10</option>\n                                <option value=\"20\">20</option>\n                                <option value=\"50\">50</option>\n                            </select>\n                        </div>\n                    </div>\n                     <button class=\"btn btn-primary btn-sm\" onclick=\"openCreateModuleModal()\">\n                        <i class=\"bi bi-plus-circle me-1\"></i>Новый модуль\n                    </button>\n                </div>\n            </div>\n            <!-- This container will be updated with new rows -->\n            <div class=\"table-content\" id=\"modules-table-content\">\n                <!-- Rows will be injected here -->\n            </div>\n        </div>\n    `;\n    // Set the initial value for the page size selector\n    document.getElementById('modulesPageSizeSelect').value = modulesPerPage;\n}\n\n// --- NEW: Function to load courses for the filter dropdown (runs once) ---\nasync function loadCoursesForFilter() {\n    const select = document.getElementById('courseFilterSelect');\n    if (!select) return;\n\n    try {\n        const response = await fetch('/admin/courses/all');\n        if (!response.ok) {\n            console.error(new Error('Failed to load courses'));\n            return null;\n        }\n        const json = await response.json();\n        \n        if (!json.success || !json.data) {\n            console.error(new Error('Invalid data format for courses'));\n            return null;\n        }\n\n        json.data.forEach(course => {\n            const option = document.createElement('option');\n            option.value = course.id;\n            option.textContent = course.title;\n            select.appendChild(option);\n        });\n    } catch (error) {\n        console.error('Error loading courses for filter:', error);\n        showAlert('Не удалось загрузить фильтр курсов.', 'warning');\n    }\n}\n\n// --- MODIFIED: Fetches data and calls a specific function to render only the rows ---\nasync function loadModules(page = 1) {\n    const contentContainer = document.getElementById('modules-table-content');\n    if (!contentContainer) {\n        initModulesView(); // If the container doesn't exist, initialize the whole view\n        return;\n    }\n\n    showLoadingModules(true);\n\n    try {\n        const courseId = document.getElementById('courseFilterSelect')?.value || '';\n        let url = `/admin/modules?page=${page}&size=${modulesPerPage}`;\n        if (courseId) {\n            url += `&courseId=${courseId}`;\n        }\n\n        const response = await fetch(url);\n        const data = await response.json();\n\n        if (response.ok && data.success && data.data && typeof data.data.content !== 'undefined') {\n            const paginatedModules = data.data;\n\n            currentModulesPage = paginatedModules[\"currentPage\"] || page;\n            totalModulesPages = paginatedModules[\"totalPages\"] || 1;\n            totalModulesItems = paginatedModules[\"totalItems\"] || 0;\n\n            renderModuleRows(paginatedModules.content);\n            renderModulesPagination();\n        } else {\n            showErrorModules(data.message || \"Получены неверные данные от сервера.\");\n        }\n\n    } catch (error) {\n        console.error('Ошибка загрузки модулей:', error);\n        showErrorModules(error.message);\n    } finally {\n        showLoadingModules(false);\n    }\n}\n\n// --- NEW: Renders only the module rows into the content container ---\nfunction renderModuleRows(modules) {\n    const container = document.getElementById('modules-table-content');\n    if (!container) return;\n\n    // Clear only the rows\n    container.innerHTML = '';\n\n    const headerRow = `\n        <div class=\"table-row header-row\">\n            <div class=\"table-cell\">ID</div>\n            <div class=\"table-cell\">Название</div>\n            <div class=\"table-cell\">Курс</div>\n            <div class=\"table-cell\">Статус</div>\n            <div class=\"table-cell\">Действия</div>\n        </div>\n    `;\n    container.insertAdjacentHTML('beforeend', headerRow);\n\n    if (modules.length === 0) {\n        container.insertAdjacentHTML('beforeend', `\n            <div class=\"table-row\">\n                <div class=\"table-cell\" style=\"grid-column: 1 / -1; text-align: center; padding: 2rem; color: #94a3b8;\">\n                    <i class=\"bi bi-collection me-2\"></i>\n                    Модули не найдены. Измените фильтр или добавьте новый модуль.\n                </div>\n            </div>\n        `);\n        return;\n    }\n\n    modules.forEach(module => {\n        const rowHTML = `\n            <div class=\"table-row\">\n                <div class=\"table-cell text-muted\">#${module.moduleId || 'N/A'}</div>\n                <div class=\"table-cell\">\n                    <div class=\"fw-bold\">${escapeHtml(module[\"moduleTitle\"] || 'Без названия')}</div>\n                </div>\n                <div class=\"table-cell\">\n                    <span class=\"text-muted\">${escapeHtml(module[\"courseName\"] || 'N/A')}</span>\n                </div>\n                <div class=\"table-cell\">\n                    <span class=\"badge ${module[\"moduleStatus\"] === 'ACTIVE' ? 'bg-success' : 'bg-secondary'}\" style=\"cursor: pointer\" onclick=\"adminUpdateModuleStatus(${module.moduleId}, '${module[\"moduleStatus\"]}')\">\n                        ${escapeHtml(adaptiveModuleStatus(module[\"moduleStatus\"]))}\n                    </span>\n                </div>\n                <div class=\"table-cell action-buttons\">\n                    <button class=\"btn btn-primary btn-icon btn-sm edit-module-btn\" title=\"Редактировать\" data-module-id=\"${module.moduleId}\">\n                        <i class=\"bi bi-pencil\"></i>\n                    </button>\n                    <button class=\"btn btn-danger btn-icon btn-sm\" title=\"Удалить\" onclick=\"deleteModule(${module.moduleId}, '${escapeHtml(module[\"moduleTitle\"])}')\">\n                        <i class=\"bi bi-trash\"></i>\n                    </button>\n                    <button class=\"btn btn-info btn-icon btn-sm\" title=\"Уроки модуля\" onclick=\"loadModuleLessons(${module.moduleId})\">\n                        <i class=\"bi bi-card-checklist\"></i>\n                    </button>\n                </div>\n            </div>\n        `;\n        container.insertAdjacentHTML('beforeend', rowHTML);\n    });\n}\n\n// --- UNCHANGED (mostly) ---\nfunction renderModulesPagination() {\n    let container = document.getElementById('modulesPagination');\n    if (!container) {\n        // If the main container exists but pagination doesn't, create it.\n        const mainContainer = document.getElementById('modulesContainer');\n        if(mainContainer) {\n            const paginationDiv = document.createElement('div');\n            paginationDiv.className = 'pagination-container mt-3';\n            paginationDiv.id = 'modulesPagination';\n            mainContainer.appendChild(paginationDiv);\n            container = paginationDiv;\n        } else {\n            return;\n        }\n    }\n\n    if (totalModulesPages <= 1) {\n        container.innerHTML = '';\n        return;\n    }\n\n    let paginationHTML = `\n        <nav aria-label=\"Page navigation\">\n            <ul class=\"pagination justify-content-center\">\n                <li class=\"page-item ${currentModulesPage === 1 ? 'disabled' : ''}\">\n                    <a class=\"page-link\" href=\"#\" onclick=\"changeModulesPage(${currentModulesPage - 1}); return false;\">&laquo;</a>\n                </li>\n    `;\n\n    const maxVisiblePages = 5;\n    let startPage = Math.max(1, currentModulesPage - Math.floor(maxVisiblePages / 2));\n    let endPage = Math.min(totalModulesPages, startPage + maxVisiblePages - 1);\n\n    if (endPage - startPage + 1 < maxVisiblePages) {\n        startPage = Math.max(1, endPage - maxVisiblePages + 1);\n    }\n\n    if (startPage > 1) {\n        paginationHTML += `<li class=\"page-item\"><a class=\"page-link\" href=\"#\" onclick=\"changeModulesPage(1); return false;\">1</a></li>`;\n        if (startPage > 2) paginationHTML += `<li class=\"page-item disabled\"><span class=\"page-link\">...</span></li>`;\n    }\n\n    for (let i = startPage; i <= endPage; i++) {\n        paginationHTML += `<li class=\"page-item ${i === currentModulesPage ? 'active' : ''}\"><a class=\"page-link\" href=\"#\" onclick=\"changeModulesPage(${i}); return false;\">${i}</a></li>`;\n    }\n\n    if (endPage < totalModulesPages) {\n        if (endPage < totalModulesPages - 1) paginationHTML += `<li class=\"page-item disabled\"><span class=\"page-link\">...</span></li>`;\n        paginationHTML += `<li class=\"page-item\"><a class=\"page-link\" href=\"#\" onclick=\"changeModulesPage(${totalModulesPages}); return false;\">${totalModulesPages}</a></li>`;\n    }\n\n    paginationHTML += `\n                <li class=\"page-item ${currentModulesPage === totalModulesPages ? 'disabled' : ''}\">\n                    <a class=\"page-link\" href=\"#\" onclick=\"changeModulesPage(${currentModulesPage + 1}); return false;\">&raquo;</a>\n                </li>\n            </ul>\n        </nav>\n        <div class=\"pagination-info text-center mt-2\">\n            <small class=\"text-muted\">\n                Страница ${currentModulesPage} из ${totalModulesPages} • Всего модулей: ${totalModulesItems}\n            </small>\n        </div>\n    `;\n    container.innerHTML = paginationHTML;\n}\n\nfunction changeModulesPage(page) {\n    if (page < 1 || page > totalModulesPages || page === currentModulesPage) return;\n     void loadModules(page);\n}\n\nfunction changeModulesPerPage(perPage) {\n    modulesPerPage = parseInt(perPage) || 10;\n    void loadModules(1);\n}\n\nfunction showLoadingModules(isLoading) {\n    const container = document.getElementById('modules-table-content');\n    if (!container) return;\n    if (isLoading) {\n        container.innerHTML = `\n            <div class=\"d-flex justify-content-center align-items-center\" style=\"height: 200px;\">\n                <div class=\"spinner-border text-primary\" role=\"status\">\n                    <span class=\"visually-hidden\">Загрузка...</span>\n                </div>\n            </div>\n        `;\n    }\n}\n\nfunction showErrorModules(message) {\n    const container = document.getElementById('modulesContainer');\n    if (!container) return;\n    container.innerHTML = `\n        <div class=\"text-center py-4 text-danger\">\n            <i class=\"bi bi-exclamation-triangle-fill fa-2x mb-3\"></i>\n            <h5>Ошибка загрузки</h5>\n            <p>${escapeHtml(message)}</p>\n            <button class=\"btn btn-primary btn-sm\" onclick=\"initModulesView()\">\n                <i class=\"bi bi-arrow-clockwise me-1\"></i> Попробовать снова\n            </button>\n        </div>\n    `;\n}\n\nfunction adaptiveModuleStatus(status) {\n    return status === 'ACTIVE' ? 'Активный' : 'Неактивный'\n}\n\nfunction escapeHtml(text) {\n    if (typeof text !== 'string') return '';\n    const div = document.createElement('div');\n    div.textContent = text;\n    return div.innerHTML;\n}\n\nfunction openCreateModuleModal() {\n    const tabLink = document.querySelector('a[data-tab=\"create-module-tab\"]');\n    if (tabLink) tabLink.click();\n}\n\n// --- MODIFIED: Initialization logic ---\ndocument.addEventListener('DOMContentLoaded', function() {\n    const modulesTabTrigger = document.querySelector('a[data-tab=\"modules-edit-tab\"]');\n    if (modulesTabTrigger) {\n        let isInitialized = false;\n        const observer = new MutationObserver(() => {\n            if (document.getElementById('modules-edit-tab').classList.contains('active') && !isInitialized) {\n                initModulesView();\n                isInitialized = true;\n            }\n        });\n\n        modulesTabTrigger.addEventListener('click', () => {\n            if (!isInitialized) {\n                initModulesView();\n                isInitialized = true;\n            }\n        });\n\n        if (document.getElementById('modules-edit-tab').classList.contains('active')) {\n            initModulesView();\n            isInitialized = true;\n        }\n    }\n});\n\nwindow.changeModulesPerPage = changeModulesPerPage;\nwindow.openCreateModuleModal = openCreateModuleModal;\nwindow.changeModulesPage = changeModulesPage;\nwindow.initModulesView = initModulesView;\nwindow.loadModules = loadModules;\n","// This file is deprecated. The deleteOffer function is now in getOffers.js","// State variables for pagination and filtering\nlet currentOfferPage = 1;\nlet totalOfferPages = 1;\nlet totalOfferItems = 0;\nlet sortStatus = \"all\";\nlet offersPerPage = 10; // Default value\n\n/**\n * Fetches and renders offers for a given page and filters.\n * @param {number} page - The page number to load.\n */\nasync function loadOffers(page = 1) {\n    try {\n        const response = await fetch(`/admin/offers?page=${page}&size=${offersPerPage}&status=${sortStatus}`);\n        if (!response.ok) {\n            console.error(new Error(`Ошибка сервера: ${response.status}`));\n            showAlert(`Ошибка сервера: ${response.status}`, 'error')\n        }\n        const data = await response.json();\n        if (data.success && data[\"offers\"]) {\n            currentOfferPage = data[\"currentPage\"] || page;\n            totalOfferPages = data[\"totalPages\"] || 1;\n            totalOfferItems = data[\"totalItems\"] || data[\"offers\"].length;\n\n            renderOffersTable(data[\"offers\"]);\n            renderOfferPagePagination();\n        } else {\n            console.error(new Error(\"Неверный формат данных от AdminOfferController\"));\n            showAlert(\"Неверный формат данных от AdminOfferController\", 'error')\n        }\n    } catch (e) {\n        console.error(\"Ошибка при загрузке заявок:\", e);\n        const offerTableContainer = document.querySelector('#requests-tab .card-body');\n        if (offerTableContainer) {\n            offerTableContainer.innerHTML = `<div class=\"text-center py-4 text-danger\">Не удалось загрузить заявки.</div>`;\n        }\n    }\n}\n\n/**\n * Deletes an offer after user confirmation.\n * @param {string|number} offerId - The ID of the offer to delete.\n */\nasync function deleteOffer(offerId) {\n    // Use a more robust confirmation if a custom modal library is available\n    if (!confirm('Вы уверены, что хотите удалить эту заявку?')) {\n        return;\n    }\n\n    try {\n        const csrfToken = typeof getCsrfToken === 'function' ? getCsrfToken() : document.querySelector('meta[name=\"_csrf\"]')?.getAttribute('content') || '';\n        const response = await fetch(`/admin/offers/delete/${offerId}`, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'X-CSRF-TOKEN': csrfToken\n            }\n        });\n\n        const result = await response.json();\n\n        if (response.ok && result.success) {\n            // Use a more robust alert if a custom one is available\n            showAlert('Заявка успешно удалена!', 'success');\n            void loadOffers(currentOfferPage); // Refresh the list\n        } else {\n            showAlert(result.error || 'Ошибка при удалении заявки', 'error');\n        }\n    } catch (error) {\n        console.error('Ошибка удаления заявки:', error);\n        showAlert('Ошибка сервера', 'error');\n    }\n}\n\n/**\n * Renders the main table of offers.\n * @param {Array<object>} offers - The array of offer objects to render.\n */\nfunction renderOffersTable(offers) {\n    const offerTableContainer = document.querySelector('#requests-tab .card-body');\n    if (!offerTableContainer) {\n        console.error('Контейнер для таблицы заявок не найден');\n        return;\n    }\n\n    offerTableContainer.innerHTML = `\n    <div class=\"offers-table-container\">\n        <div class=\"data-table offers-table\">\n            <div class=\"table-header d-flex justify-content-between align-items-center\">\n                <h3 class=\"table-title\">Список заявок</h3>\n                <div class=\"table-header-actions d-flex align-items-center\" style=\"gap: 1rem;\">\n                    <div class=\"input-group\">\n                        <span class=\"input-group-text\"><i class=\"bi bi-funnel\"></i></span>\n                        <select class=\"form-select form-select-sm\" id=\"statusFilter\">\n                            <option value=\"all\" ${sortStatus === 'all' ? 'selected' : ''}>Все статусы</option>\n                            <option value=\"PENDING\" ${sortStatus === 'PENDING' ? 'selected' : ''}>На рассмотрении</option>\n                            <option value=\"APPROVED\" ${sortStatus === 'APPROVED' ? 'selected' : ''}>Одобреные</option>\n                            <option value=\"COMPLETED\" ${sortStatus === 'COMPLETED' ? 'selected' : ''}>Выполненые</option>\n                            <option value=\"REJECTED\" ${sortStatus === 'REJECTED' ? 'selected' : ''}>Отклоненные</option>\n                        </select>\n                    </div>\n                    <div class=\"input-group\">\n                        <span class=\"input-group-text\">Показывать</span>\n                        <select class=\"form-select form-select-sm\" id=\"pageSizeSelect\">\n                            <option value=\"5\" ${offersPerPage === 5 ? 'selected' : ''}>5</option>\n                            <option value=\"10\" ${offersPerPage === 10 ? 'selected' : ''}>10</option>\n                            <option value=\"20\" ${offersPerPage === 20 ? 'selected' : ''}>20</option>\n                            <option value=\"50\" ${offersPerPage === 50 ? 'selected' : ''}>50</option>\n                        </select>\n                    </div>\n                </div>\n            </div>\n\n            <div class=\"table-content\" id=\"offersTableContent\">\n                <!-- Table Header -->\n                <div class=\"table-row header-row\">\n                    <div class=\"table-cell\">ID</div>\n                    <div class=\"table-cell\">Пользователь</div>\n                    <div class=\"table-cell\">Тема</div>\n                    <div class=\"table-cell\">Описание</div>\n                    <div class=\"table-cell\">Ответ</div>\n                    <div class=\"table-cell\">Статус</div>\n                    <div class=\"table-cell\">Создана</div>\n                    <div class=\"table-cell\">Обновлена</div>\n                    <div class=\"table-cell\">Действия</div>\n                </div>\n\n                <!-- Offer Rows -->\n                ${offers.length > 0 ? offers.map(offer => `\n                <div class=\"table-row\">\n                    <div class=\"table-cell text-muted\">#${offer.id || 'N/A'}</div>\n                    <div class=\"table-cell\">\n                        <div class=\"fw-bold\">${offer[\"fio\"] || 'N/A'}</div>\n                    </div>\n                    <div class=\"table-cell\">\n                        <div class=\"fw-bold\">${offer.topic || 'N/A'}</div>\n                    </div>\n                    <div class=\"table-cell\">\n                        <span class=\"course-description\">${offer.description || 'N/A'}</span>\n                    </div>\n                    <div class=\"table-cell\">\n                        <span class=\"course-description\">${offer.response || 'Нет ответа'}</span>\n                    </div>\n                    <div class=\"table-cell\">${convertStatusIntoBadge(offer.status)}</div>\n                    <div class=\"table-cell text-sm text-muted\">${extractDate(offer[\"createdAt\"])}</div>\n                    <div class=\"table-cell text-sm text-muted\">${extractDate(offer[\"updatedAt\"])}</div>\n                    <div class=\"table-cell action-buttons justify-content-center\">\n                        ${createOfferResponseButton(offer)}\n                        <button class=\"btn btn-danger btn-icon btn-sm\" title=\"Удалить\" data-action=\"delete-offer\" data-offer-id=\"${offer.id}\">\n                            <i class=\"bi bi-trash\"></i>\n                        </button>\n                    </div>\n                </div>\n                `).join('') : `\n                <div class=\"table-row\" style=\"grid-template-columns: 1fr;\">\n                    <div class=\"text-center py-4 text-muted\">\n                        <i class=\"bi bi-inbox fs-3 d-block mb-2\"></i>\n                        Заявки не найдены\n                    </div>\n                </div>\n                `}\n            </div>\n        </div>\n    </div>`;\n    bindOfferTableEvents(); // Bind events after rendering\n}\n\n/**\n * Renders the pagination controls for the offers table.\n */\nfunction renderOfferPagePagination() {\n    let offerPaginationContainer = document.querySelector('.pagination-container-edit-offers');\n    if (!offerPaginationContainer) {\n        const mainContainer = document.querySelector('#requests-tab .card-body');\n        if (mainContainer) {\n            const paginationDiv = document.createElement('div');\n            paginationDiv.className = 'pagination-container-edit-offers mt-3';\n            mainContainer.appendChild(paginationDiv);\n            offerPaginationContainer = paginationDiv;\n        } else {\n            console.error('Основной контейнер для таблицы заявок не найден, пагинация не будет отображена.');\n            return;\n        }\n    }\n\n    if (totalOfferPages <= 1) {\n        offerPaginationContainer.innerHTML = '';\n        return;\n    }\n\n    let offerPaginationHTML = `\n        <nav aria-label=\"Page navigation\">\n            <ul class=\"pagination justify-content-center\">\n                <!-- Previous Button -->\n                <li class=\"page-item ${currentOfferPage === 1 ? 'disabled' : ''}\">\n                    <a class=\"page-link\" href=\"#\" data-action=\"change-page\" data-page-number=\"${currentOfferPage - 1}\" aria-label=\"Previous\">\n                        <span aria-hidden=\"true\">&laquo;</span>\n                    </a>\n                </li>`;\n\n    const maxVisiblePages = 5;\n    let offerStartPage = Math.max(1, currentOfferPage - Math.floor(maxVisiblePages / 2));\n    let offerEndPage = Math.min(totalOfferPages, offerStartPage + maxVisiblePages - 1);\n\n    if (offerEndPage - offerStartPage + 1 < maxVisiblePages) {\n        offerStartPage = Math.max(1, offerEndPage - maxVisiblePages + 1);\n    }\n\n    if (offerStartPage > 1) {\n        offerPaginationHTML += `<li class=\"page-item\"><a class=\"page-link\" href=\"#\" data-action=\"change-page\" data-page-number=\"1\">1</a></li>`;\n        if (offerStartPage > 2) {\n            offerPaginationHTML += `<li class=\"page-item disabled\"><span class=\"page-link\">...</span></li>`;\n        }\n    }\n\n    for (let i = offerStartPage; i <= offerEndPage; i++) {\n        offerPaginationHTML += `\n            <li class=\"page-item ${i === currentOfferPage ? 'active' : ''}\">\n                <a class=\"page-link\" href=\"#\" data-action=\"change-page\" data-page-number=\"${i}\">${i}</a>\n            </li>`;\n    }\n\n    if (offerEndPage < totalOfferPages) {\n        if (offerEndPage < totalOfferPages - 1) {\n            offerPaginationHTML += `<li class=\"page-item disabled\"><span class=\"page-link\">...</span></li>`;\n        }\n        offerPaginationHTML += `<li class=\"page-item\"><a class=\"page-link\" href=\"#\" data-action=\"change-page\" data-page-number=\"${totalOfferPages}\">${totalOfferPages}</a></li>`;\n    }\n\n    offerPaginationHTML += `\n                <!-- Next Button -->\n                <li class=\"page-item ${currentOfferPage === totalOfferPages ? 'disabled' : ''}\">\n                    <a class=\"page-link\" href=\"#\" data-action=\"change-page\" data-page-number=\"${currentOfferPage + 1}\" aria-label=\"Next\">\n                        <span aria-hidden=\"true\">&raquo;</span>\n                    </a>\n                </li>\n            </ul>\n        </nav>\n        <div class=\"pagination-info text-center mt-2\">\n            <small class=\"text-muted\">Страница ${currentOfferPage} из ${totalOfferPages} • Всего заявок: ${totalOfferItems}</small>\n        </div>`;\n\n    offerPaginationContainer.innerHTML = offerPaginationHTML;\n    bindOfferPaginationEvents(); // Bind events after rendering\n}\n\n/**\n * Binds event listeners for the offers table (filters, actions).\n */\nfunction bindOfferTableEvents() {\n    const statusFilter = document.getElementById('statusFilter');\n    if (statusFilter) {\n        statusFilter.addEventListener('change', (event) => {\n            sortStatus = event.target.value;\n            void loadOffers(1); // Reset to first page\n        });\n    }\n\n    const pageSizeSelect = document.getElementById('pageSizeSelect');\n    if (pageSizeSelect) {\n        pageSizeSelect.addEventListener('change', (event) => {\n            offersPerPage = parseInt(event.target.value, 10);\n            void loadOffers(1); // Reset to first page\n        });\n    }\n\n    const tableContent = document.getElementById('offersTableContent');\n    if (tableContent) {\n        tableContent.addEventListener('click', (event) => {\n            const target = event.target.closest('button[data-action=\"delete-offer\"]');\n            if (target) {\n                const offerId = target.dataset.offerId;\n                void deleteOffer(offerId);\n            }\n        });\n    }\n}\n\n/**\n * Binds event listeners for the pagination controls.\n */\nfunction bindOfferPaginationEvents() {\n    const offerPaginationContainer = document.querySelector('.pagination-container-edit-offers');\n    if (offerPaginationContainer) {\n        offerPaginationContainer.addEventListener('click', (event) => {\n            event.preventDefault();\n            const target = event.target.closest('a[data-action=\"change-page\"]');\n            if (target) {\n                const pageNumber = parseInt(target.dataset.pageNumber, 10);\n                if (!isNaN(pageNumber)) {\n                    changeOfferPage(pageNumber);\n                }\n            }\n        });\n    }\n}\n\n/**\n * Changes the current page of offers.\n * @param {number} page - The page number to switch to.\n */\nfunction changeOfferPage(page) {\n    if (page < 1 || page > totalOfferPages || page === currentOfferPage) {\n        return;\n    }\n    void loadOffers(page);\n}\n\n/**\n * Formats a date string into YYYY-MM-DD.\n * @param {string} dateString - The input date string.\n * @returns {string} The formatted date.\n */\nfunction extractDate(dateString) {\n    if (!dateString) return 'N/A';\n    try {\n        return new Date(dateString).toISOString().split('T')[0];\n    } catch (e) {\n        return dateString; // Return original if parsing fails\n    }\n}\n\n/**\n * Converts an offer status string into a colored Bootstrap badge.\n * @param {string} status - The status string (e.g., 'PENDING').\n * @returns {string} The HTML for the badge.\n */\nfunction convertStatusIntoBadge(status) {\n    switch (status) {\n        case 'PENDING':\n            return '<span class=\"status-badge status-pending\">Не рассмотрена</span>';\n        case 'REJECTED':\n            return '<span class=\"status-badge status-rejected\">Отклонена</span>';\n        case 'APPROVED':\n            return '<span class=\"status-badge status-review\">Одобрена</span>';\n        case 'COMPLETED':\n            return '<span class=\"status-badge status-completed\">Выполнена</span>';\n        default:\n            return `<span class=\"status-badge\">${status || 'N/A'}</span>`;\n    }\n}\n\n// Initial load when the DOM is ready and the tab is visible.\ndocument.addEventListener('DOMContentLoaded', function () {\n    // This assumes the tab is visible on load. A more robust solution might\n    // use a MutationObserver or a custom event when the tab is shown.\n    const offersTab = document.getElementById('requests-tab');\n    if (offersTab) {\n        void loadOffers(1);\n    }\n});\n\n// Expose functions to the global scope if they are called from other scripts\n// or legacy inline handlers we might have missed.\nwindow.loadOffers = loadOffers;","// offerModal.js - Merged functionality for handling offer responses.\n\nlet currentOffer = null;\n\n// --- INITIALIZATION ---\n\n// Initialize event listeners when the DOM is fully loaded.\ndocument.addEventListener('DOMContentLoaded', initOfferModal);\n\n/**\n * Initializes all event listeners for the offer response modal.\n */\nfunction initOfferModal() {\n    const modalElement = document.getElementById('offerResponseModal');\n    // The form ID is 'adminUpdateForm' from admin.ftlh.\n    const responseForm = document.getElementById('adminUpdateForm');\n\n    if (modalElement) {\n        // Use event delegation for all buttons that open the response modal.\n        document.body.addEventListener('click', handleOpenModalClick);\n        // Clear the form when the modal is closed.\n        modalElement.addEventListener('hidden.bs.modal', clearModalForm);\n    }\n\n    if (responseForm) {\n        // Handle the form submission.\n        responseForm.addEventListener('submit', handleSubmitResponse);\n    }\n}\n\n\n// --- EVENT HANDLERS ---\n\n/**\n * Handles clicks on the body to open the modal if the target is a response button.\n * @param {Event} event - The click event.\n */\nfunction handleOpenModalClick(event) {\n    const button = event.target.closest('.js-open-response-modal');\n    if (button) {\n        const offerData = {\n            id: button.dataset.id,\n            description: button.dataset.description,\n            response: button.dataset.response,\n            status: button.dataset.status\n        };\n        openOfferResponseModal(offerData);\n    }\n}\n\n/**\n * Handles the submission of the offer response form.\n * @param {Event} event - The submit event.\n */\nasync function handleSubmitResponse(event) {\n    event.preventDefault();\n\n    const form = event.target;\n    const offerId = form.querySelector('#offerId').value;\n    const status = form.querySelector('#responseStatus').value;\n    const responseText = form.querySelector('#responseText').value;\n\n    const updateData = {\n        offerId: offerId,\n        status: status,\n        response: responseText.trim()\n    };\n\n    const submitBtn = form.querySelector('button[type=\"submit\"]');\n    const originalText = submitBtn.innerHTML;\n\n    try {\n        submitBtn.disabled = true;\n        submitBtn.innerHTML = '<span class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span> Обновление...';\n\n        const response = await fetch('/admin/updateOffer', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'X-CSRF-TOKEN': getCsrfToken()\n            },\n            body: JSON.stringify(updateData)\n        });\n\n        const result = await response.json();\n\n        if (!response.ok) {\n            const errorMessage = result.errors\n                ? 'Ошибки валидации:\\n' + Object.values(result.errors).join('\\n')\n                : `Ошибка: ${result.message || 'Неизвестная ошибка'}`;\n            showAlert(errorMessage, 'error');\n            return;\n        }\n\n        showAlert('Заявка успешно обновлена!', 'success');\n        const modal = bootstrap.Modal.getInstance(document.getElementById('offerResponseModal'));\n        modal.hide();\n\n        // Refresh the offers list if the function exists.\n        if (typeof loadOffers === 'function') {\n            loadOffers();\n        }\n\n    } catch (error) {\n        console.error('Error updating offer:', error);\n        showAlert('Ошибка сервера', 'error');\n    } finally {\n        submitBtn.disabled = false;\n        submitBtn.innerHTML = originalText;\n    }\n}\n\n\n// --- MODAL AND FORM LOGIC ---\n\n/**\n * Opens the modal and populates it with the offer data.\n * @param {object} offerData - The data for the offer.\n */\nfunction openOfferResponseModal(offerData) {\n    currentOffer = offerData;\n    populateModalForm(offerData);\n\n    const modal = new bootstrap.Modal(document.getElementById('offerResponseModal'));\n    modal.show();\n}\n\n/**\n * Fills the modal's form with data from the selected offer.\n * @param {object} offerData - The data for the offer.\n */\nfunction populateModalForm(offerData) {\n    document.getElementById('responseOfferId').textContent = offerData.id;\n    document.getElementById('offerId').value = offerData.id;\n    document.getElementById('responseDescription').textContent = offerData.description || 'Описание отсутствует';\n    document.getElementById('responseStatus').value = offerData.status || 'PENDING';\n    document.getElementById('responseText').value = offerData.response || '';\n}\n\n/**\n * Clears the form fields and resets the state.\n */\nfunction clearModalForm() {\n    const form = document.getElementById('adminUpdateForm');\n    if (form) {\n        form.reset(); // Resets all form fields\n    }\n    // Manually clear elements not part of the form if needed\n    document.getElementById('responseOfferId').textContent = '';\n    document.getElementById('responseDescription').textContent = 'Описание отсутствует';\n    currentOffer = null;\n}\n\n\n// --- UTILITY FUNCTIONS ---\n\n/**\n * Creates the HTML for the response button.\n * @param {object} offer - The offer object.\n * @returns {string} HTML string for the button.\n */\nfunction createOfferResponseButton(offer) {\n    return `\n        <button class=\"btn btn-info btn-icon btn-sm js-open-response-modal\"\n                title=\"Ответить\"\n                data-id=\"${offer.id}\"\n                data-description=\"${escapeHtml(offer.description || '')}\"\n                data-response=\"${escapeHtml(offer.response || '')}\"\n                data-status=\"${offer.status}\">\n            <i class=\"bi bi-reply\"></i>\n        </button>\n    `;\n}\n\n/**\n * Gets the CSRF token from the page's meta tags.\n * @returns {string} The CSRF token.\n */\nfunction getCsrfToken() {\n    return document.querySelector('meta[name=\"_csrf\"]')?.getAttribute('content') || '';\n}\n\n/**\n * Escapes HTML special characters to prevent XSS.\n * @param {string} text - The string to escape.\n * @returns {string} The escaped string.\n */\nfunction escapeHtml(text) {\n    if (typeof text !== 'string') return '';\n    const map = {\n        '&': '&amp;',\n        '<': '&lt;',\n        '>': '&gt;',\n        '\"': '&quot;',\n        \"'\": '&#039;'\n    };\n    return text.replace(/[&<>\"]|'(?!$)/g, m => map[m]);\n}\n\n// --- GLOBAL EXPOSURE ---\n\n// Expose functions to the global scope if they need to be called from inline scripts or other modules.\nwindow.openOfferResponseModal = openOfferResponseModal;\nwindow.createOfferResponseButton = createOfferResponseButton;\n","// Глобальные переменные для хранения данных\nlet currentEditingUser = null;\n\n// Функция открытия модального окна редактирования\nasync function openEditUserModal(userId) {\n    try {\n        // Загружаем данные пользователя\n        const userResponse = await fetch(`/admin/user/${userId}`);\n        if (!userResponse.ok) throw new Error('Ошибка загрузки данных пользователя');\n\n        const userData = await userResponse.json();\n        if (!userData.success) throw new Error(userData.message || 'Ошибка данных пользователя');\n\n        currentEditingUser = userData.data;\n        console.log(currentEditingUser);\n\n\n        const modalElement = document.getElementById('editUserModal');\n        if (!modalElement) {\n            throw new Error('Модальное окно не найдено в DOM');\n        }\n\n        // Показываем модальное окно\n        const modal = new bootstrap.Modal(modalElement);\n\n        $('#editUserName').text(`${currentEditingUser[\"firstName\"]} ${currentEditingUser[\"lastName\"]}`);\n        $('#editUserUsername').text(`${currentEditingUser.username}`);\n        $('#editUserDepartment').val(`${currentEditingUser['department']}`);\n        $('#editUserJobTitle').val(`${currentEditingUser['jobTitle']}`);\n        $('#editUserQualification').val(`${currentEditingUser['qualification']}`);\n        $('#userIdForUpdate').val(`${currentEditingUser['id']}`);\n\n        // noinspection JSUnresolvedReference\n        modal.show();\n\n    } catch (error) {\n        console.error('Ошибка открытия модального окна:', error);\n        showAlert('Не удалось открыть форму редактирования', 'error');\n    }\n}\n\n// Сохранение изменений\nasync function saveUserChanges() {\n    try {\n        const formData = {\n            userId: document.getElementById('userIdForUpdate').value,\n            department: document.getElementById('editUserDepartment').value,\n            jobTitle: document.getElementById('editUserJobTitle').value,\n            qualification: document.getElementById('editUserQualification').value,\n            role: document.getElementById('editUserRole').value\n        };\n\n        console.log(formData);\n\n        const response = await fetch('/admin/user/update', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'X-CSRF-TOKEN': getCsrfToken()\n            },\n            body: JSON.stringify(formData)\n        });\n\n        const result = await response.json();\n        console.log(result);\n\n        if (response.ok && result.success) {\n            showAlert('Данные успешно обновлены!', 'success');\n\n            // Закрываем модальное окно\n            const modal = bootstrap.Modal.getInstance(document.getElementById('editUserModal'));\n            modal.hide();\n\n            // Обновляем таблицу пользователей\n            void loadUsers();\n\n        } else {\n            // Обработка ошибок валидации\n            if (result.errors) {\n                displayValidationErrors(result.errors);\n            } else {\n                showAlert(result.error || 'Ошибка при сохранении данных', 'error');\n            }\n        }\n\n    } catch (error) {\n        console.error('Ошибка сохранения:', error);\n        showAlert('Произошла ошибка при сохранении данных', 'error');\n    }\n}\n\n// Функция для отображения ошибок валидации\nfunction displayValidationErrors(errors) {\n    let errorMessages = [];\n\n    // Проходим по всем ошибкам и собираем сообщения\n    for (const [field, message] of Object.entries(errors)) {\n        errorMessages.push(`${getFieldDisplayName(field)}: ${message}`);\n    }\n\n    if (errorMessages.length > 0) {\n        showAlert('Ошибки валидации:\\n' + errorMessages.join('\\n'), 'error');\n    }\n}\n\n// Функция для получения читаемого имени поля\nfunction getFieldDisplayName(field) {\n    const fieldNames = {\n        'userId': 'ID пользователя',\n        'department': 'Отдел',\n        'jobTitle': 'Должность',\n        'qualification': 'Квалификация',\n        'role': 'Роль'\n    };\n\n    return fieldNames[field] || field;\n}\n\n// Функция для получения CSRF токена\nfunction getCsrfToken() {\n    return document.querySelector('meta[name=\"_csrf\"]')?.getAttribute('content') || '';\n}\n\n// Инициализация при загрузке страницы\ndocument.addEventListener('DOMContentLoaded', function() {\n    document.getElementById('saveUserChangesBtn').addEventListener('click', saveUserChanges);\n});\n\n// Обновите функцию editUser в основном скрипте\nfunction editUser(userId) {\n    void openEditUserModal(userId);\n}\n\nwindow.editUser = editUser;\n","let currentPageUsers = 1;\nlet totalPagesUsers = 1;\nlet totalItemsUsers = 0;\nlet usersPerPage = 10; // Default page size\nlet roleFilter = 'ALL'; // Default role filter\n\nasync function loadUsers(page = 1, size = usersPerPage, role = roleFilter) {\n    console.log(\"Refresh button clicked. Calling loadUsers.\"); // Added for debugging\n    try {\n        console.log(`Загрузка пользователей: страница ${page}, размер ${size}, роль ${role}`);\n        const response = await fetch(`/admin/users?page=${page}&size=${size}&role=${role}`);\n\n        if (response.ok) {\n            const data = await response.json();\n            if (data.success && data.data) {\n                currentPageUsers = data.data.currentPage || page;\n                totalPagesUsers = data.data.totalPages || 1;\n                totalItemsUsers = data.data.totalItems || data.data.content.length;\n\n                renderUsersTable(data.data.content);\n            } else {\n                throw new Error(\"Неверный формат данных от сервера\");\n            }\n        } else {\n            throw new Error(`Ошибка сервера: ${response.status}`);\n        }\n    } catch (e) {\n        console.error('Ошибка загрузки пользователей:', e);\n        showError('Не удалось загрузить данные пользователей');\n    }\n}\n\nfunction rowsInUserTable(size) {\n    usersPerPage = parseInt(size, 10);\n    loadUsers(1, usersPerPage, roleFilter);\n}\n\nfunction filterByUserRole(role) {\n    roleFilter = role;\n    loadUsers(1, usersPerPage, roleFilter);\n}\n\nasync function deleteUsersRequest(userId) {\n    try {\n        const body = JSON.stringify({ userId: userId });\n        const deleteRequest = await fetch(`/admin/users/delete`, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: body\n        });\n\n        const response = await deleteRequest.json();\n        console.log(response)\n\n        if (deleteRequest.ok) {\n            if (response.success) {\n                const successMessage = response.message || response.data;\n                showAlert(successMessage, 'success');\n                // Перезагружаем список пользователей\n                await loadUsers(currentPageUsers, usersPerPage, roleFilter);\n            } else {\n                showAlert(response.message, 'error');\n            }\n        } else {\n            showAlert(`Ошибка сервера: ${response.error || 'Неизвестная ошибка'}`, 'error');\n        }\n    } catch (error) {\n        showAlert(`Ошибка удаления: ${error.message}`, 'error');\n        console.error('Delete error:', error);\n    }\n}\n\nfunction renderUsersTable(users) {\n    const tableContainer = document.querySelector('#users-tab .card-body');\n    if (!tableContainer) {\n        console.error('Контейнер для таблицы не найден');\n        return;\n    }\n    tableContainer.innerHTML = '';\n\n    const tableHTML = `\n    <div class=\"users-table-container\">\n        <div class=\"data-table users-table\">\n            <div class=\"table-header d-flex justify-content-between align-items-center\">\n                <h3 class=\"table-title\">Список пользователей</h3>\n                <div class=\"table-header-actions d-flex align-items-center\" style=\"gap: 1rem;\">\n                    <div class=\"input-group\">\n                        <span class=\"input-group-text\"><i class=\"bi bi-people\"></i></span>\n                        <select class=\"form-select form-select-sm\" id=\"roleFilter\" onchange=\"filterByUserRole(this.value)\">\n                            <option value=\"ALL\" ${roleFilter === 'ALL' ? 'selected' : ''}>Все роли</option>\n                            <option value=\"USER\" ${roleFilter === 'USER' ? 'selected' : ''}>Пользователь</option>\n                            <option value=\"ADMIN\" ${roleFilter === 'ADMIN' ? 'selected' : ''}>Администратор</option>\n                        </select>\n                    </div>\n                    <div class=\"input-group\">\n                        <span class=\"input-group-text\">Показывать</span>\n                        <select class=\"form-select form-select-sm\" id=\"pageSizeSelect\" onchange=\"rowsInUserTable(this.value)\">\n                            <option value=\"5\" ${usersPerPage == 5 ? 'selected' : ''}>5</option>\n                            <option value=\"10\" ${usersPerPage == 10 ? 'selected' : ''}>10</option>\n                            <option value=\"20\" ${usersPerPage == 20 ? 'selected' : ''}>20</option>\n                            <option value=\"50\" ${usersPerPage == 50 ? 'selected' : ''}>50</option>\n                        </select>\n                    </div>\n                </div>\n            </div>\n            \n            <div class=\"table-content\">\n                <!-- Заголовок таблицы -->\n                <div class=\"table-row header-row\">\n                    <div class=\"table-cell\">ID</div>\n                    <div class=\"table-cell\">Аватар</div>\n                    <div class=\"table-cell\">Имя</div>\n                    <div class=\"table-cell\">Фамилия</div>\n                    <div class=\"table-cell\">Отдел</div>\n                    <div class=\"table-cell\">Должность</div>\n                    <div class=\"table-cell\">Квалификация</div>\n                    <div class=\"table-cell\">Логин</div>\n                    <div class=\"table-cell\">Создан</div>\n                    <div class=\"table-cell\">Роль</div>\n                    <div class=\"table-cell\">Действия</div>\n                </div>\n                \n                ${users.length > 0 ? users.map(user => `\n                    <div class=\"table-row\">\n                        <div class=\"table-cell text-muted\">#${user.id || 'N/A'}</div>\n                        <div class=\"table-cell\">\n                            <img src=\"/avatars/${user.avatar || 'avatar.png'}\" alt=\"Аватар\" class=\"user-avatar\">\n                        </div>\n                        <div class=\"table-cell\">${escapeHtml(user.firstName || 'Не указано')}</div>\n                        <div class=\"table-cell\">${escapeHtml(user.lastName || 'Не указано')}</div>\n                        <div class=\"table-cell\">${escapeHtml(user.department || 'Не указан')}</div>\n                        <div class=\"table-cell\">${escapeHtml(user.jobTitle || 'Не указана')}</div>\n                        <div class=\"table-cell\">\n                            <span class=\"status-badge ${getQualificationClass(user.qualification)}\">\n                                ${escapeHtml(user.qualification || 'Не указана')}\n                            </span>\n                        </div>\n                        <div class=\"table-cell\">${escapeHtml(user.username || 'Не указан')}</div>\n                        <div class=\"table-cell text-sm text-muted\">${formatDate(user.createdAt)}</div>\n                        <div class=\"table-cell\">${displayRoles(user.role)}</div>\n                        <div class=\"table-cell action-buttons justify-content-center\">\n                            <button class=\"btn btn-primary btn-icon btn-sm\" title=\"Редактировать\" onclick=\"editUser(${user.id})\">\n                                <i class=\"bi bi-pencil\"></i>\n                            </button>\n                            <button class=\"btn btn-danger btn-icon btn-sm\" title=\"Удалить\" onclick=\"deleteUser(${user.id})\">\n                                <i class=\"bi bi-trash\"></i>\n                            </button>\n                            <button class=\"btn btn-success btn-icon btn-sm\" title=\"Записать на курс\" onclick=\"openEnrollModal(${user.id}, '${escapeHtml(user.firstName)} ${escapeHtml(user.lastName)}')\">\n                                <i class=\"bi bi-plus-circle\"></i>\n                            </button>\n                            <button class=\"btn btn-info btn-icon btn-sm\" title=\"Просмотр курсов\" onclick=\"openViewCoursesModal(${user.id}, '${escapeHtml(user.firstName)} ${escapeHtml(user.lastName)}')\">\n                                <i class=\"bi bi-card-list\"></i>\n                            </button>\n                        </div>\n                    </div>\n                `).join('') : `\n                    <div class=\"table-row\" style=\"grid-template-columns: 1fr;\">\n                        <div class=\"text-center py-4 text-muted\">\n                            <i class=\"bi bi-inbox fs-3 d-block mb-2\"></i>\n                            Пользователи не найдены\n                        </div>\n                    </div>\n                `}\n            </div>\n        </div>\n    </div>\n        \n    <!-- Контейнер для пагинации -->\n    <div class=\"pagination-container mt-3\"></div>\n    \n    <!-- Кнопка обновления -->\n    <div class=\"text-center mt-3\">\n        <button class=\"btn btn-primary\" onclick=\"refreshUsersTable()\">\n            <i class=\"bi bi-arrow-repeat\"></i> Обновить список\n        </button>\n    </div>\n    `;\n\n    tableContainer.innerHTML = tableHTML;\n\n    const paginationContainer = document.querySelector('#users-tab .pagination-container');\n    if (!paginationContainer) {\n        console.error('Контейнер для пагинации не найден');\n        return;\n    }\n    if (totalPagesUsers <= 1) {\n        paginationContainer.innerHTML = '';\n        return;\n    }\n\n    let paginationHTML = `\n        <nav aria-label=\"Page navigation\">\n            <ul class=\"pagination justify-content-center\">\n                <li class=\"page-item ${currentPageUsers === 1 ? 'disabled' : ''}\">\n                    <a class=\"page-link\" href=\"#\" onclick=\"changeUsersPage(${currentPageUsers - 1}); return false;\" aria-label=\"Previous\">\n                        <span aria-hidden=\"true\">&laquo;</span>\n                    </a>\n                </li>\n    `;\n\n    const maxVisiblePages = 5;\n    let startPage = Math.max(1, currentPageUsers - Math.floor(maxVisiblePages / 2));\n    let endPage = Math.min(totalPagesUsers, startPage + maxVisiblePages - 1);\n\n    if (endPage - startPage + 1 < maxVisiblePages) {\n        startPage = Math.max(1, endPage - maxVisiblePages + 1);\n    }\n\n    if (startPage > 1) {\n        paginationHTML += `\n            <li class=\"page-item\">\n                <a class=\"page-link\" href=\"#\" onclick=\"changeUsersPage(1); return false;\">1</a>\n            </li>\n            ${startPage > 2 ? '<li class=\"page-item disabled\"><span class=\"page-link\">...</span></li>' : ''}\n        `;\n    }\n\n    for (let i = startPage; i <= endPage; i++) {\n        paginationHTML += `\n            <li class=\"page-item ${i === currentPageUsers ? 'active' : ''}\">\n                <a class=\"page-link\" href=\"#\" onclick=\"changeUsersPage(${i}); return false;\">${i}</a>\n            </li>\n        `;\n    }\n\n    if (endPage < totalPagesUsers) {\n        paginationHTML += `\n            ${endPage < totalPagesUsers - 1 ? '<li class=\"page-item disabled\"><span class=\"page-link\">...</span></li>' : ''}\n            <li class=\"page-item\">\n                <a class=\"page-link\" href=\"#\" onclick=\"changeUsersPage(${totalPagesUsers}); return false;\">${totalPagesUsers}</a>\n            </li>\n        `;\n    }\n\n    paginationHTML += `\n                <li class=\"page-item ${currentPageUsers === totalPagesUsers ? 'disabled' : ''}\">\n                    <a class=\"page-link\" href=\"#\" onclick=\"changeUsersPage(${currentPageUsers + 1}); return false;\" aria-label=\"Next\">\n                        <span aria-hidden=\"true\">&raquo;</span>\n                    </a>\n                </li>\n            </ul>\n        </nav>\n        \n        <div class=\"pagination-info text-center mt-2\">\n            <small class=\"text-muted\">\n                Страница ${currentPageUsers} из ${totalPagesUsers} • \n                Всего пользователей: ${totalItemsUsers}\n            </small>\n        </div>\n    `;\n    paginationContainer.innerHTML = paginationHTML;\n}\n\nfunction changeUsersPage(page) {\n    if (page < 1 || page > totalPagesUsers || page === currentPageUsers) return;\n    loadUsers(page, usersPerPage, roleFilter);\n}\n\n\n// Вспомогательные функции\nfunction escapeHtml(text) {\n    if (text === null || text === undefined) return '';\n    const div = document.createElement('div');\n    div.textContent = text;\n    return div.innerHTML;\n}\n\nfunction formatDate(dateString) {\n    if (!dateString) return 'Не указано';\n\n    try {\n        const date = new Date(dateString);\n        return date.toLocaleDateString('ru-RU', {\n            year: 'numeric',\n            month: '2-digit',\n            day: '2-digit'\n        });\n    } catch (e) {\n        return dateString;\n    }\n}\n\nfunction getQualificationClass(qualification) {\n    if (!qualification) return 'status-pending';\n\n    const qual = qualification.toLowerCase();\n    if (qual.includes('expert') || qual.includes('senior') || qual.includes('lead')) {\n        return 'status-completed';\n    } else if (qual.includes('middle') || qual.includes('intermediate')) {\n        return 'status-review';\n    } else if (qual.includes('junior') || qual.includes('trainee')) {\n        return 'status-pending';\n    } else {\n        return 'status-pending';\n    }\n}\n\nfunction displayRoles(role) {\n    return role === '[ROLE_USER]' ? 'Пользователь' : 'Администратор';\n}\n\nfunction showError(message) {\n    const tableContainer = document.querySelector('#users-tab .card-body');\n    if (tableContainer) {\n        tableContainer.innerHTML = `\n            <div class=\"alert alert-danger\" role=\"alert\">\n                <i class=\"fas fa-exclamation-triangle\"></i>\n                ${escapeHtml(message)}\n            </div>\n            <div style=\"text-align: center; margin-top: 1rem;\">\n                <button class=\"btn btn-primary\" onclick=\"loadUsers(1)\">\n                    <i class=\"fas fa-redo\"></i> Попробовать снова\n                </button>\n            </div>\n        `;\n    }\n}\n\nfunction deleteUser(userId) {\n    if (confirm('Вы уверены, что хотите удалить этого пользователя?')) {\n        deleteUsersRequest(userId)\n    }\n}\n\n// Функция для открытия модального окна\nasync function openEnrollModal(userId, userName) {\n    // 1. Устанавливаем имя и ID пользователя в модальном окне\n    document.getElementById('enrollUserName').textContent = userName;\n    document.getElementById('enrollUserId').value = userId;\n\n    const courseSelect = document.getElementById('courseSelect');\n    courseSelect.innerHTML = '<option>Загрузка курсов...</option>';\n\n    // 2. Показываем модальное окно\n    const modal = new bootstrap.Modal(document.getElementById('enrollUserModal'));\n    modal.show();\n\n    // 3. Загружаем список курсов с бэкенда\n    try {\n        const response = await fetch('/admin/courses');\n        const data = await response.json();\n        console.log(data)\n\n        if (data.success && data.data && data.data.content) {\n            courseSelect.innerHTML = ''; // Очищаем\n            if (data.data.content.length === 0) {\n                courseSelect.innerHTML = '<option>Нет доступных курсов</option>';\n            } else {\n                data.data.content.forEach(course => {\n                    const option = document.createElement('option');\n                    option.value = course.id;\n                    option.textContent = course.title;\n                    courseSelect.appendChild(option);\n                });\n            }\n        }\n    } catch (e) {\n        courseSelect.innerHTML = '<option>Ошибка загрузки курсов</option>';\n        console.error(e);\n    }\n}\n\n// Функция для подтверждения и отправки запроса\nasync function confirmEnrollment() {\n    const userId = document.getElementById('enrollUserId').value;\n    const courseId = document.getElementById('courseSelect').value;\n\n    if (!courseId || isNaN(courseId)) {\n        alert('Пожалуйста, выберите курс.');\n        return;\n    }\n\n    const requestData = {\n        userId: parseInt(userId),\n        courseId: parseInt(courseId)\n    };\n\n    console.log(\"enrollment data \",requestData)\n\n    try {\n        const response = await fetch('/admin/user/enroll', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify(requestData)\n        });\n\n        const result = await response.json();\n\n        if (response.ok && result.success) {\n            showAlert(result.message);\n            // Закрываем модальное окно\n            const modal = bootstrap.Modal.getInstance(document.getElementById('enrollUserModal'));\n            modal.hide();\n        } else {\n            showAlert(`Ошибка: ${result.message || 'Не удалось записать пользователя.'}`, 'error');\n        }\n    } catch (e) {\n        showAlert('Ошибка сервера', 'error');\n        console.error(e);\n    }\n}\n\nasync function openViewCoursesModal(userId, userName) {\n    document.getElementById('viewUserName').textContent = userName;\n    const userCoursesList = document.getElementById('userCoursesList');\n    userCoursesList.innerHTML = '<li class=\"list-group-item\">Загрузка курсов...</li>';\n\n    // Сохраняем данные для перезагрузки\n    userCoursesList.dataset.userId = userId;\n    userCoursesList.dataset.userName = userName;\n\n    const modal = new bootstrap.Modal(document.getElementById('viewUserCoursesModal'));\n    modal.show();\n\n    await refreshUserCoursesList(userId, userName);\n}\n\nasync function refreshUserCoursesList(userId, userName) {\n    const userCoursesList = document.getElementById('userCoursesList');\n    userCoursesList.innerHTML = '<li class=\"list-group-item\">Загрузка курсов...</li>';\n\n    try {\n        const response = await fetch(`/admin/user/${userId}/courses`);\n        const data = await response.json();\n\n        if (data.success && data.data) {\n            userCoursesList.innerHTML = '';\n            if (data.data.length === 0) {\n                userCoursesList.innerHTML = '<li class=\"list-group-item\">Пользователь не записан ни на один курс.</li>';\n            } else {\n                data.data.forEach(course => {\n                    const listItem = document.createElement('li');\n                    listItem.className = 'list-group-item d-flex justify-content-between align-items-center';\n\n                    const titleSpan = document.createElement('span');\n                    titleSpan.textContent = course.title;\n                    listItem.appendChild(titleSpan);\n\n                    const unenrollButton = document.createElement('button');\n                    unenrollButton.className = 'btn btn-danger btn-sm';\n                    unenrollButton.textContent = 'Отписать';\n                    unenrollButton.onclick = () => confirmUnenrollment(userId, userName, course.id, course.title);\n                    listItem.appendChild(unenrollButton);\n\n                    userCoursesList.append(listItem);\n                });\n            }\n        } else {\n            userCoursesList.innerHTML = '<li class=\"list-group-item text-danger\">Ошибка загрузки курсов.</li>';\n            console.error('Failed to load user courses:', data.error);\n        }\n    } catch (e) {\n        userCoursesList.innerHTML = '<li class=\"list-group-item text-danger\">Ошибка сервера.</li>';\n        console.error('Network error loading user courses:', e);\n    }\n}\n\nfunction confirmUnenrollment(userId, userName, courseId, courseTitle) {\n    const message = `Вы уверены, что хотите отписать пользователя \"${userName}\" от курса \"${courseTitle}\"?`;\n    if (confirm(message)) {\n        unenrollRequest(userId, courseId, userName);\n    }\n}\n\nasync function unenrollRequest(userId, courseId, userName) {\n    const requestData = { userId, courseId };\n\n    try {\n        const response = await fetch('/admin/user/unenroll', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify(requestData)\n        });\n\n        const result = await response.json();\n\n        if (response.ok && result.success) {\n            alert(result.message);\n            // Обновляем список курсов в модальном окне\n            await refreshUserCoursesList(userId, userName);\n        } else {\n            showAlert(`Ошибка: ${result.message || 'Не удалось отписать пользователя.'}`, 'error');\n        }\n    } catch (e) {\n        showAlert('Ошибка сервера', 'error');\n        console.error(e);\n    }\n}\n\n// Инициализация\n\ndocument.addEventListener('DOMContentLoaded', function() {\n    // Загружаем пользователей при загрузке страницы\n    const usersTab = document.getElementById('users-tab');\n    if (usersTab) {\n        loadUsers(1, usersPerPage, roleFilter);\n    }\n});\n\n// Expose functions to global scope for onclick attributes\nwindow.loadUsers = loadUsers;\nwindow.deleteUser = deleteUser;\nwindow.openEnrollModal = openEnrollModal;\nwindow.confirmEnrollment = confirmEnrollment;\nwindow.openViewCoursesModal = openViewCoursesModal;\nwindow.confirmUnenrollment = confirmUnenrollment;\nwindow.unenrollRequest = unenrollRequest;\nwindow.changeUsersPage = changeUsersPage;\nwindow.currentPageUsers = currentPageUsers;\nwindow.rowsInUserTable = rowsInUserTable;\nwindow.filterByUserRole = filterByUserRole;\nwindow.refreshUsersTable = function() {\n    loadUsers(currentPageUsers, usersPerPage, roleFilter);\n};","let currentDocsPage = 1;\nlet totalDocsPages = 1;\nlet totalDocsItems = 0;\nlet docsPerPage = 5;\nlet currentSortBy = 'id'; // Default sort by ID\nlet currentSortDir = 'asc'; // Default sort direction ascending\n\nasync function loadCoursesForFilter() {\n    try {\n        const response = await fetch('/admin/documents/courses');\n        if (!response.ok) {\n            return null;\n        }\n        const result = await response.json();\n        console.log(result)\n        if (result.success && result.data) {\n            const select = document.getElementById('courseFilterSelect');\n            if (!select) return;\n\n            const currentFilter = select.value;\n\n            select.innerHTML = '<option value=\"\">Все курсы</option>';\n            result.data.forEach(course => {\n                const option = document.createElement('option');\n                option.value = course.id;\n                option.textContent = course.title;\n                select.appendChild(option);\n            });\n\n            if (currentFilter) {\n                select.value = currentFilter;\n            }\n        } else {\n            return null;\n        }\n    } catch (error) {\n        showAlert('Не удалось загрузить фильтр курсов.', 'warning');\n    }\n}\n\nasync function loadCategoriesForFilter() {\n    try {\n        const response = await fetch('/admin/documents/categories');\n        if (!response.ok) {\n            return null;\n        }\n        const result = await response.json();\n        console.log(result)\n        if (result.success && result.data) {\n            const select = document.getElementById('categoryFilterSelect');\n            if (!select) return;\n\n            const currentFilter = select.value;\n\n            select.innerHTML = '<option value=\"\">Все категории</option>';\n            result.data.forEach(category => {\n                const option = document.createElement('option');\n                option.value = category.id;\n                option.textContent = category.name;\n                select.appendChild(option);\n            });\n\n            if (currentFilter) {\n                select.value = currentFilter;\n            }\n        } else {\n            return null;\n        }\n    } catch (error) {\n        showAlert('Не удалось загрузить фильтр категорий.', 'warning');\n    }\n}\n\nasync function loadDocuments(page = 1) {\n    console.log('loadDocuments called. Current docsPerPage:', docsPerPage);\n    try {\n        showLoading(true);\n\n        const courseId = document.getElementById('courseFilterSelect')?.value || '';\n        const categoryId = document.getElementById('categoryFilterSelect')?.value || '';\n\n        let url = `/admin/documents?page=${page}&size=${docsPerPage}`;\n        if (courseId) {\n            url += `&courseId=${courseId}`;\n            console.log('Filtering by Course ID:', courseId);\n        }\n        if (categoryId) {\n            url += `&categoryId=${categoryId}`;\n            console.log('Filtering by Category ID:', categoryId);\n        }\n        console.log('Fetching documents from URL:', url);\n\n        const response = await fetch(url);\n\n        if (response.ok) {\n            const result = await response.json();\n            console.log('Documents API Response:', result);\n\n            if (result.success && result.data) {\n                const paginatedData = result.data;\n                console.log('Paginated Data Content:', paginatedData.content);\n                currentDocsPage = paginatedData.currentPage || page;\n                totalDocsPages = paginatedData.totalPages || 1;\n                totalDocsItems = paginatedData.totalItems || 0;\n\n                renderDocumentsTable(paginatedData.content);\n                renderDocumentsPagination(paginatedData.content);\n            } else {\n                showAlert(result.message || 'Неверный формат данных', 'error');\n            }\n        } else {\n            if (response.status === 404) {\n                renderDocumentsTable([]);\n                renderDocumentsPagination([]);\n            } else {\n                return null;\n            }\n        }\n    } catch (error) {\n        showAlert(error.message, 'error');\n    } finally {\n        showLoading(false);\n    }\n}\n\nfunction renderDocumentsTable(documents) {\n    const container = document.getElementById('documentsContainer');\n    if (!container) {\n        return;\n    }\n\n    container.innerHTML = '';\n\n    const tableWrapper = document.createElement('div');\n    tableWrapper.className = 'documents-table-container';\n\n    tableWrapper.innerHTML = `\n        <div class=\"data-table documents-table\">\n            <div class=\"table-header d-flex justify-content-between align-items-center flex-wrap\">\n                <h3 class=\"table-title mb-2 mb-md-0\">Список документов</h3>\n            </div>\n\n            <div class=\"table-content\">\n                <div class=\"table-row header-row\">\n                    <div class=\"table-cell\">ID</div>\n                    <div class=\"table-cell\">Название</div>\n                    <div class=\"table-cell\">Курс</div>\n                    <div class=\"table-cell\">Категория</div>\n                    <div class=\"table-cell\">Теги</div>\n                    <div class=\"table-cell\">Действия</div>\n                </div>\n\n                ${documents.length > 0 ? documents.map(doc => `\n                <div class=\"table-row\">\n                    <div class=\"table-cell text-muted\">#${doc.id || 'N/A'}</div>\n                    <div class=\"table-cell\">\n                        <div class=\"fw-bold\">${escapeHtml(doc.name || 'Без названия')}</div>\n                    </div>\n                    <div class=\"table-cell\">\n                        <span class=\"text-muted\">${escapeHtml(doc.courseName || 'N/A')}</span>\n                    </div>\n                    <div class=\"table-cell\">\n                        <span class=\"text-muted\">${escapeHtml(doc.categoryName || 'N/A')}</span>\n                    </div>\n                    <div class=\"table-cell\">\n                        <span class=\"text-muted\">${truncateText(doc.tags || 'Нет тегов', 50)}</span>\n                    </div>\n                    <div class=\"table-cell action-buttons\">\n                        ${doc.file ? `<a href=\"/docs/${doc.file}\" class=\"btn btn-success btn-icon btn-sm\" title=\"Открыть файл\" target=\"_blank\"><i class=\"bi bi-eye\"></i></a>` : ''}\n                        <button class=\"btn btn-info btn-icon btn-sm edit-doc-btn\" title=\"Редактировать\" data-doc-id=\"${doc.id}\">\n                            <i class=\"bi bi-pencil\"></i>\n                        </button>\n                        <button class=\"btn btn-danger btn-icon btn-sm\" title=\"Удалить\"\n                                onclick=\"deleteDocument(${doc.id}, '${escapeHtml(doc.name)}')\">\n                            <i class=\"bi bi-trash\"></i>\n                        </button>\n                    </div>\n                </div>\n                `).join('') : `\n                <div class=\"table-row\">\n                    <div class=\"table-cell\" style=\"grid-column: 1 / -1; text-align: center; padding: 2rem; color: #94a3b8;\">\n                        <i class=\"bi bi-file-earmark-text me-2\"></i>\n                        Документы не найдены. Измените фильтр или добавьте новый документ.\n                    </div>\n                </div>\n                `}\n            </div>\n        </div>\n    `;\n    container.appendChild(tableWrapper);\n}\n\nfunction renderDocumentsPagination(documents) {\n    console.log('Rendering documents pagination with:', documents);\n    const container = document.getElementById('documentsPagination');\n    if (!container) {\n        return;\n    }\n\n    if (totalDocsPages <= 1) {\n        container.innerHTML = '';\n        return;\n    }\n\n    let paginationHTML = `\n        <nav aria-label=\"Page navigation\">\n            <ul class=\"pagination justify-content-center\">\n                <li class=\"page-item ${currentDocsPage === 1 ? 'disabled' : ''}\">\n                    <a class=\"page-link\" href=\"#\" onclick=\"changeDocsPage(${currentDocsPage - 1}); return false;\">&laquo;</a>\n                </li>\n    `;\n\n    const maxVisiblePages = 5;\n    let startPage = Math.max(1, currentDocsPage - Math.floor(maxVisiblePages / 2));\n    let endPage = Math.min(totalDocsPages, startPage + maxVisiblePages - 1);\n\n    if (endPage - startPage + 1 < maxVisiblePages) {\n        startPage = Math.max(1, endPage - maxVisiblePages + 1);\n    }\n\n    if (startPage > 1) {\n        paginationHTML += `<li class=\"page-item\"><a class=\"page-link\" href=\"#\" onclick=\"changeDocsPage(1); return false;\">1</a></li>`;\n        if (startPage > 2) {\n            paginationHTML += `<li class=\"page-item disabled\"><span class=\"page-link\">...</span></li>`;\n        }\n    }\n\n    for (let i = startPage; i <= endPage; i++) {\n        paginationHTML += `<li class=\"page-item ${i === currentDocsPage ? 'active' : ''}\"><a class=\"page-link\" href=\"#\" onclick=\"changeDocsPage(${i}); return false;\">${i}</a></li>`;\n    }\n\n    if (endPage < totalDocsPages) {\n        if (endPage < totalDocsPages - 1) {\n            paginationHTML += `<li class=\"page-item disabled\"><span class=\"page-link\">...</span></li>`;\n        }\n        paginationHTML += `<li class=\"page-item\"><a class=\"page-link\" href=\"#\" onclick=\"changeDocsPage(${totalDocsPages}); return false;\">${totalDocsPages}</a></li>`;\n    }\n\n    paginationHTML += `\n                <li class=\"page-item ${currentDocsPage === totalDocsPages ? 'disabled' : ''}\">\n                    <a class=\"page-link\" href=\"#\" onclick=\"changeDocsPage(${currentDocsPage + 1}); return false;\">&raquo;</a>\n                </li>\n            </ul>\n        </nav>\n        \n        <div class=\"pagination-info text-center mt-2\">\n            <small class=\"text-muted\">\n                Страница ${currentDocsPage} из ${totalDocsPages} • Показано ${documents.length} из ${totalDocsItems} документов\n            </small>\n        </div>\n    `;\n\n    container.innerHTML = paginationHTML;\n}\n\nfunction changeDocsPage(page) {\n    if (page < 1 || page > totalDocsPages || page === currentDocsPage) return;\n    void loadDocuments(page);\n}\n\nfunction changeDocsPerPage(perPage) {\n    console.log('changeDocsPerPage called with:', perPage);\n    docsPerPage = parseInt(perPage) || 10;\n    console.log('docsPerPage set to:', docsPerPage);\n    void loadDocuments(1);\n}\n\nfunction showLoading(show) {\n    const container = document.getElementById('documentsContainer');\n    if (!container) return;\n\n    if (show) {\n        container.innerHTML = `\n            <div class=\"d-flex justify-content-center align-items-center\" style=\"height: 200px;\">\n                <div class=\"spinner-border text-primary\" role=\"status\">\n                    <span class=\"visually-hidden\">Загрузка...</span>\n                </div>\n            </div>\n        `;\n    }\n}\n\nfunction truncateText(text, maxLength) {\n    if (!text || text.length <= maxLength) return escapeHtml(text || '');\n    return escapeHtml(text.substring(0, maxLength)) + '...';\n}\n\nfunction escapeHtml(text) {\n    if (typeof text !== 'string') return '';\n    const div = document.createElement('div');\n    div.textContent = text;\n    return div.innerHTML;\n}\n\nasync function deleteDocument(docId, docName) {\n    if (!confirm(`Вы уверены, что хотите удалить документ \"${docName}\"?`)) {\n        return;\n    }\n\n    try {\n        const headers = {\n            'Content-Type': 'application/json'\n        };\n\n        const response = await fetch(`/admin/documents/${docId}/delete`, {\n            method: 'DELETE',\n            headers: headers\n        });\n\n        const result = await response.json().catch(() => ({}));\n\n        if (response.ok && result.success) {\n            showAlert(`Документ \"${docName}\" успешно удален.`, 'success');\n            void loadDocuments(currentDocsPage || 1);\n        } else {\n            const errorMessage = result.message || `Ошибка удаления: ${response.status}`;\n            showAlert(errorMessage, 'error');\n        }\n\n    } catch (error) {\n        showAlert(error.message, 'error');\n    }\n}\n\nasync function openCreateDocumentModal() {\n    const modalElement = document.getElementById('createDocumentModal');\n    if (!modalElement) {\n        console.error('Create document modal not found');\n        return;\n    }\n    const modal = new bootstrap.Modal(modalElement);\n    const form = document.getElementById('createDocumentForm');\n    form.reset();\n\n    const courseSelect = document.getElementById('docCourse');\n    const categorySelect = document.getElementById('docCategory');\n\n    // Reset and disable category select\n    categorySelect.innerHTML = '<option value=\"\">Сначала выберите курс</option>';\n    categorySelect.disabled = true;\n\n    // Load Courses\n    try {\n        const courseResponse = await fetch('/admin/documents/courses');\n        const courseResult = await courseResponse.json();\n        if (courseResult.success && courseResult.data) {\n            courseSelect.innerHTML = '<option value=\"\" disabled selected>Выберите курс</option>';\n            courseResult.data.forEach(course => {\n                const option = document.createElement('option');\n                option.value = course.id;\n                option.textContent = course.title;\n                courseSelect.appendChild(option);\n            });\n        } else {\n            courseSelect.innerHTML = '<option value=\"\">Не удалось загрузить курсы</option>';\n        }\n    } catch (error) {\n        courseSelect.innerHTML = '<option value=\"\">Ошибка загрузки</option>';\n    }\n\n    modal.show();\n}\n\nasync function handleCourseChangeForModal(courseId) {\n    const categorySelect = document.getElementById('docCategory');\n    if (!courseId) {\n        categorySelect.innerHTML = '<option value=\"\">Сначала выберите курс</option>';\n        categorySelect.disabled = true;\n        return;\n    }\n\n    categorySelect.innerHTML = '<option value=\"\">Загрузка категорий...</option>';\n    categorySelect.disabled = false;\n\n    try {\n        const response = await fetch(`/admin/documents/categories?courseId=${courseId}`);\n        const result = await response.json();\n\n        if (result.success && result.data && result.data.length > 0) {\n            categorySelect.innerHTML = '<option value=\"\" disabled selected>Выберите категорию</option>';\n            result.data.forEach(category => {\n                const option = document.createElement('option');\n                option.value = category.id;\n                option.textContent = category.name;\n                categorySelect.appendChild(option);\n            });\n        } else {\n            categorySelect.innerHTML = '<option value=\"\">Категории не найдены</option>';\n        }\n    } catch (error) {\n        categorySelect.innerHTML = '<option value=\"\">Ошибка загрузки категорий</option>';\n    }\n}\n\nasync function handleCreateDocumentSubmit(event) {\n    event.preventDefault();\n    const form = event.target;\n    const formData = new FormData(form);\n    const submitButton = form.closest('.modal-content').querySelector('button[type=\"submit\"]');\n\n    submitButton.disabled = true;\n    submitButton.innerHTML = '<span class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span> Создание...';\n\n    try {\n        const response = await fetch('/admin/documents/create', {\n            method: 'POST',\n            body: formData\n        });\n\n        const result = await response.json();\n\n        if (response.ok && result.success) {\n            showAlert('Документ успешно создан!', 'success');\n            const modal = bootstrap.Modal.getInstance(document.getElementById('createDocumentModal'));\n            modal.hide();\n            await loadDocuments(1);\n        } else {\n            if (response.status === 400 && result.errors) {\n                let errorMessages = Object.values(result.errors).join(', ');\n                showAlert(`Ошибка валидации: ${errorMessages}`, 'error');\n            } else {\n                showAlert(result.message || 'Произошла ошибка при создании документа.', 'error');\n            }\n        }\n    } catch (error) {\n        showAlert('Сетевая ошибка или ошибка сервера.', 'error');\n    } finally {\n        submitButton.disabled = false;\n        submitButton.innerHTML = 'Создать';\n    }\n}\n\n\ndocument.addEventListener('DOMContentLoaded', function() {\n    const docsTabTrigger = document.querySelector('a[data-tab=\"docs-tab\"]');\n    if (docsTabTrigger) {\n        docsTabTrigger.addEventListener('click', function () {\n            setTimeout(() => loadDocuments(1), 10);\n        });\n\n        if (document.getElementById('docs-tab')?.classList.contains('active')) {\n            void loadDocuments(1);\n        }\n    }\n\n    const createDocumentForm = document.getElementById('createDocumentForm');\n    if (createDocumentForm) {\n        createDocumentForm.addEventListener('submit', handleCreateDocumentSubmit);\n    }\n\n    if (document.getElementById('docs-tab')?.classList.contains('active')) {\n        void loadDocuments(1);\n        void loadCoursesForFilter();\n        void loadCategoriesForFilter();\n    }\n});\n\nwindow.loadDocuments = loadDocuments;\nwindow.changeDocsPerPage = changeDocsPerPage;\nwindow.changeDocsPage = changeDocsPage;\nwindow.deleteDocument = deleteDocument;\nwindow.loadCoursesForFilter = loadCoursesForFilter;\nwindow.loadCategoriesForFilter = loadCategoriesForFilter;\nwindow.openCreateDocumentModal = openCreateDocumentModal;\nwindow.handleCourseChangeForModal = handleCourseChangeForModal;\n"],"names":["$acf390f92ce7de37$var$getOfferDescription","offerId","offerData","response","fetch","method","headers","ok","Error","status","json","$","text","userId","topic","description","modal","bootstrap","Modal","document","getElementById","show","error","console","alert","addEventListener","textContent","window","getOfferDescription","switchToView","viewType","addClass","removeClass","form","descriptionTextarea","charCount","uploadPlaceholder","fileInput","imagePreview","removeImageBtn","courseTitle","courseSlug","length","value","classList","add","remove","click","e","files","file","size","showAlert","reader","FileReader","onload","querySelector","src","target","result","style","display","readAsDataURL","isSlugManuallyEdited","generateSlugFromTitle","title","trim","translitMap","slug","toLowerCase","i","replace","resetForm","reset","event","preventDefault","stopPropagation","checkValidity","submitButton","originalButtonText","innerHTML","disabled","formData","FormData","body","errorData","Object","values","join","message","$85ba6f91ba0d98ed$var$currentPage","$85ba6f91ba0d98ed$var$totalPages","$85ba6f91ba0d98ed$var$totalItems","$85ba6f91ba0d98ed$var$coursesPerPage","$85ba6f91ba0d98ed$var$loadCourses","page","data","success","content","$85ba6f91ba0d98ed$var$renderCoursesTable","courses","tableContainer","map","course","id","image","$85ba6f91ba0d98ed$var$adaptiveCourseStatus","courseId","statusMap","bg","currentStatusInfo","dropdownItems","keys","s","newStatusInfo","$85ba6f91ba0d98ed$var$formatCourseDate","dropdownToggleElements","querySelectorAll","forEach","dropdownToggleEl","Dropdown","tableCells","cell","overflow","$85ba6f91ba0d98ed$var$renderPagination","paginationContainer","paginationHTML","startPage","Math","max","floor","maxVisiblePages","endPage","min","$85ba6f91ba0d98ed$var$deleteCourse","confirm","catch","setTimeout","$85ba6f91ba0d98ed$var$updateCourseStatus","currentStatusText","newStatus","newStatusText","JSON","stringify","errorMessage","dateString","date","Date","toLocaleDateString","year","month","day","$85ba6f91ba0d98ed$var$renderImageViewModal","$85ba6f91ba0d98ed$var$renderEditCourseModal","modalHTML","insertAdjacentHTML","$85ba6f91ba0d98ed$var$openEditCourseModal","modalElement","courseRow","imageUrl","$85ba6f91ba0d98ed$var$handleCourseUpdate","get","getInstance","hide","coursesTabTrigger","coursesContainer","contains","url","location","href","isInitialized","openAddCourseForm","tabLink","changeCoursesPerPage","perPage","parseInt","deleteCourse","changePage","openViewCourseImageModal","img","modalImg","alt","openEditCourseModal","handleCourseUpdate","updateCourseStatus","loadCourses","$f2e732684596b7fb$var$currentCourse","$f2e732684596b7fb$var$courseModules","$f2e732684596b7fb$var$openCourseModulesModal","Array","isArray","name","$f2e732684596b7fb$var$renderCourseModulesModal","modalContainer","$f2e732684596b7fb$var$createModulesModalElement","modalTitle","innerText","modulesList","module","index","moduleId","order","$f2e732684596b7fb$var$escapeHtml","div","createElement","addNewModule","editModule","manageCourse","showCourseModules","courseName","editLessonModal","editLessonForm","editButton","closest","lessonId","dataset","errorMsg","lessonData","videoUrl","initTinyMCE","tinymce","init","selector","plugins","toolbar","height","setup","editor","on","setContent","getContent","loadLessons","$8aed6ce0d400e0c5$var$modulesList","$8aed6ce0d400e0c5$var$loadModules","$8aed6ce0d400e0c5$var$populateModulesSelect","select","option","moduleStatus","moduleTitle","appendChild","$8aed6ce0d400e0c5$var$handleLessonSubmit","$8aed6ce0d400e0c5$var$validateLessonForm","reportValidity","$8aed6ce0d400e0c5$var$showLoading","append","includes","$8aed6ce0d400e0c5$var$resetForm","inputs","input","submitBtn","$8aed6ce0d400e0c5$var$openCreateLessonModal","$8aed6ce0d400e0c5$var$bindFormEvents","addButton","$8aed6ce0d400e0c5$var$formStyles","$8aed6ce0d400e0c5$var$styleSheet","head","openCreateLessonModal","testGeneratorTab","questionsContainer","testGeneratorForm","questionCounter","updateQuestionNumbers","allQuestions","question","addNewQuestion","newNode","createQuestionNode","questionIndex","questionId","node","className","answerIndex","generateTestCode","questionCards","generatedQuestions","isValid","card","questionText","answerInputs","correctAnswerRadio","answers","push","correct","code","q","RegExp","a","generatedCodeForCopy","tabObserver","MutationObserver","mutations","mutation","attributeName","children","observe","attributes","copyToClipboard","navigator","clipboard","writeText","then","err","$7a4ff3b4d48fe0c8$var$currentLessonsPage","$7a4ff3b4d48fe0c8$var$totalLessonsPages","$7a4ff3b4d48fe0c8$var$totalLessonsItems","$7a4ff3b4d48fe0c8$var$lessonsPerPage","$7a4ff3b4d48fe0c8$var$loadModulesForFilter","currentFilter","$7a4ff3b4d48fe0c8$var$loadLessons","$7a4ff3b4d48fe0c8$var$showLoading","paginatedData","currentPage","totalPages","totalItems","$7a4ff3b4d48fe0c8$var$renderLessonsTable","$7a4ff3b4d48fe0c8$var$renderLessonsPagination","lessons","container","tableWrapper","lesson","maxLength","$7a4ff3b4d48fe0c8$var$escapeHtml","substring","video","$7a4ff3b4d48fe0c8$var$deleteLesson","lessonTitle","$9b6a05fde002bfd2$var$openEditModuleModal","courseSelect","$9b6a05fde002bfd2$var$loadCoursesIntoSelect","$9b6a05fde002bfd2$var$submitEditModuleForm","loadModules","currentModulesPage","errors","errorMessages","selectElement","selectedCourseTitle","selected","$063ae47fa067d23e$var$loadModuleLessons","$063ae47fa067d23e$var$showLessonsModal","statusText","modalHtml","modalBody","moduleName","moduleSlug","lessonsTabTrigger","changeLessonsPerPage","changeLessonsPage","deleteLesson","editModuleForm","loadCoursesIntoSelect","submitEditModuleForm","openEditModuleModal","titleInput","slugInput","createModuleTab","slugRegex","test","csrfToken","csrfHeader","modulesTab","deleteModule","adminUpdateModuleStatus","moduleID","loadModuleLessons","viewLesson","log","$0d2602a1ad8fee7b$var$currentModulesPage","$0d2602a1ad8fee7b$var$totalModulesPages","$0d2602a1ad8fee7b$var$totalModulesItems","$0d2602a1ad8fee7b$var$modulesPerPage","$0d2602a1ad8fee7b$var$initModulesView","$0d2602a1ad8fee7b$var$loadCoursesForFilter","$0d2602a1ad8fee7b$var$loadModules","$0d2602a1ad8fee7b$var$showLoadingModules","paginatedModules","$0d2602a1ad8fee7b$var$renderModuleRows","modules","headerRow","rowHTML","$0d2602a1ad8fee7b$var$escapeHtml","$0d2602a1ad8fee7b$var$renderModulesPagination","mainContainer","paginationDiv","$0d2602a1ad8fee7b$var$showErrorModules","isLoading","modulesTabTrigger","changeModulesPerPage","openCreateModuleModal","changeModulesPage","initModulesView","$e673dd2d4573991e$var$currentOfferPage","$e673dd2d4573991e$var$totalOfferPages","$e673dd2d4573991e$var$totalOfferItems","$e673dd2d4573991e$var$sortStatus","$e673dd2d4573991e$var$offersPerPage","$e673dd2d4573991e$var$loadOffers","$e673dd2d4573991e$var$renderOffersTable","offers","offerTableContainer","offer","$e673dd2d4573991e$var$convertStatusIntoBadge","$e673dd2d4573991e$var$extractDate","createOfferResponseButton","$e673dd2d4573991e$var$bindOfferTableEvents","statusFilter","pageSizeSelect","tableContent","$e673dd2d4573991e$var$deleteOffer","$e673dd2d4573991e$var$renderOfferPagePagination","offerPaginationContainer","offerPaginationHTML","offerStartPage","offerEndPage","$e673dd2d4573991e$var$bindOfferPaginationEvents","pageNumber","isNaN","getCsrfToken","getAttribute","toISOString","split","$c073e20d34594191$var$handleOpenModalClick","button","$c073e20d34594191$var$openOfferResponseModal","$c073e20d34594191$var$handleSubmitResponse","updateData","responseText","originalText","loadOffers","$c073e20d34594191$var$clearModalForm","$c073e20d34594191$var$escapeHtml","m","offersTab","responseForm","openOfferResponseModal","$1c387a80789f9a23$var$currentEditingUser","$1c387a80789f9a23$var$openEditUserModal","userResponse","userData","username","val","$1c387a80789f9a23$var$saveUserChanges","department","jobTitle","qualification","role","loadUsers","$1c387a80789f9a23$var$displayValidationErrors","field","entries","fieldNames","editUser","$638425cc06b147b7$var$currentPageUsers","$638425cc06b147b7$var$totalPagesUsers","$638425cc06b147b7$var$totalItemsUsers","$638425cc06b147b7$var$usersPerPage","$638425cc06b147b7$var$roleFilter","$638425cc06b147b7$var$loadUsers","$638425cc06b147b7$var$renderUsersTable","users","user","avatar","$638425cc06b147b7$var$escapeHtml","firstName","lastName","$638425cc06b147b7$var$getQualificationClass","qual","$638425cc06b147b7$var$formatDate","createdAt","$638425cc06b147b7$var$showError","$638425cc06b147b7$var$deleteUsersRequest","deleteRequest","successMessage","$638425cc06b147b7$var$openEnrollModal","userName","$638425cc06b147b7$var$confirmEnrollment","requestData","$638425cc06b147b7$var$openViewCoursesModal","userCoursesList","$638425cc06b147b7$var$refreshUserCoursesList","listItem","titleSpan","unenrollButton","onclick","$638425cc06b147b7$var$confirmUnenrollment","$638425cc06b147b7$var$unenrollRequest","usersTab","deleteUser","openEnrollModal","confirmEnrollment","openViewCoursesModal","confirmUnenrollment","unenrollRequest","changeUsersPage","currentPageUsers","rowsInUserTable","filterByUserRole","refreshUsersTable","$b280201063cd81bd$var$currentDocsPage","$b280201063cd81bd$var$totalDocsPages","$b280201063cd81bd$var$totalDocsItems","$b280201063cd81bd$var$docsPerPage","$b280201063cd81bd$var$loadCoursesForFilter","$b280201063cd81bd$var$loadCategoriesForFilter","category","$b280201063cd81bd$var$loadDocuments","$b280201063cd81bd$var$showLoading","categoryId","$b280201063cd81bd$var$renderDocumentsTable","$b280201063cd81bd$var$renderDocumentsPagination","documents","doc","$b280201063cd81bd$var$escapeHtml","categoryName","tags","$b280201063cd81bd$var$deleteDocument","docId","docName","$b280201063cd81bd$var$openCreateDocumentModal","categorySelect","courseResponse","courseResult","$b280201063cd81bd$var$handleCourseChangeForModal","$b280201063cd81bd$var$handleCreateDocumentSubmit","docsTabTrigger","createDocumentForm","loadDocuments","changeDocsPerPage","changeDocsPage","deleteDocument","loadCoursesForFilter","loadCategoriesForFilter","openCreateDocumentModal","handleCourseChangeForModal"],"version":3,"file":"admin-bundle.js.map"}